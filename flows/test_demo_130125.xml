<?xml version="1.0" encoding="UTF-8"?>
<mxGraphModel dx="2702" dy="1745" grid="1" gridSize="10" guides="1" tooltips="1" connect="1"
              fold="1"
              page="1"
              pageScale="1"
              pageWidth="826"
              pageHeight="1169">
   <root>
      <mxCell id="0"/>
      <mxCell id="1" parent="0"/>
      <start action="com.eitg.quasar.nexus.middleware.scxml.handlers.StartHandler"
             label="Start (generic)"
             initial="1"
             name=""
             traceField=""
             traceList=""
             traceTimeout=""
             traceCondition="spel:true"
             id="2">
         <mxCell style="image;html=1;image=clipart/start-button.png" parent="1" vertex="1">
            <mxGeometry x="-1590" y="-1100" width="80" height="80" as="geometry"/>
         </mxCell>
      </start>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop"
            isfinal="yes"
            id="3">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-871" y="-250" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="4" value="sip.callStart.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0.5;entryY=0;"
              parent="1"
              source="2"
              target="24"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <mxPoint x="-1440" y="-1060" as="sourcePoint"/>
            <mxPoint x="-1410" y="-1050" as="targetPoint"/>
            <Array as="points">
               <mxPoint x="-910" y="-1060"/>
               <mxPoint x="-910" y="-990"/>
               <mxPoint x="-1000" y="-990"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <event-generator-handler action="io.qsrlabs.nexus.middleware.scxml.handlers.EvaluateParamsAndGenerateEvent"
                               label="check if called begins with 3000"
                               evt.3000uri="spel:#initial[&#34;SIP&#34;][&#34;R-URI&#34;][&#34;address&#34;][&#34;uri&#34;][&#34;user&#34;].startsWith(&#34;3000&#34;)"
                               id="5">
         <mxCell style="image;html=1;image=clipart/check-list.png" parent="1" vertex="1">
            <mxGeometry x="-1410" y="-1020" width="120" height="60" as="geometry"/>
         </mxCell>
      </event-generator-handler>
      <mxCell id="6" value="3000uri"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="5"
              target="12"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1350" y="-805"/>
               <mxPoint x="-1370" y="-805"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="stop else&#xA;"
            isfinal="yes"
            id="10">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-1540" y="-510" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="11" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;"
              parent="1"
              source="5"
              target="37"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1380" y="-880"/>
               <mxPoint x="-1520" y="-880"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="function normalization_1"
                          library="Demo_13_01_2025:normalization"
                          function="normalization_1"
                          id="12">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1090" y="-800" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="15" value="success"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="12"
              target="18"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1000" y="-690"/>
               <mxPoint x="-1200" y="-690"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <http-client-request action="io.qsrlabs.nexus.redis.http.gui.RequestHandler" label="Http client"
                           queue="poc_HttpCl_ingress"
                           queue-db="queue-db"
                           url="https://new.019sms.co.il/api"
                           timeout-ms="500"
                           request-method="post"
                           body="spel:#session[&#34;s_xml&#34;]"
                           header.Content-Type="application/xml"
                           id="16">
         <mxCell style="image;html=1;image=clipart/http-request.png" parent="1" vertex="1">
            <mxGeometry x="-1040" y="-620" width="130" height="90" as="geometry"/>
         </mxCell>
      </http-client-request>
      <mxCell id="17" value="http.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="16"
              target="31"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-940" y="-495"/>
               <mxPoint x="-830" y="-495"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="create XML"
                          library="Demo_13_01_2025:normalization"
                          function="createXML"
                          id="18">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1260" y="-640" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="19" value="success"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="18"
              target="16"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop Other Events"
            isfinal="yes"
            id="20">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-1610" y="-941.111083984375" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="21" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=0.5;entryY=0;"
              parent="1"
              source="2"
              target="20"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="23" value="Added transition for SIP Invite"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1240" y="-1160" width="420" height="70" as="geometry"/>
      </mxCell>
      <session-store action="io.qsrlabs.nexus.middleware.scxml.handlers.SessionVar"
                     label="Store intial event "
                     name=""
                     s_initialSIP="spel:#event"
                     id="24">
         <mxCell style="image;html=1;image=clipart/variable.png" parent="1" vertex="1">
            <mxGeometry x="-1060" y="-941" width="120" height="60" as="geometry"/>
         </mxCell>
      </session-store>
      <mxCell id="26"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;"
              parent="1"
              source="24"
              target="5"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="28" value="Store intial event in session =&gt; SIP Invite from network"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-950" y="-951" width="420" height="70" as="geometry"/>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop failure"
            isfinal="yes"
            id="29">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-720" y="-810.111083984375" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="30" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;"
              parent="1"
              source="12"
              target="29"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlLeaveCall" label="Leave call"
                 name=""
                 destination="spel:#session[&#34;s_initialSIP_lib&#34;][&#34;SIP&#34;][&#34;R-URI&#34;][&#34;value&#34;]"
                 leaveType="proxy"
                 message="spel:#session[&#34;s_initialSIP_lib&#34;]"
                 id="31">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-890" y="-430" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="32" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="31"
              target="3"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-832" y="-310"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="33" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;"
              parent="1"
              source="31"
              target="29"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="34" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.75;"
              parent="1"
              source="16"
              target="29"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="35" value="http.200"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0;entryY=0.5;"
              edge="1"
              parent="1"
              source="16"
              target="3">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="36" value="http.timeout"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.75;"
              edge="1"
              parent="1"
              source="16"
              target="10">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="function extractAndCompare"
                          library="Demo_13_01_2025:normalization"
                          function="extractAndCompare"
                          id="37">
         <mxCell style="image;html=1;image=clipart/script.png" vertex="1" parent="1">
            <mxGeometry x="-1580" y="-800" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="38" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.25;entryY=0;"
              edge="1"
              parent="1"
              source="37"
              target="31">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1520" y="-370"/>
               <mxPoint x="-860" y="-370"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="39" value="1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;"
              edge="1"
              parent="1"
              source="37"
              target="10">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="40" value="2"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.375;entryY=-0.125;entryPerimeter=0;"
              edge="1"
              parent="1"
              source="37"
              target="10">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
   </root>
</mxGraphModel>