<?xml version="1.0" encoding="UTF-8"?>
<mxGraphModel dx="4500" dy="3222" grid="1" gridSize="10" guides="1" tooltips="1" connect="1"
              fold="1"
              page="1"
              pageScale="1"
              pageWidth="826"
              pageHeight="1169">
   <root>
      <mxCell id="0"/>
      <mxCell id="1" parent="0"/>
      <start action="com.eitg.quasar.nexus.middleware.scxml.handlers.StartHandler"
             label="Start (generic)"
             initial="1"
             name=""
             traceField=""
             traceList=""
             traceTimeout=""
             traceCondition="spel:true"
             id="2">
         <mxCell style="image;html=1;image=clipart/start-button.png" parent="1" vertex="1">
            <mxGeometry x="-1290" y="-1310" width="80" height="80" as="geometry"/>
         </mxCell>
      </start>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop.httperror"
            isfinal="yes"
            id="3">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-739" y="100" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="4" value="sip.callStart.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="2"
              target="24"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <mxPoint x="-1440" y="-1060" as="sourcePoint"/>
            <mxPoint x="-1410" y="-1050" as="targetPoint"/>
            <Array as="points">
               <mxPoint x="-1250" y="-1150"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <event-generator-handler action="io.qsrlabs.nexus.middleware.scxml.handlers.EvaluateParamsAndGenerateEvent"
                               label="RURI starts with 3000"
                               evt.3000uri="spel:#initial[&#34;SIP&#34;][&#34;R-URI&#34;][&#34;address&#34;][&#34;uri&#34;][&#34;user&#34;].startsWith(&#34;3000&#34;)"
                               id="5">
         <mxCell style="image;html=1;image=clipart/check-list.png" parent="1" vertex="1">
            <mxGeometry x="-1310" y="-1000" width="120" height="60" as="geometry"/>
         </mxCell>
      </event-generator-handler>
      <mxCell id="6" value="3000uri"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="5"
              target="12"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1250" y="-850"/>
               <mxPoint x="-1030" y="-850"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="11" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;"
              parent="1"
              source="5"
              target="37"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1280" y="-850"/>
               <mxPoint x="-1840" y="-850"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="function normalization_1"
                          library="Demo_13_01_2025:normalization"
                          function="normalization_1"
                          id="12">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1090" y="-800" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="15" value="success"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="12"
              target="18"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1030" y="-690"/>
               <mxPoint x="-1030" y="-690"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <http-client-request action="io.qsrlabs.nexus.redis.http.gui.RequestHandler" label="Httpclient"
                           queue="poc_HttpCl_ingress"
                           queue-db="queue-db"
                           url="https://new.019sms.co.il/api"
                           timeout-ms="500"
                           request-method="post"
                           body="spel:#session[&#34;s_xml&#34;]"
                           header.Content-Type="application/xml"
                           id="16">
         <mxCell style="image;html=1;image=clipart/http-request.png" parent="1" vertex="1">
            <mxGeometry x="-1095" y="-550" width="130" height="90" as="geometry"/>
         </mxCell>
      </http-client-request>
      <mxCell id="17" value="http.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="16"
              target="51"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-830" y="-460"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="create XML"
                          library="Demo_13_01_2025:ocshttp"
                          function="createXML"
                          id="18">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1090" y="-680" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="19" value="success"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="18"
              target="16"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop Other Events"
            isfinal="yes"
            id="20">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-1550" y="-1170.111083984375" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="21" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;"
              parent="1"
              source="2"
              target="20"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points"/>
         </mxGeometry>
      </mxCell>
      <mxCell id="23" value="Added transition for SIP Invite"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1150" y="-1250" width="420" height="70" as="geometry"/>
      </mxCell>
      <session-store action="io.qsrlabs.nexus.middleware.scxml.handlers.SessionVar"
                     label="Store intial event "
                     name=""
                     s_initialSIP="spel:#event"
                     s_SIPInvite="spel:#event"
                     id="24">
         <mxCell style="image;html=1;image=clipart/variable.png" parent="1" vertex="1">
            <mxGeometry x="-1310" y="-1150" width="120" height="60" as="geometry"/>
         </mxCell>
      </session-store>
      <mxCell id="26"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="24"
              target="5"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1250" y="-1080"/>
               <mxPoint x="-1250" y="-1080"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="28" value="Store intial event in session =&gt; SIP Invite from network"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1150" y="-1150" width="420" height="70" as="geometry"/>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop failure"
            isfinal="yes"
            id="29">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-720" y="-810.111083984375" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="30" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;"
              parent="1"
              source="12"
              target="29"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlLeaveCall" label="Leave call"
                 name=""
                 destination="spel:#session[&#34;s_initialSIP&#34;][&#34;SIP&#34;][&#34;R-URI&#34;][&#34;value&#34;]"
                 leaveType="proxy"
                 message="spel:#session[&#34;s_initialSIP&#34;]"
                 id="31">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1580" y="-60" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="32" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="31"
              target="58"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1520" y="30"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="33" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=1;entryY=0.5;"
              parent="1"
              source="31"
              target="58"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <mxPoint x="-1150" y="-70" as="targetPoint"/>
            <Array as="points">
               <mxPoint x="-1490" y="80"/>
               <mxPoint x="-1470" y="80"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="34" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.75;"
              parent="1"
              source="16"
              target="29"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="35" value="http.200"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="16"
              target="50"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points"/>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="function extractAndCompare"
                          library="Demo_13_01_2025:normalization"
                          function="extractAndCompare"
                          id="37">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1900" y="-800" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="38" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.25;entryY=0;"
              parent="1"
              source="37"
              target="31"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1520" y="-60"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="39" value="1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="37"
              target="41"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-2020" y="-740"/>
               <mxPoint x="-2020" y="-680"/>
               <mxPoint x="-2240" y="-680"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="40" value="2"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="37"
              target="155"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1840" y="-740"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <local-event action="io.qsrlabs.nexus.middleware.scxml.handlers.GenerateSessionEvent"
                   label="set Ann with200"
                   event-name="inevent"
                   payload="{\&#34;playannouncement\&#34;: \&#34;annoTest\&#34;,\&#34;action\&#34;: \&#34;promptandcollect\&#34;,\&#34;earlydialog\&#34;: true}"
                   id="41">
         <mxCell style="image;html=1;image=clipart/local-event.png" parent="1" vertex="1">
            <mxGeometry x="-2300" y="-820" width="120" height="60" as="geometry"/>
         </mxCell>
      </local-event>
      <invoke-subflow action="io.qsrlabs.nexus.middleware.scxml.handlers.Subflow#combobox"
                      label="Subflow Ann with200"
                      subflow="Demo_13_01_2025:MRF-PlayAnn-PromptAndCollect"
                      category="procedure"
                      id="43">
         <mxCell style="image;html=1;image=clipart/subflow-static.png" parent="1" vertex="1">
            <mxGeometry x="-2300" y="-680" width="120" height="60" as="geometry"/>
         </mxCell>
      </invoke-subflow>
      <invoke-subflow action="io.qsrlabs.nexus.middleware.scxml.handlers.Subflow#combobox"
                      label="MRF subflow"
                      subflow="Demo_13_01_2025:MRF-PlayAnn-PromptAndCollect"
                      category="procedure"
                      id="44">
         <mxCell style="image;html=1;image=clipart/subflow-static.png" parent="1" vertex="1">
            <mxGeometry x="-1900" y="-510" width="120" height="60" as="geometry"/>
         </mxCell>
      </invoke-subflow>
      <mxCell id="45" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="41"
              target="43"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="46" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="155"
              target="44"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1840" y="-540"/>
               <mxPoint x="-1840" y="-540"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop"
            isfinal="yes"
            id="47">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-2040" y="300" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="49" value="dtmf.digit.1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="44"
              target="109"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1840" y="-120"/>
               <mxPoint x="-1840" y="-120"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="processhttp200ok"
                          library="Demo_13_01_2025:ocshttp"
                          function="checkHttpResponse"
                          id="50">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1300" y="-390" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="processhttpfailure"
                          library="Demo_13_01_2025:ocshttp"
                          function="failureHttpResponse"
                          id="51">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-759" y="-390" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call"
                 name=""
                 errorCode="486"
                 cause="REJECTED"
                 reason.up.q850.cause=""
                 reason.up.q850.text=""
                 reason.up.sip.cause=""
                 reason.up.sip.text=""
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#session[&#34;s_SIPInvite&#34;]"
                 id="52">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-759" y="-240" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="53" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="51"
              target="52"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <counter action="com.eitg.quasar.nexus.middleware.scxml.handlers.CustomCounterHandler"
               label="Statistic counter"
               category="http"
               type="httpresponse"
               name="error"
               id="54">
         <mxCell style="image;html=1;image=clipart/statistics.png" parent="1" vertex="1">
            <mxGeometry x="-759" y="-130" width="120" height="60" as="geometry"/>
         </mxCell>
      </counter>
      <mxCell id="55" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="52"
              target="54"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="56" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.75;entryY=0;"
              parent="1"
              source="52"
              target="54"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="57"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="54"
              target="59"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points"/>
         </mxGeometry>
      </mxCell>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop"
            isfinal="yes"
            id="58">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-1550" y="70" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <trace-info action="io.qsrlabs.nexus.middleware.scxml.handlers.TraceInfo"
                  label="Trace info"
                  scenario="httperror"
                  trace-level="spel:2"
                  trace-ttl="spel:2419200"
                  trace-size="spel:1000"
                  id="59">
         <mxCell style="image;html=1;image=clipart/trace-metadata.png" parent="1" vertex="1">
            <mxGeometry x="-759" y="-10" width="120" height="60" as="geometry"/>
         </mxCell>
      </trace-info>
      <mxCell id="60"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="59"
              target="3"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="61" value="http.timeout"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.75;entryX=0.75;entryY=0;"
              parent="1"
              source="16"
              target="51"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="62"
              value="save the trace for longer (4 week) and give it a scenario nname &#34;httperror&#34;.&#xA;&#xA;this helps to find such errors later and have all details available for analysis"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-599" y="-10" width="240" height="80" as="geometry"/>
      </mxCell>
      <mxCell id="63" value="increase a counter - available in real-time"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-599" y="-120" width="120" height="60" as="geometry"/>
      </mxCell>
      <mxCell id="64"
              value="A leg is in establishment phase. To clear the call send back a 486 SIP."
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-599" y="-240" width="210" height="60" as="geometry"/>
      </mxCell>
      <invoke-subflow action="io.qsrlabs.nexus.middleware.scxml.handlers.Subflow#combobox"
                      label="Subflow Ann with200"
                      subflow="Demo_13_01_2025:MRF-PlayAnn-PromptAndCollect"
                      category="procedure"
                      id="65">
         <mxCell style="image;html=1;image=clipart/subflow-static.png" parent="1" vertex="1">
            <mxGeometry x="-1650" y="-225" width="120" height="60" as="geometry"/>
         </mxCell>
      </invoke-subflow>
      <mxCell id="66" value="scenario.4"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="50"
              target="65"
              edge="1">
         <mxGeometry x="0.8824" relative="1" as="geometry">
            <mxPoint as="offset"/>
         </mxGeometry>
      </mxCell>
      <invoke-subflow action="io.qsrlabs.nexus.middleware.scxml.handlers.Subflow#combobox"
                      label="Subflow Ann with200"
                      subflow="Demo_13_01_2025:MRF-PlayAnn-PromptAndCollect"
                      category="procedure"
                      id="67">
         <mxCell style="image;html=1;image=clipart/subflow-static.png" parent="1" vertex="1">
            <mxGeometry x="-1430" y="-225" width="120" height="60" as="geometry"/>
         </mxCell>
      </invoke-subflow>
      <mxCell id="68" value="scenario.5"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="50"
              target="67"
              edge="1">
         <mxGeometry x="0.7872" relative="1" as="geometry">
            <mxPoint as="offset"/>
         </mxGeometry>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlForwardCall"
                 label="Connect to B"
                 name=""
                 destination="spel:#session[&#34;CalledPartyOverwritten&#34;]"
                 message="spel:#session[&#34;s_SIPInvite&#34;]"
                 no-answer-timer="2"
                 max-call-duration="10"
                 continue="true"
                 id="69">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1190" y="-110" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="70" value="scenario.0"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="50"
              target="73"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1210" y="-285"/>
               <mxPoint x="-1130" y="-285"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="71" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.75;entryX=0.25;entryY=0;"
              parent="1"
              source="50"
              target="52"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="72"
              value="process the http response and decide the scenario to go forward - or terminate the call if an unexpected http response is received"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1510" y="-395" width="210" height="60" as="geometry"/>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="armevents"
                          library="Demo_13_01_2025:call"
                          function="armevents"
                          id="73">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1190" y="-240" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="74"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="73"
              target="69"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <park-and-wait action="io.qsrlabs.nexus.middleware.scxml.handlers.WaitForNextEvent"
                     label="Wait for next ingres event"
                     id="75">
         <mxCell style="image;html=1;image=clipart/next.png" parent="1" vertex="1">
            <mxGeometry x="-1190" y="10" width="120" height="60" as="geometry"/>
         </mxCell>
      </park-and-wait>
      <mxCell id="76" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="69"
              target="75"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="saveconnecttime"
                          library="Demo_13_01_2025:call"
                          function="armevents"
                          id="77">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1390" y="100" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="78" value="sip.callAnswered.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=1;"
              parent="1"
              source="75"
              target="77"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1160" y="130"/>
               <mxPoint x="-1330" y="130"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="79" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;entryX=0.25;entryY=0;"
              parent="1"
              source="104"
              target="75"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1330"/>
               <mxPoint x="-1160"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="81" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="75"
              target="82"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1130" y="180"/>
               <mxPoint x="-1130" y="180"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="callended"
                          library="Demo_13_01_2025:call"
                          function="callended"
                          id="82">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1190" y="180" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <stop action="com.eitg.quasar.nexus.middleware.scxml.handlers.StopHandler"
            label="Stop.callended.scenario0"
            isfinal="yes"
            id="83">
         <mxCell style="image;html=1;image=clipart/plain-stop.png" parent="1" vertex="1">
            <mxGeometry x="-1170" y="500" width="80" height="80" as="geometry"/>
         </mxCell>
      </stop>
      <mxCell id="84"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="82"
              target="83"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="85" value="error.nolib exit if library is not found"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1305" y="-660" width="210" height="60" as="geometry"/>
      </mxCell>
      <mxCell id="86" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.75;entryX=0.75;entryY=0;"
              parent="1"
              source="75"
              target="75"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1020" y="30"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="87" value="sip.callStart.DISCONNECTED"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="75"
              target="106"
              edge="1">
         <mxGeometry x="-0.2414" y="-40" relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-990" y="70"/>
               <mxPoint x="-990" y="240"/>
            </Array>
            <mxPoint x="40" y="40" as="offset"/>
         </mxGeometry>
      </mxCell>
      <mxCell id="88" value="Terminate the call in case of no-answer timeout of the 2s"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1040" y="150" width="120" height="60" as="geometry"/>
      </mxCell>
      <mxCell id="89"
              value="handle any other event (Wildcard) and &#xA;wait for either answer or end of call&#xA;&#xA;on 180 event -&gt;&#xA;sip.callPoll.SIPSuccessResponsePollEvent"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1080" y="-70" width="200" height="90" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call"
                 name=""
                 errorCode="486"
                 cause="REJECTED"
                 reason.up.q850.cause=""
                 reason.up.q850.text=""
                 reason.up.sip.cause=""
                 reason.up.sip.text=""
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#session[&#34;s_SIPInvite&#34;]"
                 id="90">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1050" y="350" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="prepareCallPollAccept"
                          library="Demo_13_01_2025:call"
                          function="prepareCallPollAccept"
                          id="91">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1460" y="190" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="92" value="sip.callPoll.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=1;"
              parent="1"
              source="75"
              target="91"
              edge="1">
         <mxGeometry x="0.4091" relative="1" as="geometry">
            <mxPoint as="offset"/>
         </mxGeometry>
      </mxCell>
      <mxCell id="94" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;entryX=0.25;entryY=0;"
              parent="1"
              source="99"
              target="75"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1400"/>
               <mxPoint x="-1160"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="95" value="on 180 event -&gt;&#xA;sip.callPoll.SIPSuccessResponsePollEvent"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-1505" y="285" width="200" height="90" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlSendAction" label="SendAction"
                 name=""
                 message="spel:#initial"
                 continue="true"
                 id="99">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1460" y="100" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="101" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;entryX=0.5;entryY=1;"
              parent="1"
              source="91"
              target="99"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="102" value="global.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0;exitY=0.5;entryX=0.5;entryY=0;"
              parent="1"
              source="2"
              target="20"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="103"
              value="add event-stack processing. the last or one before last is &#xA;&#xA;&#xA;events-stack&#x9;&#x9;[5]&#xA;0&#x9;:&#x9;sip.callStart.NONE&#xA;1&#x9;:&#x9;sip.callPoll.SIPSuccessResponsePollEvent&#xA;2&#x9;:&#x9;sip.callAnswered.SipCallLegUaClient&#xA;3&#x9;:&#x9;leg.max_call_duration&#xA;4&#x9;:&#x9;sip.callStart.DISCONNECTED&#xA;"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              parent="1"
              vertex="1">
         <mxGeometry x="-910" y="300" width="280" height="150" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlSendAction" label="SendAction"
                 name=""
                 message="spel:#initial"
                 continue="true"
                 id="104">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1390" y="20" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="105" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=0;entryX=0.5;entryY=1;"
              parent="1"
              source="77"
              target="104"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <typescript-library action="io.qsrlabs.nexus.middleware.scxml.handlers.TypeScriptLibrary#fixed"
                          label="getdisconnectreason"
                          library="Demo_13_01_2025:call"
                          function="getdisconnectreason"
                          id="106">
         <mxCell style="image;html=1;image=clipart/script.png" parent="1" vertex="1">
            <mxGeometry x="-1050" y="240" width="120" height="60" as="geometry"/>
         </mxCell>
      </typescript-library>
      <mxCell id="107" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="106"
              target="90"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="108" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="90"
              target="83"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call Payment Required"
                 name=""
                 errorCode="402"
                 cause="REJECTED"
                 reason.up.q850.cause="17"
                 reason.up.q850.text="myuserbusy"
                 reason.up.sip.cause="17"
                 reason.up.sip.text="myuserbusy"
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#initial"
                 id="109">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-1900" y="-85" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <event-generator-handler action="io.qsrlabs.nexus.middleware.scxml.handlers.EvaluateParamsAndGenerateEvent"
                               label="MRF.action"
                               evt.promptandcollect="spel:#session[&#34;mrf&#34;][&#34;action&#34;] eq &#34;promptandcollect&#34;"
                               evt.playannouncement="spel:#session[&#34;mrf&#34;][&#34;action&#34;] eq &#34;playannouncement&#34;"
                               id="112">
         <mxCell style="image;html=1;image=clipart/check-list.png" parent="1" vertex="1">
            <mxGeometry x="380" y="1050" width="120" height="60" as="geometry"/>
         </mxCell>
      </event-generator-handler>
      <mxCell id="115" value="dtmf.digit.1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="116" value="dtmf.digit.1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="117" value="dtmf.digit.1"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="119" value="dtmf.digit.2"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.75;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="44"
              target="156"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1810" y="-400"/>
               <mxPoint x="-1710" y="-400"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call Decline"
                 name=""
                 errorCode="603"
                 cause="REJECTED"
                 reason.up.q850.cause="17"
                 reason.up.q850.text="anytext"
                 reason.up.sip.cause="486"
                 reason.up.sip.text="siptext"
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#initial"
                 id="120">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-2060" y="-85" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="121" value="dtmf.digit.*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="44"
              target="120"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1870" y="-380"/>
               <mxPoint x="-2000" y="-380"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call Default"
                 name=""
                 errorCode=""
                 cause="NONE"
                 reason.up.q850.cause=""
                 reason.up.q850.text=""
                 reason.up.sip.cause=""
                 reason.up.sip.text=""
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#initial"
                 id="122">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 parent="1"
                 vertex="1">
            <mxGeometry x="-2210" y="-85" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <mxCell id="123" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.25;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="44"
              target="122"
              edge="1">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1870" y="-400"/>
               <mxPoint x="-2150" y="-400"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <trace-info action="io.qsrlabs.nexus.middleware.scxml.handlers.TraceInfo"
                  label="Trace info"
                  scenario="dtmf.no"
                  trace-level="spel:2"
                  trace-ttl="spel:2419200"
                  trace-size="spel:1000"
                  id="124">
         <mxCell style="image;html=1;image=clipart/trace-metadata.png" parent="1" vertex="1">
            <mxGeometry x="-2210" y="140" width="120" height="60" as="geometry"/>
         </mxCell>
      </trace-info>
      <counter action="com.eitg.quasar.nexus.middleware.scxml.handlers.CustomCounterHandler"
               label="Statistic counter"
               category="http"
               type="httpresponse"
               name="error"
               id="125">
         <mxCell style="image;html=1;image=clipart/statistics.png" parent="1" vertex="1">
            <mxGeometry x="-2210" y="40" width="120" height="60" as="geometry"/>
         </mxCell>
      </counter>
      <mxCell id="126" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="122"
              target="125"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="127"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="125"
              target="124"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="128"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="124"
              target="47"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <trace-info action="io.qsrlabs.nexus.middleware.scxml.handlers.TraceInfo"
                  label="Trace info"
                  scenario="dtmf.any"
                  trace-level="spel:2"
                  trace-ttl="spel:2419200"
                  trace-size="spel:1000"
                  id="129">
         <mxCell style="image;html=1;image=clipart/trace-metadata.png" parent="1" vertex="1">
            <mxGeometry x="-2060" y="150" width="120" height="60" as="geometry"/>
         </mxCell>
      </trace-info>
      <counter action="com.eitg.quasar.nexus.middleware.scxml.handlers.CustomCounterHandler"
               label="Statistic counter"
               category="http"
               type="httpresponse"
               name="error"
               id="130">
         <mxCell style="image;html=1;image=clipart/statistics.png" parent="1" vertex="1">
            <mxGeometry x="-2060" y="50" width="120" height="60" as="geometry"/>
         </mxCell>
      </counter>
      <mxCell id="131" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              target="130"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="132"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="130"
              target="129"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="133"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="129"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <trace-info action="io.qsrlabs.nexus.middleware.scxml.handlers.TraceInfo"
                  label="Trace info"
                  scenario="dtmf.1"
                  trace-level="spel:2"
                  trace-ttl="spel:2419200"
                  trace-size="spel:1000"
                  id="134">
         <mxCell style="image;html=1;image=clipart/trace-metadata.png" parent="1" vertex="1">
            <mxGeometry x="-1900" y="140" width="120" height="60" as="geometry"/>
         </mxCell>
      </trace-info>
      <counter action="com.eitg.quasar.nexus.middleware.scxml.handlers.CustomCounterHandler"
               label="Statistic counter"
               category="http"
               type="httpresponse"
               name="error"
               id="135">
         <mxCell style="image;html=1;image=clipart/statistics.png" parent="1" vertex="1">
            <mxGeometry x="-1900" y="40" width="120" height="60" as="geometry"/>
         </mxCell>
      </counter>
      <mxCell id="136" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              target="135"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="137"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="135"
              target="134"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="138"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="134"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="139" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="120"
              target="130"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="141"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="134"
              target="47"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="142"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;"
              parent="1"
              source="129"
              target="47"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="151" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              parent="1"
              source="109"
              target="135"
              edge="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="152"
              value="The call is in establishment phase. In this case a Terminate of the call will send a 4xx response. &#xA;If case any DTMF (but not 1 or 2) is received a 603 (Declined) with q850 and SIP cause+text as in the handler.&#xA;&#xA;If DTMF digit 1 is received a 402 (Payment Required) with q850 and txt is sent back.&#xA;&#xA;for other scenarios a TAS default reject is sent back.&#xA;&#xA;Handler Parameter&#xA;cause:&#x9;if set to REJECTED the errorCode is used to set the SIP status &#xA;errorCode:&#x9;486&#xA;&#xA;to set the cause and text in the upstream leg (in this case only upstream leg exists). Only if the text is added the cause is set together with the text. &#xA;reason.up.q850.cause:&#x9; 17&#xA;reason.up.q850.text:&#x9; anytext&#xA;reason.up.sip.cause:&#x9; 486&#xA;reason.up.sip.text:&#x9; siptext&#xA;&#xA;message: The message object is used to derive the queue, callid, timestamp. This is used by the TAS to find the correct call. It shall be the last received message, regardless of the leg of the call. In this case is must be the MRF msg as the Initial-Invite is too far back in time and the TAS would drop the message. If not other event was receive but the MRF disconnect the spel:#initial can be used&#xA;&#xA; "
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              vertex="1"
              parent="1">
         <mxGeometry x="-2670" y="-160" width="440" height="410" as="geometry"/>
      </mxCell>
      <structured-object-builder action="io.qsrlabs.nexus.middleware.scxml.handlers.StructuredJsonObjectBuilder"
                                 label="Define MRF Data"
                                 payload="eyJkZXNjcmlwdGlvbiI6IkluaXRpYWwgUHJvbXB0IGFuZCBDb2xsZWN0IiwiYW5ub3VuY2VtZW50IjoiYW5ub1Rlc3QiLCJhY3Rpb24iOiJwbGF5YW5ub3VuY2VtZW50IiwiZWFybHlkaWFsb2ciOnRydWUsImNvbGxlY3QiOnsiY2xlYXJkYiI6InRydWUiLCJlZHQiOiIxcyIsImZkdCI6IjNzIiwiaWR0IjoiMnMiLCJpdGVyYXRlIjoiMSJ9LCJwbGF5Ijp7ImJhcmdlIjoidHJ1ZSIsIm1heHRpbWUiOiIxMXMiLCJhdWRpb3VyaSI6ImZpbGU6Ly8vYXBwbC93YXYvdGljdGFjLndhdiJ9LCJwYXR0ZXJuIjp7ImRpZ2l0cyI6IlsxLTJdIiwiZm9ybWF0IjoicmVnZXgifX0="
                                 code="CmZ1bmN0aW9uIHJldHVyblBheWxvYWQoc2Vzc2lvbkRhdGE6YW55LGV2ZW50RGF0YTphbnksbG9jYWxQYXJhbXM6TG9jYWxQYXJhbWV0ZXJzKTphbnl7CiAgICAvLyBwYXlsb2FkIGZpZWxkIG9mIGxvY2FsUGFyYW1zIGFscmVhZHkgaW5jbHVkZXMgdGhlIHJlcXVlc3QgcGF5bG9hZDsgeW91IGNhbiAKICAgIC8vIGNoYW5nZSBpdCBmdXJ0aGVyIGhlcmUgbGlrZSBhZGRpbmcgZHluYW1pY2FsbHkgYXJyYXkgZWxlbWVudHMsIGV0Yy4uLgogICAgcmV0dXJuIGxvY2FsUGFyYW1zLnBheWxvYWQ7Cn0="
                                 jscode="CmZ1bmN0aW9uIHJldHVyblBheWxvYWQoc2Vzc2lvbkRhdGEsZXZlbnREYXRhLGxvY2FsUGFyYW1zKXsKICAgIHJldHVybiBsb2NhbFBhcmFtcy5wYXlsb2FkOwp9"
                                 useScript="false"
                                 slotInSession="mrf_param"
                                 id="155">
         <mxCell style="image;html=1;image=clipart/json.png" vertex="1" parent="1">
            <mxGeometry x="-1900" y="-650" width="120" height="60" as="geometry"/>
         </mxCell>
      </structured-object-builder>
      <structured-object-builder action="io.qsrlabs.nexus.middleware.scxml.handlers.StructuredJsonObjectBuilder"
                                 label="Define MRF Data"
                                 payload="eyJkZXNjcmlwdGlvbiI6IkFmdGVyIERUTUQgZGlnaXQgMiIsImFubm91bmNlbWVudCI6ImFubm9UZXN0IiwiYWN0aW9uIjoicGxheWFubm91bmNlbWVudCIsImVhcmx5ZGlhbG9nIjp0cnVlLCJwbGF5Ijp7ImJhcmdlIjoidHJ1ZSIsIm1heHRpbWUiOiIxMXMiLCJhdWRpb3VyaSI6ImZpbGU6Ly8vYXBwbC93YXYvbm9zZXJ2aWNlLndhdiJ9fQ=="
                                 code="CmZ1bmN0aW9uIHJldHVyblBheWxvYWQoc2Vzc2lvbkRhdGE6YW55LGV2ZW50RGF0YTphbnksbG9jYWxQYXJhbXM6TG9jYWxQYXJhbWV0ZXJzKTphbnl7CiAgICAvLyBwYXlsb2FkIGZpZWxkIG9mIGxvY2FsUGFyYW1zIGFscmVhZHkgaW5jbHVkZXMgdGhlIHJlcXVlc3QgcGF5bG9hZDsgeW91IGNhbiAKICAgIC8vIGNoYW5nZSBpdCBmdXJ0aGVyIGhlcmUgbGlrZSBhZGRpbmcgZHluYW1pY2FsbHkgYXJyYXkgZWxlbWVudHMsIGV0Yy4uLgogICAgcmV0dXJuIGxvY2FsUGFyYW1zLnBheWxvYWQ7Cn0="
                                 jscode="CmZ1bmN0aW9uIHJldHVyblBheWxvYWQoc2Vzc2lvbkRhdGEsZXZlbnREYXRhLGxvY2FsUGFyYW1zKXsKICAgIHJldHVybiBsb2NhbFBhcmFtcy5wYXlsb2FkOwp9"
                                 useScript="false"
                                 slotInSession="mrf_param"
                                 id="156">
         <mxCell style="image;html=1;image=clipart/json.png" vertex="1" parent="1">
            <mxGeometry x="-1770" y="-360" width="120" height="60" as="geometry"/>
         </mxCell>
      </structured-object-builder>
      <mxCell id="158" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              edge="1"
              parent="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <invoke-subflow action="io.qsrlabs.nexus.middleware.scxml.handlers.Subflow#combobox"
                      label="MRF subflow 2"
                      subflow="Demo_13_01_2025:MRF-PlayAnn-PromptAndCollect"
                      category="procedure"
                      id="159">
         <mxCell style="image;html=1;image=clipart/subflow-static.png" vertex="1" parent="1">
            <mxGeometry x="-1770" y="-230" width="120" height="60" as="geometry"/>
         </mxCell>
      </invoke-subflow>
      <mxCell id="160"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              edge="1"
              parent="1"
              source="156"
              target="159">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <undefined action="com.eitg.quasar.nexus.siphandlers.ScxmlAbortCall"
                 label="Terminate call BUSY"
                 name=""
                 errorCode="486"
                 cause="REJECTED"
                 reason.up.q850.cause="17"
                 reason.up.q850.text="dtmfdigit2"
                 reason.up.sip.cause=""
                 reason.up.sip.text=""
                 reason.down.q850.cause=""
                 reason.down.q850.text=""
                 reason.down.sip.cause=""
                 reason.down.sip.text=""
                 message="spel:#initial"
                 id="163">
         <mxCell style="rectangle;shape=ext;rounded=1;html=1;whiteSpace=wrap;double=1;"
                 vertex="1"
                 parent="1">
            <mxGeometry x="-1770" y="-85" width="120" height="60" as="geometry"/>
         </mxCell>
      </undefined>
      <trace-info action="io.qsrlabs.nexus.middleware.scxml.handlers.TraceInfo"
                  label="Trace info"
                  scenario="dtmf.no"
                  trace-level="spel:2"
                  trace-ttl="spel:2419200"
                  trace-size="spel:1000"
                  id="164">
         <mxCell style="image;html=1;image=clipart/trace-metadata.png" vertex="1" parent="1">
            <mxGeometry x="-1770" y="140" width="120" height="60" as="geometry"/>
         </mxCell>
      </trace-info>
      <counter action="com.eitg.quasar.nexus.middleware.scxml.handlers.CustomCounterHandler"
               label="Statistic counter"
               category="http"
               type="httpresponse"
               name="error"
               id="165">
         <mxCell style="image;html=1;image=clipart/statistics.png" vertex="1" parent="1">
            <mxGeometry x="-1770" y="40" width="120" height="60" as="geometry"/>
         </mxCell>
      </counter>
      <mxCell id="166" value="sip.callEnd"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              edge="1"
              source="163"
              target="165"
              parent="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="167"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              edge="1"
              source="165"
              target="164"
              parent="1">
         <mxGeometry relative="1" as="geometry"/>
      </mxCell>
      <mxCell id="168" value="*"
              style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;"
              edge="1"
              parent="1"
              source="159"
              target="163">
         <mxGeometry relative="1" as="geometry">
            <Array as="points">
               <mxPoint x="-1710" y="-140"/>
               <mxPoint x="-1710" y="-140"/>
            </Array>
         </mxGeometry>
      </mxCell>
      <mxCell id="169"
              value="Set mrf object before MRF subflow. The mrf object is deleted in the subflow for next invocation"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              vertex="1"
              parent="1">
         <mxGeometry x="-2040" y="-650" width="120" height="90" as="geometry"/>
      </mxCell>
      <mxCell id="170" value="Set mrf object again - now for PA only"
              style="shape=note;whiteSpace=wrap;html=1;size=14;verticalAlign=top;align=left;spacingTop=-6;fillColor=#FFFFCC;"
              vertex="1"
              parent="1">
         <mxGeometry x="-1660" y="-395" width="100" height="70" as="geometry"/>
      </mxCell>
   </root>
</mxGraphModel>