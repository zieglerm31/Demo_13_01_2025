"use strict";
var Capabilities;
(function (Capabilities) {
    Capabilities["REL1XX"] = "REL1XX";
    Capabilities["FORKING"] = "FORKING";
    Capabilities["PRECONDITION"] = "PRECONDITION";
    Capabilities["PEM"] = "PEM";
    Capabilities["UPDATE"] = "UPDATE";
})(Capabilities || (Capabilities = {}));
var Annotype;
(function (Annotype) {
    Annotype["CONNECT"] = "CONNECT";
    Annotype["RINGING"] = "RING";
})(Annotype || (Annotype = {}));
var CallPollActionType;
(function (CallPollActionType) {
    CallPollActionType["Accept"] = "accept";
    CallPollActionType["Forward"] = "forward";
    CallPollActionType["Reject"] = "reject";
})(CallPollActionType || (CallPollActionType = {}));
var CallStartActionType;
(function (CallStartActionType) {
    CallStartActionType[CallStartActionType["Abort"] = 0] = "Abort";
    CallStartActionType[CallStartActionType["Forward"] = 1] = "Forward";
    CallStartActionType[CallStartActionType["RejectMrf"] = 2] = "RejectMrf";
})(CallStartActionType || (CallStartActionType = {}));
var MediaOperationActionType;
(function (MediaOperationActionType) {
    MediaOperationActionType["PerformMediaOperation"] = "performMediaOperation";
})(MediaOperationActionType || (MediaOperationActionType = {}));
var MediaOperationContentType;
(function (MediaOperationContentType) {
    MediaOperationContentType["MSML"] = "application/msml+xml";
})(MediaOperationContentType || (MediaOperationContentType = {}));
;
;
function armevents(sessionData, eventData, localParams) {
    var ret;
    var status2;
    var events;
    events = events || {};
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    headerVars.privateServiceMode = "b2bua";
    var ringingTones;
    ringingTones = ringingTones || [];
    var comf;
    comf = comf || {};
    comf.anno_name = "comfort";
    comf.anno_type = Annotype.CONNECT;
    var ring;
    ring = ring || {};
    ring.anno_name = "ringing";
    ring.anno_type = Annotype.RINGING;
    ringingTones.push(comf, ring);
    var capabilities = sessionData.inCapabilities;
    if (capabilities != null) {
        capabilities.push(Capabilities.PEM);
        capabilities.push(Capabilities.FORKING);
        sessionData.outCapabilities = JSON.stringify(capabilities);
    }
    sessionData.events = JSON.stringify(events);
    sessionData.headerrulevar = JSON.stringify(headerVars);
    sessionData.headerrulesselect = "SipServiceSpecificRulesSet";
    sessionData.ringingtones = JSON.stringify(ringingTones);
    sessionData.upstreamCapabilities = JSON.stringify([]);
    return "success";
}
function prepareCallPollAccept(session, event, localParams) {
    var log = session.log;
    try {
        var pollAction = void 0;
        pollAction = pollAction || {};
        pollAction.type = CallPollActionType.Accept;
        session.sendAction = JSON.stringify(pollAction);
        return "success";
    }
    catch (e) {
        log.debug("prepareCallPollAccept Log: {}", e);
        return "error.exception";
    }
}
function callended(session, eventData, localParams) {
    var ret = "success";
    var log = session.log;
    var callstateold = session.callstate;
    session.callstate = "CLOSED";
    session.timeend = Math.floor(new Date() / 1000);
    try {
        if (session.timeanswer != null) {
            session.duration = session.timeend - session.timeanswer;
        }
        else {
            session.duration = "not-started";
        }
    }
    catch (e) {
        session.duration = "exception";
    }
    log.error("Call_{}:State_{}->{}+", session["trace-skey"], callstateold, session.callstate);
    session.loginfo = session.loginfo + session.callstate + ";duration=" + session.duration + ";";
    var logline = {};
    try {
        logline.MSISDN = session.CalledParty;
        logline.ServiceSessionId = session["fsm-id"];
        logline.MsgType = "SIP.INVITE";
        logline.MsgSessionId = session["fsm-id"];
        logline.MsgId = "callid";
        logline.MsgDetails = session.loginfo;
        logline.Servicedetails = "";
        logline.callAnswered = session.timeanswer;
        logline.callEnded = session.timeend;
        logline.callDuration = session.duration;
        session.loginfo = "";
        logline.GwEventTime = session.timeanswer;
        var now = new Date();
        var logDate = formatDate(now);
        var logTime = formatTime(now);
        logline.LogLineTime = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
    }
    catch (e) {
        logline.MSISDN = "";
        logline.ServiceSessionId = "";
        logline.MsgType = "";
        logline.MsgSessionId = "";
        logline.MsgId = "";
        logline.MsgDetails = "";
        logline.Servicedetails = "error at CCRContinue logline";
        logline.callAnswered = "na";
        logline.callEnded = "na";
        logline.callDuration = "na";
        logline.LogLineTime = "";
    }
    ;
    logline.TraceLevel = session["fsm-trace-level"];
    session.logline = logline;
    return ret;
}
function getdisconnectreason(session, event, any, localParams) {
    var log = session.log;
    try {
        var logline = {};
        try {
            logline.MSISDN = session.CalledParty;
            logline.ServiceSessionId = session["fsm-id"];
            logline.MsgType = "SIP.INVITE";
            logline.MsgSessionId = session["fsm-id"];
            logline.MsgId = "callid";
            logline.MsgDetails = session.loginfo;
            logline.Servicedetails = "";
            logline.callAnswered = session.timeanswer;
            logline.callEnded = session.timeend;
            logline.callDuration = session.duration;
            session.loginfo = "";
            logline.GwEventTime = session.timeanswer;
            var now = new Date();
            var logDate = formatDate(now);
            var logTime = formatTime(now);
            logline.LogLineTime = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
        }
        catch (e) {
            logline.MSISDN = "";
            logline.ServiceSessionId = "";
            logline.MsgType = "";
            logline.MsgSessionId = "";
            logline.MsgId = "";
            logline.MsgDetails = "";
            logline.Servicedetails = "error at CCRContinue logline";
            logline.callAnswered = "na";
            logline.callEnded = "na";
            logline.callDuration = "na";
            logline.LogLineTime = "";
        }
        ;
        logline.TraceLevel = session["fsm-trace-level"];
        session.logline = logline;
        var events = event["events-stack"].length;
        var index = events - 1;
        if (event["events-stack"][index] === "leg.timeout") {
            return "reason.timeout";
        }
        else if (event["events-stack"][index] === "leg.max_call_duration") {
            return "reason.max_call_duration";
        }
        else {
            return "reason." + event["events-stack"][index];
        }
    }
    catch (e) {
        log.debug("getdisconnectreason Log: {}", e);
        return "reason.exception";
    }
}
function setPreconditionForwadCallb2b(session, event, localParams) {
    var ret;
    ret = ret || {};
    ret.resultCode = "success";
    var events;
    events = events || {};
    events.SIPPollEvent = "null";
    events.SIP18xInformatoinalEvent = "null";
    events.SdpAnswerEvent = "null";
    events.SIPReINVITEEvent = "null";
    events.SDPOfferPollEvent = "null";
    events.SipRingingPollEvent = "null";
    events.SipSdpOfferPollEvent = "null";
    events.SIPegClosedEvent = "null";
    events.CallBeingForwardedPollEvent = "null";
    events.SIPSdpAnswerPollEvent = "null";
    events.RingingPollEvent = "null";
    events.SIP18xAnswerEvent = "null";
    events.SIPRingingPollEvent = "null";
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    session.events = JSON.stringify(events);
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    session.headerrulevar = JSON.stringify(headerVars);
    session.headerrulesselect = "SipServiceSpecificRulesSet";
    return ret;
}
function checkSDPAnswerAction(session, event, localParams) {
    var eventData = localParams.message;
    var pollAction;
    pollAction = pollAction || {};
    pollAction.type = CallPollActionType.Reject;
    session.sendAction = JSON.stringify(pollAction);
    return true;
}
function modifydisposition(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["capabilities"] != null) {
        if (initialMsg["SIP"]["capabilities"].indexOf(Capabilities.FORKING) > -1) {
            var capabilities = [];
            session.upstreamCapabilities = JSON.stringify(capabilities);
        }
    }
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900004@172.31.11.142:5062", "sip:9900099@172.31.11.142:5062"];
    }
    return true;
}
function setdestinationlist(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900011@172.31.11.142:5062", "sip:9900022@172.31.11.142:5064", "sip:9900033@172.31.11.142:5065"];
    }
    return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFXQSxJQUFLLFlBTUo7QUFORCxXQUFLLFlBQVk7SUFDZixpQ0FBaUIsQ0FBQTtJQUNqQixtQ0FBa0IsQ0FBQTtJQUNsQiw2Q0FBMkIsQ0FBQTtJQUMzQiwyQkFBUyxDQUFBO0lBQ1QsaUNBQWUsQ0FBQTtBQUNqQixDQUFDLEVBTkksWUFBWSxLQUFaLFlBQVksUUFNaEI7QUFzREQsSUFBSyxRQUdKO0FBSEQsV0FBSyxRQUFRO0lBQ1gsK0JBQW1CLENBQUE7SUFDbkIsNEJBQWdCLENBQUE7QUFDbEIsQ0FBQyxFQUhJLFFBQVEsS0FBUixRQUFRLFFBR1o7QUF1QkQsSUFBSyxrQkFJSjtBQUpELFdBQUssa0JBQWtCO0lBQ3RCLHVDQUFpQixDQUFBO0lBQ2pCLHlDQUFtQixDQUFBO0lBQ25CLHVDQUFpQixDQUFBO0FBQ2xCLENBQUMsRUFKSSxrQkFBa0IsS0FBbEIsa0JBQWtCLFFBSXRCO0FBRUQsSUFBSyxtQkFJSjtBQUpELFdBQUssbUJBQW1CO0lBQ3ZCLCtEQUFTLENBQUE7SUFDVCxtRUFBVyxDQUFBO0lBQ1gsdUVBQWEsQ0FBQTtBQUNkLENBQUMsRUFKSSxtQkFBbUIsS0FBbkIsbUJBQW1CLFFBSXZCO0FBZ0NELElBQUssd0JBRUo7QUFGRCxXQUFLLHdCQUF3QjtJQUM1QiwyRUFBK0MsQ0FBQTtBQUNoRCxDQUFDLEVBRkksd0JBQXdCLEtBQXhCLHdCQUF3QixRQUU1QjtBQUVELElBQUsseUJBRUo7QUFGRCxXQUFLLHlCQUF5QjtJQUM3QiwwREFBNkIsQ0FBQTtBQUM5QixDQUFDLEVBRkkseUJBQXlCLEtBQXpCLHlCQUF5QixRQUU3QjtBQW1GRCxDQUFDO0FBQ0QsQ0FBQztBQUNELFNBQVMsU0FBUyxDQUFDLFdBQWUsRUFBQyxTQUFhLEVBQUMsV0FBZTtJQUMvRCxJQUFJLEdBQWUsQ0FBRTtJQUVsQixJQUFJLE9BQWdCLENBQUM7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U0FBUyxpQkFBaUIsQ0FBQyxPQUFXLEVBQUMsS0FBUyxFQUFDLFdBQWU7SUFDNUQsSUFBSSxVQUFVLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQztJQUNyQyxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxJQUFJLEVBQUU7UUFDM0MsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUV0RSxJQUFJLFlBQVksR0FBVyxFQUFFLENBQUM7WUFROUIsT0FBTyxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDL0Q7S0FDSjtJQUVELElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLGtDQUFrQyxFQUFFO1FBQzNFLE9BQU8sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxnQ0FBZ0MsRUFBRSxnQ0FBZ0MsQ0FBQyxDQUFDO0tBQzNGO0lBR0QsT0FBTyxJQUFJLENBQUM7QUFDaEIsQ0FBQztBQUdELFNBQVMsa0JBQWtCLENBQUMsT0FBVyxFQUFDLEtBQVMsRUFBQyxXQUFlO0lBQzdELElBQUksVUFBVSxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUM7SUFFckMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksa0NBQWtDLEVBQUU7UUFDM0UsT0FBTyxDQUFDLFFBQVEsR0FBRyxDQUFDLGdDQUFnQyxFQUFFLGdDQUFnQyxFQUFFLGdDQUFnQyxDQUFDLENBQUM7S0FDN0g7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXG4vL2ludGVyZmFjZSBkZWZpbml0aW9uXHJcblxyXG5pbnRlcmZhY2UgTGVnIHtcclxuICBhZGRyZXNzIDogc3RyaW5nO1xyXG4gIG5hbWUgOiBzdHJpbmdcclxufVxyXG5pbnRlcmZhY2UgQ2FsbCB7XHJcbiAgc3RhdGUgOiBudW1iZXJcclxufVxyXG5cclxuZW51bSBDYXBhYmlsaXRpZXMge1xyXG4gIFJFTDFYWCA9IFwiUkVMMVhYXCIsXHJcbiAgRk9SS0lORz0gXCJGT1JLSU5HXCIsXHJcbiAgUFJFQ09ORElUSU9OPVwiUFJFQ09ORElUSU9OXCIsXHJcbiAgUEVNPVwiUEVNXCIsXHJcbiAgVVBEQVRFPVwiVVBEQVRFXCJcclxufVxyXG5cclxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xyXG4gIG1ldGhvZCA6IFtzdHJpbmddO1xyXG4gIHR5cGUgOiBbc3RyaW5nXTtcclxuICBib2R5IDogW3N0cmluZ11cclxufVxyXG5cclxuaW50ZXJmYWNlIFNJUCB7XHJcbiAgY2FwYWJpbGl0aWVzIDogW0NhcGFiaWxpdGllc107XHJcbiAgbWVzc2FnZSA6IE1lc3NhZ2VcclxufVxyXG5cclxuaW50ZXJmYWNlIENhbGxTdGFydCB7XHJcbiAgY29udGFjdCA6IHN0cmluZztcclxuICBjYXVzZTogc3RyaW5nO1xyXG4gIGxlZyA6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FsbFBvbGwge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB0eXBlOiBzdHJpbmc7XHJcbiAgbGVnOiBzdHJpbmdcclxufVxyXG5cclxuaW50ZXJmYWNlIEV2ZW50IHtcclxuICBuYW1lIDogc3RyaW5nO1xyXG4gIGNhbGxTdGFydD8gOiBDYWxsU3RhcnQ7XHJcbiAgY2FsbFBvbGw/IDogQ2FsbFBvbGxcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBPQ0NQRXZlbnQge1xyXG4gIGNhbGxpZCA6IHN0cmluZztcclxuICBjYWxsIDogQ2FsbDtcclxuICBhcyA6IHN0cmluZztcclxuICBldmVudHRpbWUgOiBudW1iZXI7XHJcbiAgU0lQIDogU0lQO1xyXG4gIGV2ZW50OiBFdmVudFxyXG59XHJcblxyXG5pbnRlcmZhY2UgRXZlbnRzIHtcclxuICBTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnQ/IDogc3RyaW5nO1xyXG4gIFJhd0NvbnRlbnRQb2xsRXZlbnQ/IDogc3RyaW5nO1xyXG4gIEluZm9Qb2xsRXZlbnQ/OiBzdHJpbmdcclxufVxyXG4vKipcclxuICBEZWZpbmUgaGVhZGVyIHZhcmlhYmxlcyB1c2VkIGJ5IGFwcGxpY2F0aW9uXHJcbiovXHJcbmludGVyZmFjZSBIZWFkZXJWYXJzIHtcclxuICBkaXNhYmxlU2VuZERlZmF1bHRSZWFzb24/IDogc3RyaW5nO1xyXG4gIGRpc2FibGVTZW5kTm9BbnN3ZXJSZWFzb24/IDogc3RyaW5nXHJcbn1cclxuXHJcbmVudW0gQW5ub3R5cGUge1xyXG4gIENPTk5FQ1QgPSBcIkNPTk5FQ1RcIixcclxuICBSSU5HSU5HID0gXCJSSU5HXCJcclxufVxyXG5cclxuaW50ZXJmYWNlIFJpbmdpbmdUb25lIHtcclxuICBhbm5vX25hbWUgOiBzdHJpbmc7XHJcbiAgYW5ub190eXBlIDogQW5ub3R5cGVcclxufVxyXG5cclxuaW50ZXJmYWNlIFNlc3Npb24ge1xyXG4gIGxvZyA6IGFueTtcclxuICBpbkNhcGFiaWxpdGllcyA6IFtDYXBhYmlsaXRpZXNdO1xyXG4gIG91dENhcGFiaWxpdGllcz8gOiBzdHJpbmc7XHJcbiAgZXZlbnRzPyA6IHN0cmluZztcclxuICBoZWFkZXJydWxldmFyPyA6IHN0cmluZztcclxuICBoZWFkZXJydWxlc3NlbGVjdD8gOiBzdHJpbmc7XHJcbiAgcmluZ2luZ3RvbmVzPyA6IHN0cmluZztcclxuICBzZW5kQWN0aW9uPyA6IHN0cmluZyA7XHJcbiAgU0lQSGVscGVyIDogYW55O1xyXG4gIFNJUEluaXRpYWxJbnZpdGU/IDogYW55O1xyXG4gIFNJUE1lc3NhZ2U/IDogYW55O1xyXG4gIFNJUE1lc3NhZ2VUeXBlPyA6IGFueVxyXG59XHJcblxyXG5cclxuZW51bSBDYWxsUG9sbEFjdGlvblR5cGUge1xyXG4gQWNjZXB0ID0gXCJhY2NlcHRcIixcclxuIEZvcndhcmQgPSBcImZvcndhcmRcIixcclxuIFJlamVjdCA9IFwicmVqZWN0XCIsXHJcbn1cclxuXHJcbmVudW0gQ2FsbFN0YXJ0QWN0aW9uVHlwZSB7XHJcbiBBYm9ydCA9IDAsXHJcbiBGb3J3YXJkID0gMSxcclxuIFJlamVjdE1yZiA9IDJcclxufVxyXG5cclxuXHJcblxyXG4vKipcclxuIFNldCBhY3Rpb24gZm9yIENhbGxTdGFydCBldmVudFxyXG4qL1xyXG5pbnRlcmZhY2UgQ2FsbFN0YXJ0QWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsU3RhcnRBY3Rpb25UeXBlO1xyXG4gZXJyb3Jjb2RlIDogbnVtYmVyO1xyXG4gY2F1c2UgOiBzdHJpbmcgO1xyXG4gdXJpIDogc3RyaW5nO1xyXG4gZWFybHltZWRpYSA6IG51bWJlcjtcclxuIGxlZ25hbWUgOiBzdHJpbmcgXHJcbn1cclxuXHJcbi8qKlxyXG4gU2V0IGFjdGlvbiBmb3IgQ2FsbFBvbGwgZXZlbnRcclxuKi9cclxuaW50ZXJmYWNlIENhbGxQb2xsQWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsUG9sbEFjdGlvblR5cGVcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gQXBwbGljYXRpb24gY2FuIHNldCBhY3Rpb24gZm9yIGEgc3BlY2lmaWMgbGVnLCB0aGlzIGlzIGFwcGxpY2FibGUgZm9yIE1SRiBjb250YWN0XHJcbiAqL1xyXG5pbnRlcmZhY2UgTGVnQWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsU3RhcnRBY3Rpb25UeXBlIDtcclxuIGxlZ2FjdGlvbiA6IHN0cmluZ1xyXG59XHJcblxyXG5lbnVtIE1lZGlhT3BlcmF0aW9uQWN0aW9uVHlwZSB7XHJcbiBQZXJmb3JtTWVkaWFPcGVyYXRpb24gPSBcInBlcmZvcm1NZWRpYU9wZXJhdGlvblwiXHJcbn1cclxuXHJcbmVudW0gTWVkaWFPcGVyYXRpb25Db250ZW50VHlwZSB7XHJcbiBNU01MID0gXCJhcHBsaWNhdGlvbi9tc21sK3htbFwiXHJcbn1cclxuXHJcbmludGVyZmFjZSBQZXJmb3JtTWVkaWFPcGVyYXRpb24ge1xyXG4gQ29udGVudFR5cGUgOiBNZWRpYU9wZXJhdGlvbkNvbnRlbnRUeXBlO1xyXG4gQ29udGVudCA6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTWVkaWFPcGVyYXRpb25BY3Rpb24ge1xyXG4gdHlwZSA6IG51bWJlcjtcclxuIGxlZ2FjdGlvbiA6IE1lZGlhT3BlcmF0aW9uQWN0aW9uVHlwZTtcclxuIHBlcmZvcm1NZWRpYU9wZXJhdGlvbiA6IFBlcmZvcm1NZWRpYU9wZXJhdGlvblxyXG59XHJcblxyXG5pbnRlcmZhY2UgQWN0aW9uIHtcclxuIGFjdGlvbiA6IGFueSBcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBIZWFkZXIge1xyXG4gaGVhZGVyIDogc3RyaW5nO1xyXG4gdmFsdWUgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBRSGVhZGVyIHtcclxuIFByaXZhY3kgOiBzdHJpbmc7XHJcbiBSZWFzb24gOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUGFyYW1ldGVyIHtcclxuIHRyYW5zcG9ydCA6IHN0cmluZztcclxuIHVzZXIgOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVVJJIHtcclxuIHNjaGVtZSA6IHN0cmluZztcclxuIGF1dGhvcml0eSA6IHN0cmluZyA7XHJcbiBnciA6IHN0cmluZyA7XHJcbiBob3N0OiBzdHJpbmcgO1xyXG4gbHIgOiBzdHJpbmcgO1xyXG4gbWFkZHIgOiBzdHJpbmcgO1xyXG4gcG9ydCA6IG51bWJlciAgO1xyXG4gdXNlciA6IHN0cmluZyA7XHJcbiBwYXJhbWV0ZXJzIDogW1BhcmFtZXRlcl07XHJcbiBxaGVhZGVyIDogW1FIZWFkZXJdO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQWRkcmVzcyB7XHJcbiBkaXNwbGF5TmFtZSA6IHN0cmluZztcclxuIHVyaSA6IFVSSSBcclxufVxyXG5cclxuaW50ZXJmYWNlIEhpc3RvcnlJbmZvIGltcGxlbWVudHMgSGVhZGVyIHtcclxuIGFkZHJlc3MgOiBBZGRyZXNzO1xyXG4gaW5kZXggOiBzdHJpbmdcclxufVxyXG5cclxuaW50ZXJmYWNlIFBBSSBpbXBsZW1lbnRzIEhlYWRlciAge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3NcclxufVxyXG5cclxuaW50ZXJmYWNlIEZyb20gaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3M7XHJcbiB0YWcgOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVG8gaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3M7XHJcbiB0YWcgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBQQ1YgaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gaWNpZF9nZW5lcmF0ZWRfYXQ6IHN0cmluZyA7XHJcbiBpY2lkX3ZhbHVlIDogc3RyaW5nIDtcclxuIG9haWQgOiBzdHJpbmc7XHJcbiB0YWlkIDogc3RyaW5nO1xyXG4gb3NpZCA6IHN0cmluZztcclxuIHRzaWQgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBSZXN1bHRDb2RlIHtcclxuICByZXN1bHRDb2RlIDogc3RyaW5nIDtcclxufVxyXG5cbjsvL01BSU5CTE9DS1xuO1xuZnVuY3Rpb24gYXJtZXZlbnRzKHNlc3Npb25EYXRhOmFueSxldmVudERhdGE6YW55LGxvY2FsUGFyYW1zOmFueSk6IGFueSB7XG4gbGV0IHJldDogUmVzdWx0Q29kZSA7XG5cbiAgICBsZXQgc3RhdHVzMiA6IHN0cmluZztcbiAgICBsZXQgZXZlbnRzIDogRXZlbnRzO1xuICAgIGV2ZW50cyA9IGV2ZW50cyB8fCB7fTtcbiAgICBldmVudHMuSW5mb1BvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU3VjY2Vzc1Jlc3BvbnNlUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5SYXdDb250ZW50UG9sbEV2ZW50PVwidGVzdC90ZXN0XCI7XG5cbiAgICBsZXQgaGVhZGVyVmFycyA6IEhlYWRlclZhcnM7XG4gICAgaGVhZGVyVmFycyA9IGhlYWRlclZhcnMgfHwge307XG4gICAgaGVhZGVyVmFycy5kaXNhYmxlU2VuZERlZmF1bHRSZWFzb24gPSBcIkRpc2FibGVkXCI7XG4gICAgaGVhZGVyVmFycy5kaXNhYmxlU2VuZE5vQW5zd2VyUmVhc29uID0gXCJEaXNhYmxlZFwiO1xuICAgIGhlYWRlclZhcnMucHJpdmF0ZVNlcnZpY2VNb2RlID0gXCJiMmJ1YVwiO1xuXG4gICAgbGV0IHJpbmdpbmdUb25lcyA6IFtSaW5naW5nVG9uZV07XG4gICAgcmluZ2luZ1RvbmVzID0gcmluZ2luZ1RvbmVzIHx8IFtdO1xuICAgIGxldCBjb21mIDogUmluZ2luZ1RvbmU7XG4gICAgY29tZiA9IGNvbWYgfHwge307XG4gICAgY29tZi5hbm5vX25hbWU9XCJjb21mb3J0XCI7XG4gICAgY29tZi5hbm5vX3R5cGU9QW5ub3R5cGUuQ09OTkVDVDtcbiAgICBsZXQgcmluZyA6IFJpbmdpbmdUb25lO1xuICAgIHJpbmcgPSByaW5nIHx8IHt9O1xuICAgIHJpbmcuYW5ub19uYW1lPVwicmluZ2luZ1wiO1xuICAgIHJpbmcuYW5ub190eXBlPUFubm90eXBlLlJJTkdJTkc7XG4gICAgcmluZ2luZ1RvbmVzLnB1c2goY29tZiwgcmluZyk7XG5cbiAgICBsZXQgY2FwYWJpbGl0aWVzID0gc2Vzc2lvbkRhdGEuaW5DYXBhYmlsaXRpZXM7XG4gICAgaWYoIGNhcGFiaWxpdGllcyE9bnVsbCl7XG4gICAgICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5QRU0pO1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgICAgIHNlc3Npb25EYXRhLm91dENhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgfVxuXG4gICAgc2Vzc2lvbkRhdGEuZXZlbnRzID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRzKTtcbiAgICBzZXNzaW9uRGF0YS5oZWFkZXJydWxldmFyPUpTT04uc3RyaW5naWZ5KGhlYWRlclZhcnMpO1xuICAgIHNlc3Npb25EYXRhLmhlYWRlcnJ1bGVzc2VsZWN0ID0gXCJTaXBTZXJ2aWNlU3BlY2lmaWNSdWxlc1NldFwiO1xuICAgIHNlc3Npb25EYXRhLnJpbmdpbmd0b25lcyA9IEpTT04uc3RyaW5naWZ5KHJpbmdpbmdUb25lcyk7XG4gICAgc2Vzc2lvbkRhdGEudXBzdHJlYW1DYXBhYmlsaXRpZXM9SlNPTi5zdHJpbmdpZnkoW10pO1xuXG4gICAgcmV0dXJuIFwic3VjY2Vzc1wiO1xufVxuXG5cbmZ1bmN0aW9uIHByZXBhcmVDYWxsUG9sbEFjY2VwdChzZXNzaW9uOmFueSxldmVudDpPQ0NQU0lQLk9DQ1BFdmVudCxsb2NhbFBhcmFtczphbnkpIHtcbiAgICBsZXQgbG9nID0gc2Vzc2lvbi5sb2c7XG5cbiAgICB0cnkge1xuICAgICAgICBsZXQgcG9sbEFjdGlvbiA6IENhbGxQb2xsQWN0aW9uO1xuICAgICAgICBwb2xsQWN0aW9uID0gcG9sbEFjdGlvbiB8fCB7fTtcbiAgICAgICAgcG9sbEFjdGlvbi50eXBlID0gQ2FsbFBvbGxBY3Rpb25UeXBlLkFjY2VwdDtcbiAgICAgICAgc2Vzc2lvbi5zZW5kQWN0aW9uID0gSlNPTi5zdHJpbmdpZnkocG9sbEFjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIFwic3VjY2Vzc1wiOyAgICAgICAgXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZGVidWcoXCJwcmVwYXJlQ2FsbFBvbGxBY2NlcHQgTG9nOiB7fVwiLCBlKTtcbiAgICAgICAgcmV0dXJuIFwiZXJyb3IuZXhjZXB0aW9uXCI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjYWxsZW5kZWQoc2Vzc2lvbiA6IGFueSwgZXZlbnREYXRhIDogYW55LCBsb2NhbFBhcmFtczogYW55ICl7XG4gICAgbGV0IHJldDogc3RyaW5nID0gXCJzdWNjZXNzXCI7XG4gICAgLyogZW50ZXIgaGVyZSB5b3VyIGNvZGUgKi9cblxuICAgIGxldCBsb2cgOiBhbnkgPSBzZXNzaW9uLmxvZztcbiAgICBsZXQgY2FsbHN0YXRlb2xkID0gc2Vzc2lvbi5jYWxsc3RhdGU7XG4gICAgc2Vzc2lvbi5jYWxsc3RhdGUgID1cIkNMT1NFRFwiO1xuICAgIHNlc3Npb24udGltZWVuZD0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLzEwMDApO1xuICAgIHRyeSB7XG4gICAgICAgIGlmIChzZXNzaW9uLnRpbWVhbnN3ZXIhPW51bGwpIHtcbiAgICAgICAgICAgIHNlc3Npb24uZHVyYXRpb249IHNlc3Npb24udGltZWVuZCAtIHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlc3Npb24uZHVyYXRpb249XCJub3Qtc3RhcnRlZFwiOyAgICBcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgc2Vzc2lvbi5kdXJhdGlvbj1cImV4Y2VwdGlvblwiO1xuICAgIH1cblxuICAgIGxvZy5lcnJvcihcIkNhbGxfe306U3RhdGVfe30tPnt9K1wiLHNlc3Npb25bXCJ0cmFjZS1za2V5XCJdLGNhbGxzdGF0ZW9sZCxzZXNzaW9uLmNhbGxzdGF0ZSk7ICBcbiAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rc2Vzc2lvbi5jYWxsc3RhdGUrXCI7ZHVyYXRpb249XCIrc2Vzc2lvbi5kdXJhdGlvbitcIjtcIjsgICBcblxuICAgIC8vcHJlcGFyZSB0aGUgTE9HIGxpbmUgLSBzZW5kIHRvIHRoZSBsb2dfc2lwZGVtbyBwcm9jZXNzIFxuICAgIGxldCBsb2dsaW5lIDogTE9HID0ge307XG4gICAgdHJ5e1xuICAgICAgICBsb2dsaW5lLk1TSVNETiA9IHNlc3Npb24uQ2FsbGVkUGFydHk7XG4gICAgICAgIGxvZ2xpbmUuU2VydmljZVNlc3Npb25JZCA9IHNlc3Npb25bXCJmc20taWRcIl07XG4gICAgICAgIGxvZ2xpbmUuTXNnVHlwZSA9IFwiU0lQLklOVklURVwiO1xuICAgICAgICBsb2dsaW5lLk1zZ1Nlc3Npb25JZCA9IHNlc3Npb25bXCJmc20taWRcIl07XG4gICAgICAgIGxvZ2xpbmUuTXNnSWQgPSBcImNhbGxpZFwiO1xuICAgICAgICBsb2dsaW5lLk1zZ0RldGFpbHMgPSBzZXNzaW9uLmxvZ2luZm87XG4gICAgICAgIGxvZ2xpbmUuU2VydmljZWRldGFpbHMgPSBcIlwiO1xuICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgbG9nbGluZS5jYWxsRW5kZWQgPSBzZXNzaW9uLnRpbWVlbmQ7XG4gICAgICAgIGxvZ2xpbmUuY2FsbER1cmF0aW9uID0gc2Vzc2lvbi5kdXJhdGlvbjtcbiAgICAgICAgc2Vzc2lvbi5sb2dpbmZvPVwiXCI7XG5cbiAgICAgICAgLy90aW1lc3RhbXAgYWRkZWQgYnkgR1cgYmVmb3JlIGl0IHB1dCBpdCBpbnRvIHRoZSBxdWV1ZSB0byBSVEVcbiAgICAgICAgbG9nbGluZS5Hd0V2ZW50VGltZSA9IHNlc3Npb24udGltZWFuc3dlcjsgXG5cbiAgICAgICAgbGV0IG5vdyA6IERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9nRGF0ZSA6IHN0cmluZyA9IGZvcm1hdERhdGUobm93KTtcbiAgICAgICAgbGV0IGxvZ1RpbWUgOiBzdHJpbmcgPSBmb3JtYXRUaW1lKG5vdyk7XG4gICAgICAgIGxvZ2xpbmUuTG9nTGluZVRpbWUgPSBsb2dEYXRlKyBcIi5cIiArIGxvZ1RpbWUgKyBcIi5cIisoXCIwMDBcIiArIG5vdy5nZXRNaWxsaXNlY29uZHMoKS50b1N0cmluZygpKS5zbGljZSgtMyk7ICAgICAgICBcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2xpbmUuTVNJU0ROID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5TZXJ2aWNlU2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dUeXBlID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dTZXNzaW9uSWQgPSBcIlwiO1xuICAgICAgICBsb2dsaW5lLk1zZ0lkID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dEZXRhaWxzID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5TZXJ2aWNlZGV0YWlscyA9IFwiZXJyb3IgYXQgQ0NSQ29udGludWUgbG9nbGluZVwiO1xuICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IFwibmFcIjtcbiAgICAgICAgbG9nbGluZS5jYWxsRW5kZWQgPSBcIm5hXCI7XG4gICAgICAgIGxvZ2xpbmUuY2FsbER1cmF0aW9uID0gXCJuYVwiO1xuICAgICAgICBsb2dsaW5lLkxvZ0xpbmVUaW1lID0gXCJcIjtcbiAgICB9O1xuICAgIGxvZ2xpbmUuVHJhY2VMZXZlbCA9IHNlc3Npb25bXCJmc20tdHJhY2UtbGV2ZWxcIl07ICAgIFxuICAgIHNlc3Npb24ubG9nbGluZT1sb2dsaW5lOyAgICBcbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbmZ1bmN0aW9uIGdldGRpc2Nvbm5lY3RyZWFzb24oc2Vzc2lvbjphbnksZXZlbnQgYW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIC8qXG4gICAgZXZlbnRzLXN0YWNrXHRcdFs1XVxuICAgIDBcdDpcdHNpcC5jYWxsU3RhcnQuTk9ORVxuICAgIDE6XHRzaXAuY2FsbFBvbGwuU0lQU3VjY2Vzc1Jlc3BvbnNlUG9sbEV2ZW50XG4gICAgMlx0Olx0c2lwLmNhbGxBbnN3ZXJlZC5TaXBDYWxsTGVnVWFDbGllbnRcbiAgICAzXHQ6XHRsZWcubWF4X2NhbGxfZHVyYXRpb25cbiAgICA0XHQ6XHRzaXAuY2FsbFN0YXJ0LkRJU0NPTk5FQ1RFRCAgICBcbiAgICAqL1xuICAgIGxldCBsb2cgPSBzZXNzaW9uLmxvZztcblxuICAgIHRyeSB7XG5cbiAgICAgICAgLy9wcmVwYXJlIHRoZSBMT0cgbGluZSAtIHNlbmQgdG8gdGhlIGxvZ19zaXBkZW1vIHByb2Nlc3MgXG4gICAgICAgIGxldCBsb2dsaW5lIDogTE9HID0ge307XG4gICAgICAgIHRyeXtcbiAgICAgICAgICAgIGxvZ2xpbmUuTVNJU0ROID0gc2Vzc2lvbi5DYWxsZWRQYXJ0eTtcbiAgICAgICAgICAgIGxvZ2xpbmUuU2VydmljZVNlc3Npb25JZCA9IHNlc3Npb25bXCJmc20taWRcIl07XG4gICAgICAgICAgICBsb2dsaW5lLk1zZ1R5cGUgPSBcIlNJUC5JTlZJVEVcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnU2Vzc2lvbklkID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnSWQgPSBcImNhbGxpZFwiO1xuICAgICAgICAgICAgbG9nbGluZS5Nc2dEZXRhaWxzID0gc2Vzc2lvbi5sb2dpbmZvO1xuICAgICAgICAgICAgbG9nbGluZS5TZXJ2aWNlZGV0YWlscyA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgICAgIGxvZ2xpbmUuY2FsbEVuZGVkID0gc2Vzc2lvbi50aW1lZW5kO1xuICAgICAgICAgICAgbG9nbGluZS5jYWxsRHVyYXRpb24gPSBzZXNzaW9uLmR1cmF0aW9uO1xuICAgICAgICAgICAgc2Vzc2lvbi5sb2dpbmZvPVwiXCI7XG5cbiAgICAgICAgICAgIC8vdGltZXN0YW1wIGFkZGVkIGJ5IEdXIGJlZm9yZSBpdCBwdXQgaXQgaW50byB0aGUgcXVldWUgdG8gUlRFXG4gICAgICAgICAgICBsb2dsaW5lLkd3RXZlbnRUaW1lID0gc2Vzc2lvbi50aW1lYW5zd2VyOyBcblxuICAgICAgICAgICAgbGV0IG5vdyA6IERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGxvZ0RhdGUgOiBzdHJpbmcgPSBmb3JtYXREYXRlKG5vdyk7XG4gICAgICAgICAgICBsZXQgbG9nVGltZSA6IHN0cmluZyA9IGZvcm1hdFRpbWUobm93KTtcbiAgICAgICAgICAgIGxvZ2xpbmUuTG9nTGluZVRpbWUgPSBsb2dEYXRlKyBcIi5cIiArIGxvZ1RpbWUgKyBcIi5cIisoXCIwMDBcIiArIG5vdy5nZXRNaWxsaXNlY29uZHMoKS50b1N0cmluZygpKS5zbGljZSgtMyk7ICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbG9nbGluZS5NU0lTRE4gPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZS5TZXJ2aWNlU2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnVHlwZSA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lLk1zZ1Nlc3Npb25JZCA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lLk1zZ0lkID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnRGV0YWlscyA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lLlNlcnZpY2VkZXRhaWxzID0gXCJlcnJvciBhdCBDQ1JDb250aW51ZSBsb2dsaW5lXCI7XG4gICAgICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IFwibmFcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuY2FsbEVuZGVkID0gXCJuYVwiO1xuICAgICAgICAgICAgbG9nbGluZS5jYWxsRHVyYXRpb24gPSBcIm5hXCI7XG4gICAgICAgICAgICBsb2dsaW5lLkxvZ0xpbmVUaW1lID0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgbG9nbGluZS5UcmFjZUxldmVsID0gc2Vzc2lvbltcImZzbS10cmFjZS1sZXZlbFwiXTsgICAgXG4gICAgICAgIHNlc3Npb24ubG9nbGluZT1sb2dsaW5lOyAgICAgICAgICBcblxuICAgICAgICBsZXQgZXZlbnRzPWV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdLmxlbmd0aDtcbiAgICAgICAgbGV0IGluZGV4PWV2ZW50cy0xO1xuICAgICAgICBpZiAoZXZlbnRbXCJldmVudHMtc3RhY2tcIl1baW5kZXhdID09PSBcImxlZy50aW1lb3V0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBcInJlYXNvbi50aW1lb3V0XCI7XG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnRbXCJldmVudHMtc3RhY2tcIl1baW5kZXhdID09PSBcImxlZy5tYXhfY2FsbF9kdXJhdGlvblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJyZWFzb24ubWF4X2NhbGxfZHVyYXRpb25cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcInJlYXNvbi5cIiArIGV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdW2luZGV4XTsgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIFxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLmRlYnVnKFwiZ2V0ZGlzY29ubmVjdHJlYXNvbiBMb2c6IHt9XCIsIGUpO1xuICAgICAgICByZXR1cm4gXCJyZWFzb24uZXhjZXB0aW9uXCI7XG4gICAgfVxufVxuXG5cblxuXG5mdW5jdGlvbiBzZXRQcmVjb25kaXRpb25Gb3J3YWRDYWxsYjJiKHNlc3Npb246YW55LGV2ZW50OmFueSxsb2NhbFBhcmFtczphbnkpOiBSZXN1bHRDb2RlIHtcblxuICAgIGxldCByZXQ6IFJlc3VsdENvZGUgO1xuICAgIHJldCA9IHJldCB8fCB7fTtcbiAgICByZXQucmVzdWx0Q29kZT1cInN1Y2Nlc3NcIjtcbiAgICBcbiAgICBsZXQgZXZlbnRzIDogRXZlbnRzO1xuICAgIGV2ZW50cyA9IGV2ZW50cyB8fCB7fTtcblxuICAgIFxuICAgIGV2ZW50cy5TSVBQb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgLy90eXBvcyBpbiB0aGUgYmVsb3dcbiAgICBldmVudHMuU0lQMTh4SW5mb3JtYXRvaW5hbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TZHBBbnN3ZXJFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0lQUmVJTlZJVEVFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0RQT2ZmZXJQb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNpcFJpbmdpbmdQb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNpcFNkcE9mZmVyUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TSVBlZ0Nsb3NlZEV2ZW50PVwibnVsbFwiO1xuICAgIFxuICAgIGV2ZW50cy5DYWxsQmVpbmdGb3J3YXJkZWRQb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNJUFNkcEFuc3dlclBvbGxFdmVudD1cIm51bGxcIjtcblxuICAgIGV2ZW50cy5SaW5naW5nUG9sbEV2ZW50PVwibnVsbFwiO1xuXG5cblxuXG4gICAgZXZlbnRzLlNJUDE4eEFuc3dlckV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TSVBSaW5naW5nUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIC8vbmVlZHMgYSBoYW5kbGVcbiAgICBldmVudHMuSW5mb1BvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU3VjY2Vzc1Jlc3BvbnNlUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5SYXdDb250ZW50UG9sbEV2ZW50PVwidGVzdC90ZXN0XCI7XG4gICAgc2Vzc2lvbi5ldmVudHMgPSBKU09OLnN0cmluZ2lmeShldmVudHMpOyAgXG5cbiAgICAvL2xldCB1bnN1YiA9IHtcIkluZm9Qb2xsRXZlbnRcIjpcIlwiLCBcIlN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudFwiOlwiXCIsIFwiU0lQUmluZ2luZ1BvbGxFdmVudFwiOlwiXCIsIFwiUmF3Q29udGVudFBvbGxFdmVudFwiOlwiXCJ9O1xuICAgIC8vc2Vzc2lvbi51bnN1YnNjcmliZUV2ZW50cz1KU09OLnN0cmluZ2lmeSh1bnN1Yik7XG4gICAgLy9sZXQgdW5zdWIgPSB7XCJTSVAxOHhBbnN3ZXJFdmVudFwiOlwiXCJ9O1xuICAgIC8vc2Vzc2lvbi51bnN1YnNjcmliZUV2ZW50cz1KU09OLnN0cmluZ2lmeSh1bnN1Yik7XG5cbiAgICAvL1NldCBoZWFkZXJzIGZvciBvdXRnb2luZyBtZXNzYWdlXG4gICAgbGV0IGhlYWRlclZhcnMgOiBIZWFkZXJWYXJzO1xuICAgIGhlYWRlclZhcnMgPSBoZWFkZXJWYXJzIHx8IHt9O1xuICAgIGhlYWRlclZhcnMuZGlzYWJsZVNlbmREZWZhdWx0UmVhc29uID0gXCJEaXNhYmxlZFwiO1xuICAgIGhlYWRlclZhcnMuZGlzYWJsZVNlbmROb0Fuc3dlclJlYXNvbiA9IFwiRGlzYWJsZWRcIjtcbiAgICAvL1NwZWNpZnkgdGhlIE1vZGUgZm9yIHRoZSBTTkYsIHNvIFNORiBhZGRzIGl0c2VsZiB0byBSZWNvcmQtUm91dGUgKG5lZWRlZCBmb3IgYjJidWEpIG9yIG5vdCAocHJveHkpXG4gICAgLy9ub3QgbmVlZGVkIGhlcmUgLSB0aGlzIGlzIGluIFNORiB0byBhcHBseSBzb21lIHJ1bGVzIGZvciBiMmJcbiAgICAvL2hlYWRlclZhcnMucHJpdmF0ZVNlcnZpY2VNb2RlID0gXCJiMmJ1YVwiO1xuICAgIFxuICAgIHNlc3Npb24uaGVhZGVycnVsZXZhcj1KU09OLnN0cmluZ2lmeShoZWFkZXJWYXJzKTtcbiAgICBzZXNzaW9uLmhlYWRlcnJ1bGVzc2VsZWN0ID0gXCJTaXBTZXJ2aWNlU3BlY2lmaWNSdWxlc1NldFwiO1xuXG5cbiAgICBcbiAgICAvKlxuICAgIC8vdGhpcyByZXF1aXJlcyBhIFN1cHBvcnRlZDogMTAwUmVsIGluIHRoZSBpbmNvbWluZyByZXF1ZXN0IGFuZCBzZW5kcyBhIDE4MyB0byBBIHdpdGggUmVxdWlyZTogMTAwUmVsIFxuICAgIGxldCBjYXBhYmlsaXRpZXMgOiBhbnlbXSA9IFtdO1xuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5QRU0pO1xuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5SRUwxWFgpO1xuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5VUERBVEUpO1xuICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5GT1JLSU5HKTtcbiAgICBzZXNzaW9uLnVwc3RyZWFtQ2FwYWJpbGl0aWVzID0gSlNPTi5zdHJpbmdpZnkoY2FwYWJpbGl0aWVzKTtcbiAgICAqL1xuXG4gICAgLypcbiAgICBsZXQgY2FwYWJpbGl0aWVzID0gc2Vzc2lvbi5zX0luaXRpYWxDYXBhYmlsaXRpZXM7XG4gICAgaWYoIGNhcGFiaWxpdGllcyE9bnVsbCl7XG4gICAgICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5QRU0pO1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgICAgIHNlc3Npb24ub3V0Q2FwYWJpbGl0aWVzID0gSlNPTi5zdHJpbmdpZnkoY2FwYWJpbGl0aWVzKTtcbiAgICB9XG4gICAgKi9cblxuICAgIC8vIHNlc3Npb24ucmluZ2luZ3RvbmVzID0gSlNPTi5zdHJpbmdpZnkocmluZ2luZ1RvbmVzKTtcblxuICAgIHJldHVybiByZXQ7XG59XG5cblxuZnVuY3Rpb24gY2hlY2tTRFBBbnN3ZXJBY3Rpb24oc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkgIHtcbiAgICAvL2V2ZW50RGF0YSBpcyBub3cgbGFzdCBtZXNzZ2FlXG4gICAgbGV0IGV2ZW50RGF0YSA9IGxvY2FsUGFyYW1zLm1lc3NhZ2U7XG5cbiAgICAvL2FkZCB0aGUgcG9sbCBhY3Rpb25zIChhY2NlcHQsIGZvcndhcmQsIHJlamVjdCkgdG8gdGhlIGNhbGxwb2xsIGFuc2V3ciBldmVudFxuICAgIC8vSW5mb3JtYXRpb25hbEV2ZW50IGlzIGEgaGlnaC1sZXZlbCBpbnRlcmZhY2UgdHlwaWNhbGx5IHNwZWNpYWxpemVkIGZvciBjb25jcmV0ZSBldmVudHMuIFRoZSBDYWxsVXNlciBpcyBub3QgcmVxdWlyZWQgdG8gdGFrZSBhbnkgYWN0aW9uIGZvciB0aGlzIGV2ZW50LCB0aGVzZSBhcmUgcHVyZWx5IGluZm9ybWF0aW9uYWwuXG4gICAgLy9Qb2xsRXZlbnQgaXMgYW4gZXZlbnQgb24gd2hpY2ggdGhlIENhbGxVc2VyIGlzIGV4cGVjdGVkIHRvIHRha2UgYW4gYWN0aW9uIHVwb24gcmVjZWl2aW5nIHRoZSBldmVudC4gVGhlIGFjdGlvbiBpcyB1c3VhbGx5IGJ5IGludm9raW5nIHRoZSBQb2xsRXZlbnQgbWV0aG9kcyBhY2NlcHQsIHJlamVjdCBvciBmb3J3YXJkLlxuICAgIGxldCBwb2xsQWN0aW9uIDogQ2FsbFBvbGxBY3Rpb247XG4gICAgcG9sbEFjdGlvbiA9IHBvbGxBY3Rpb24gfHwge307XG4gICAgLy9wb2xsQWN0aW9uLnR5cGUgPSBDYWxsUG9sbEFjdGlvblR5cGUuQWNjZXB0O1xuICAgIHBvbGxBY3Rpb24udHlwZSA9IENhbGxQb2xsQWN0aW9uVHlwZS5SZWplY3Q7XG4gICAgc2Vzc2lvbi5zZW5kQWN0aW9uID0gSlNPTi5zdHJpbmdpZnkocG9sbEFjdGlvbik7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuXG5mdW5jdGlvbiBtb2RpZnlkaXNwb3NpdGlvbihzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KSB7XG4gICAgbGV0IGluaXRpYWxNc2cgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xuICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGluaXRpYWxNc2dbXCJTSVBcIl1bXCJjYXBhYmlsaXRpZXNcIl0uaW5kZXhPZihDYXBhYmlsaXRpZXMuRk9SS0lORykgPiAtMSkge1xuICAgICAgICAgICAgLy9pdCBpcyBwcmVzZW50LiBtZWFucyB0aGUgU0lQIGhlYWRlciBcIlJlcXVlc3QtRGlzcG9zaXRpb246IG5vLWZvcmtcIiBpcyBOT1QgcHJlc2VudC4gVGhpcyBpbnN0cnVjdHMgVEFTIHRvIG5vdCBzZW5kIDE4MyBiZWZvcmUgZm9yd2FyZGluZyB0aGUgSU5WSVRFXG4gICAgICAgICAgICBsZXQgY2FwYWJpbGl0aWVzIDogYW55W10gPSBbXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy90aGUgYmVsb3cgY3JlYXRlcyBleGNlcHRpb24gXG4gICAgICAgICAgICAvL2NhcGFiaWxpdGllcyA9IGluaXRpYWxNc2cuU0lQLmNhcGFiaWxpdGllcztcbiAgICAgICAgICAgIC8vY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICAgICAgLy90aGlzIHdvdWxkIGJlIHJlbW92ZVxuICAgICAgICAgICAgLy9sZXQgaW5kZXg9IGluaXRpYWxNc2dbXCJTSVBcIl1bXCJjYXBhYmlsaXRpZXNcIl0uaW5kZXhPZihDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgICAgICAgICAvL2luaXRpYWxNc2dbXCJTSVBcIl1bXCJjYXBhYmlsaXRpZXNcIl0uc3BsaWNlKGluZGV4LCAxKTsgLy8gMm5kIHBhcmFtZXRlciBtZWFucyByZW1vdmUgb25lIGl0ZW0gb25seVxuICAgICAgICAgICAgc2Vzc2lvbi51cHN0cmVhbUNhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7ICAgIFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGluaXRpYWxNc2dbXCJTSVBcIl1bXCJSLVVSSVwiXVtcInZhbHVlXCJdID09IFwic2lwOjk3MjAwMDAxOUAxNzIuMzEuMTEuMTQyOjUwNjJcIikge1xuICAgICAgICBzZXNzaW9uLmRlc3RsaXN0ID0gW1wic2lwOjk5MDAwMDRAMTcyLjMxLjExLjE0Mjo1MDYyXCIsIFwic2lwOjk5MDAwOTlAMTcyLjMxLjExLjE0Mjo1MDYyXCJdO1xuICAgIH1cbiAgICBcblxuICAgIHJldHVybiB0cnVlO1xufVxuXG5cbmZ1bmN0aW9uIHNldGRlc3RpbmF0aW9ubGlzdChzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KSB7XG4gICAgbGV0IGluaXRpYWxNc2cgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xuXG4gICAgaWYgKGluaXRpYWxNc2dbXCJTSVBcIl1bXCJSLVVSSVwiXVtcInZhbHVlXCJdID09IFwic2lwOjk3MjAwMDAxOUAxNzIuMzEuMTEuMTQyOjUwNjJcIikge1xuICAgICAgICBzZXNzaW9uLmRlc3RsaXN0ID0gW1wic2lwOjk5MDAwMTFAMTcyLjMxLjExLjE0Mjo1MDYyXCIsIFwic2lwOjk5MDAwMjJAMTcyLjMxLjExLjE0Mjo1MDY0XCIsIFwic2lwOjk5MDAwMzNAMTcyLjMxLjExLjE0Mjo1MDY1XCJdO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbn1cbiJdfQ==