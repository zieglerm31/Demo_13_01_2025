"use strict";
var Capabilities;
(function (Capabilities) {
    Capabilities["REL1XX"] = "REL1XX";
    Capabilities["FORKING"] = "FORKING";
    Capabilities["PRECONDITION"] = "PRECONDITION";
    Capabilities["PEM"] = "PEM";
    Capabilities["UPDATE"] = "UPDATE";
})(Capabilities || (Capabilities = {}));
var Annotype;
(function (Annotype) {
    Annotype["CONNECT"] = "CONNECT";
    Annotype["RINGING"] = "RING";
})(Annotype || (Annotype = {}));
var CallPollActionType;
(function (CallPollActionType) {
    CallPollActionType["Accept"] = "accept";
    CallPollActionType["Forward"] = "forward";
    CallPollActionType["Reject"] = "reject";
})(CallPollActionType || (CallPollActionType = {}));
var CallStartActionType;
(function (CallStartActionType) {
    CallStartActionType[CallStartActionType["Abort"] = 0] = "Abort";
    CallStartActionType[CallStartActionType["Forward"] = 1] = "Forward";
    CallStartActionType[CallStartActionType["RejectMrf"] = 2] = "RejectMrf";
})(CallStartActionType || (CallStartActionType = {}));
var MediaOperationActionType;
(function (MediaOperationActionType) {
    MediaOperationActionType["PerformMediaOperation"] = "performMediaOperation";
})(MediaOperationActionType || (MediaOperationActionType = {}));
var MediaOperationContentType;
(function (MediaOperationContentType) {
    MediaOperationContentType["MSML"] = "application/msml+xml";
})(MediaOperationContentType || (MediaOperationContentType = {}));
;
function formatDate(date) {
    var ret = date.getFullYear().toString() + ("00" + (date.getMonth() + 1).toString()).slice(-2) + ("00" + (date.getDate()).toString()).slice(-2);
    return ret;
}
function formatTime(date) {
    var ret = ("00" + date.getHours().toString()).slice(-2) + ("00" + date.getMinutes().toString()).slice(-2) + ("00" + date.getSeconds().toString()).slice(-2);
    return ret;
}
function sleepfunction(date) {
    java.lang.Thread.sleep(999);
    return "success";
}
;
;
function armevents(sessionData, eventData, localParams) {
    var ret;
    var log = sessionData.log;
    try {
        if (eventData["event-name"] = "sip.callAnswered.SipCallLegUaClient") {
            sessionData.callstate = "ANSWERED";
            sessionData.timeanswer = Math.floor(new Date() / 1000);
            log.debug("armevents: Call Answered");
        }
    }
    catch (e) {
        log.debug("armevents: Call Answered Log: {}", e);
    }
    var status2;
    var events;
    events = events || {};
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    headerVars.privateServiceMode = "b2bua";
    var ringingTones;
    ringingTones = ringingTones || [];
    var comf;
    comf = comf || {};
    comf.anno_name = "comfort";
    comf.anno_type = Annotype.CONNECT;
    var ring;
    ring = ring || {};
    ring.anno_name = "ringing";
    ring.anno_type = Annotype.RINGING;
    ringingTones.push(comf, ring);
    var capabilities = sessionData.inCapabilities;
    if (capabilities != null) {
        capabilities.push(Capabilities.PEM);
        capabilities.push(Capabilities.FORKING);
        sessionData.outCapabilities = JSON.stringify(capabilities);
    }
    sessionData.events = JSON.stringify(events);
    sessionData.headerrulevar = JSON.stringify(headerVars);
    sessionData.headerrulesselect = "SipServiceSpecificRulesSet";
    sessionData.ringingtones = JSON.stringify(ringingTones);
    sessionData.upstreamCapabilities = JSON.stringify([]);
    return "success";
}
function prepareCallPollAccept(session, event, localParams) {
    var log = session.log;
    try {
        var pollAction = void 0;
        pollAction = pollAction || {};
        pollAction.type = CallPollActionType.Accept;
        session.sendAction = JSON.stringify(pollAction);
        return "success";
    }
    catch (e) {
        log.debug("prepareCallPollAccept Log: {}", e);
        return "error.exception";
    }
}
function callended(session, eventData, localParams) {
    var ret = "success";
    var log = session.log;
    var callstateold = session.callstate;
    session.callstate = "CLOSED";
    session.timeend = Math.floor(new Date() / 1000);
    try {
        if (session.timeanswer != null) {
            session.duration = session.timeend - session.timeanswer;
        }
        else {
            session.duration = "not-started";
        }
    }
    catch (e) {
        session.duration = "exception";
    }
    log.error("Call_{}:State_{}->{}+", session["trace-skey"], callstateold, session.callstate);
    session.loginfo = session.loginfo + session.callstate + ";duration=" + session.duration + ";";
    var logline = {};
    try {
        logline.MSISDN = session["s_normalizedNumber"];
        logline.ServiceSessionId = session["fsm-id"];
        logline.MsgType = "SIP.INVITE";
        logline.MsgSessionId = session["fsm-id"];
        logline.MsgId = session["s_initialSIP"]["SIP"]["Call-ID"]["value"];
        logline.MsgDetails = "";
        logline.Servicedetails = "";
        logline.callAnswered = session.timeanswer;
        logline.callEnded = session.timeend;
        logline.callDuration = session.duration;
        session.loginfo = "";
        logline.GwEventTime = session.timeanswer;
        var now = new Date();
        var logDate = formatDate(now);
        var logTime = formatTime(now);
        logline.LogLineTime = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
    }
    catch (e) {
        logline.MSISDN = "";
        logline.ServiceSessionId = "";
        logline.MsgType = "";
        logline.MsgSessionId = "";
        logline.MsgId = "";
        logline.MsgDetails = "";
        logline.Servicedetails = "error at CCRContinue logline";
        logline.callAnswered = "na";
        logline.callEnded = "na";
        logline.callDuration = "na";
        logline.LogLineTime = "";
    }
    ;
    logline.TraceLevel = session["fsm-trace-level"];
    session.logline = logline;
    return ret;
}
function getdisconnectreason(session, event, any, localParams) {
    var log = session.log;
    try {
        session.callstate = "CLOSED";
        session.timeend = Math.floor(new Date() / 1000);
        try {
            if (session.timeanswer != null) {
                session.duration = session.timeend - session.timeanswer;
            }
            else {
                session.duration = "not-started";
            }
        }
        catch (e) {
            session.duration = "exception";
        }
        var logline = {};
        try {
            logline["MSISDN"] = session["s_normalizedNumber"];
            logline["ServiceSessionId"] = session["fsm-id"];
            logline["MsgType"] = "SIP.INVITE";
            logline["MsgSessionId"] = session["fsm-id"];
            logline["MsgId"] = session["s_initialSIP"]["SIP"]["Call-ID"]["value"];
            logline["MsgDetails"] = "to be filled";
            logline["Servicedetails"] = "to be filled";
            logline["callAnswered"] = session.timeanswer;
            logline["callEnded"] = session.timeend;
            logline["callDuration"] = session.duration;
            var now = new Date();
            var logDate = formatDate(now);
            var logTime = formatTime(now);
            logline["LogLineTime"] = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
        }
        catch (e) {
            logline["MSISDN"] = "";
            logline["ServiceSessionId"] = "";
            logline["MsgType"] = "";
            logline["MsgSessionId"] = "";
            logline["MsgId"] = "";
            logline["MsgDetails"] = "";
            logline["Servicedetails"] = "exception" + e;
            logline["callAnswered"] = "na";
            logline["callEnded"] = "na";
            logline["callDuration"] = "na";
            logline["LogLineTime"] = "na";
        }
        ;
        session.logline = logline;
        var events = event["events-stack"].length;
        var index = events - 1;
        if (event["events-stack"][index] === "leg.timeout") {
            return "reason.timeout";
        }
        else if (event["events-stack"][index] === "leg.max_call_duration") {
            return "reason.max_call_duration";
        }
        else {
            return "reason." + event["events-stack"][index];
        }
    }
    catch (e) {
        log.debug("getdisconnectreason Log: {}", e);
        return "reason.exception";
    }
}
function setPreconditionForwadCallb2b(session, event, localParams) {
    var ret;
    ret = ret || {};
    ret.resultCode = "success";
    var events;
    events = events || {};
    events.SIPPollEvent = "null";
    events.SIP18xInformatoinalEvent = "null";
    events.SdpAnswerEvent = "null";
    events.SIPReINVITEEvent = "null";
    events.SDPOfferPollEvent = "null";
    events.SipRingingPollEvent = "null";
    events.SipSdpOfferPollEvent = "null";
    events.SIPegClosedEvent = "null";
    events.CallBeingForwardedPollEvent = "null";
    events.SIPSdpAnswerPollEvent = "null";
    events.RingingPollEvent = "null";
    events.SIP18xAnswerEvent = "null";
    events.SIPRingingPollEvent = "null";
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    session.events = JSON.stringify(events);
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    session.headerrulevar = JSON.stringify(headerVars);
    session.headerrulesselect = "SipServiceSpecificRulesSet";
    return ret;
}
function checkSDPAnswerAction(session, event, localParams) {
    var eventData = localParams.message;
    var pollAction;
    pollAction = pollAction || {};
    pollAction.type = CallPollActionType.Reject;
    session.sendAction = JSON.stringify(pollAction);
    return true;
}
function modifydisposition(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["capabilities"] != null) {
        if (initialMsg["SIP"]["capabilities"].indexOf(Capabilities.FORKING) > -1) {
            var capabilities = [];
            session.upstreamCapabilities = JSON.stringify(capabilities);
        }
    }
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900004@172.31.11.142:5062", "sip:9900099@172.31.11.142:5062"];
    }
    return true;
}
function setdestinationlist(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900011@172.31.11.142:5062", "sip:9900022@172.31.11.142:5064", "sip:9900033@172.31.11.142:5065"];
    }
    return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFXQSxJQUFLLFlBTUo7QUFORCxXQUFLLFlBQVk7SUFDZixpQ0FBaUIsQ0FBQTtJQUNqQixtQ0FBa0IsQ0FBQTtJQUNsQiw2Q0FBMkIsQ0FBQTtJQUMzQiwyQkFBUyxDQUFBO0lBQ1QsaUNBQWUsQ0FBQTtBQUNqQixDQUFDLEVBTkksWUFBWSxLQUFaLFlBQVksUUFNaEI7QUFzREQsSUFBSyxRQUdKO0FBSEQsV0FBSyxRQUFRO0lBQ1gsK0JBQW1CLENBQUE7SUFDbkIsNEJBQWdCLENBQUE7QUFDbEIsQ0FBQyxFQUhJLFFBQVEsS0FBUixRQUFRLFFBR1o7QUF1QkQsSUFBSyxrQkFJSjtBQUpELFdBQUssa0JBQWtCO0lBQ3RCLHVDQUFpQixDQUFBO0lBQ2pCLHlDQUFtQixDQUFBO0lBQ25CLHVDQUFpQixDQUFBO0FBQ2xCLENBQUMsRUFKSSxrQkFBa0IsS0FBbEIsa0JBQWtCLFFBSXRCO0FBRUQsSUFBSyxtQkFJSjtBQUpELFdBQUssbUJBQW1CO0lBQ3ZCLCtEQUFTLENBQUE7SUFDVCxtRUFBVyxDQUFBO0lBQ1gsdUVBQWEsQ0FBQTtBQUNkLENBQUMsRUFKSSxtQkFBbUIsS0FBbkIsbUJBQW1CLFFBSXZCO0FBZ0NELElBQUssd0JBRUo7QUFGRCxXQUFLLHdCQUF3QjtJQUM1QiwyRUFBK0MsQ0FBQTtBQUNoRCxDQUFDLEVBRkksd0JBQXdCLEtBQXhCLHdCQUF3QixRQUU1QjtBQUVELElBQUsseUJBRUo7QUFGRCxXQUFLLHlCQUF5QjtJQUM3QiwwREFBNkIsQ0FBQTtBQUM5QixDQUFDLEVBRkkseUJBQXlCLEtBQXpCLHlCQUF5QixRQUU3QjtBQW1GRCxDQUFDO0FBRUQsU0FBUyxVQUFVLENBQUMsSUFBVztJQUMzQixJQUFJLEdBQUcsR0FBYSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEdB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QUFPLENBQUMsWUFBWSxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFO1lBRXRFLElBQUksWUFBWSxHQUFXLEVBQUUsQ0FBQztZQVE5QixPQUFPLENBQUMsb0JBQW9CLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQyxZQUFZLENBQUMsQ0FBQztTQUMvRDtLQUNKO0lBRUQsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksa0NBQWtDLEVBQUU7UUFDM0UsT0FBTyxDQUFDLFFBQVEsR0FBRyxDQUFDLGdDQUFnQyxFQUFFLGdDQUFnQyxDQUFDLENBQUM7S0FDM0Y7SUFHRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDO0FBR0QsU0FBUyxrQkFBa0IsQ0FBQyxPQUFXLEVBQUMsS0FBUyxFQUFDLFdBQWU7SUFDN0QsSUFBSSxVQUFVLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQztJQUVyQyxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxrQ0FBa0MsRUFBRTtRQUMzRSxPQUFPLENBQUMsUUFBUSxHQUFHLENBQUMsZ0NBQWdDLEVBQUUsZ0NBQWdDLEVBQUUsZ0NBQWdDLENBQUMsQ0FBQztLQUM3SDtJQUVELE9BQU8sSUFBSSxDQUFDO0FBQ2hCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vaW50ZXJmYWNlIGRlZmluaXRpb25cclxuXHJcbmludGVyZmFjZSBMZWcge1xyXG4gIGFkZHJlc3MgOiBzdHJpbmc7XHJcbiAgbmFtZSA6IHN0cmluZ1xyXG59XHJcbmludGVyZmFjZSBDYWxsIHtcclxuICBzdGF0ZSA6IG51bWJlclxyXG59XHJcblxyXG5lbnVtIENhcGFiaWxpdGllcyB7XHJcbiAgUkVMMVhYID0gXCJSRUwxWFhcIixcclxuICBGT1JLSU5HPSBcIkZPUktJTkdcIixcclxuICBQUkVDT05ESVRJT049XCJQUkVDT05ESVRJT05cIixcclxuICBQRU09XCJQRU1cIixcclxuICBVUERBVEU9XCJVUERBVEVcIlxyXG59XHJcblxyXG5pbnRlcmZhY2UgTWVzc2FnZSB7XHJcbiAgbWV0aG9kIDogW3N0cmluZ107XHJcbiAgdHlwZSA6IFtzdHJpbmddO1xyXG4gIGJvZHkgOiBbc3RyaW5nXVxyXG59XHJcblxyXG5pbnRlcmZhY2UgU0lQIHtcclxuICBjYXBhYmlsaXRpZXMgOiBbQ2FwYWJpbGl0aWVzXTtcclxuICBtZXNzYWdlIDogTWVzc2FnZVxyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FsbFN0YXJ0IHtcclxuICBjb250YWN0IDogc3RyaW5nO1xyXG4gIGNhdXNlOiBzdHJpbmc7XHJcbiAgbGVnIDogc3RyaW5nXHJcbn1cclxuXHJcbmludGVyZmFjZSBDYWxsUG9sbCB7XHJcbiAgbmFtZTogc3RyaW5nO1xyXG4gIHR5cGU6IHN0cmluZztcclxuICBsZWc6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRXZlbnQge1xyXG4gIG5hbWUgOiBzdHJpbmc7XHJcbiAgY2FsbFN0YXJ0PyA6IENhbGxTdGFydDtcclxuICBjYWxsUG9sbD8gOiBDYWxsUG9sbFxyXG59XHJcblxyXG5cclxuaW50ZXJmYWNlIE9DQ1BFdmVudCB7XHJcbiAgY2FsbGlkIDogc3RyaW5nO1xyXG4gIGNhbGwgOiBDYWxsO1xyXG4gIGFzIDogc3RyaW5nO1xyXG4gIGV2ZW50dGltZSA6IG51bWJlcjtcclxuICBTSVAgOiBTSVA7XHJcbiAgZXZlbnQ6IEV2ZW50XHJcbn1cclxuXHJcbmludGVyZmFjZSBFdmVudHMge1xyXG4gIFN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudD8gOiBzdHJpbmc7XHJcbiAgUmF3Q29udGVudFBvbGxFdmVudD8gOiBzdHJpbmc7XHJcbiAgSW5mb1BvbGxFdmVudD86IHN0cmluZ1xyXG59XHJcbi8qKlxyXG4gIERlZmluZSBoZWFkZXIgdmFyaWFibGVzIHVzZWQgYnkgYXBwbGljYXRpb25cclxuKi9cclxuaW50ZXJmYWNlIEhlYWRlclZhcnMge1xyXG4gIGRpc2FibGVTZW5kRGVmYXVsdFJlYXNvbj8gOiBzdHJpbmc7XHJcbiAgZGlzYWJsZVNlbmROb0Fuc3dlclJlYXNvbj8gOiBzdHJpbmdcclxufVxyXG5cclxuZW51bSBBbm5vdHlwZSB7XHJcbiAgQ09OTkVDVCA9IFwiQ09OTkVDVFwiLFxyXG4gIFJJTkdJTkcgPSBcIlJJTkdcIlxyXG59XHJcblxyXG5pbnRlcmZhY2UgUmluZ2luZ1RvbmUge1xyXG4gIGFubm9fbmFtZSA6IHN0cmluZztcclxuICBhbm5vX3R5cGUgOiBBbm5vdHlwZVxyXG59XHJcblxyXG5pbnRlcmZhY2UgU2Vzc2lvbiB7XHJcbiAgbG9nIDogYW55O1xyXG4gIGluQ2FwYWJpbGl0aWVzIDogW0NhcGFiaWxpdGllc107XHJcbiAgb3V0Q2FwYWJpbGl0aWVzPyA6IHN0cmluZztcclxuICBldmVudHM/IDogc3RyaW5nO1xyXG4gIGhlYWRlcnJ1bGV2YXI/IDogc3RyaW5nO1xyXG4gIGhlYWRlcnJ1bGVzc2VsZWN0PyA6IHN0cmluZztcclxuICByaW5naW5ndG9uZXM/IDogc3RyaW5nO1xyXG4gIHNlbmRBY3Rpb24/IDogc3RyaW5nIDtcclxuICBTSVBIZWxwZXIgOiBhbnk7XHJcbiAgU0lQSW5pdGlhbEludml0ZT8gOiBhbnk7XHJcbiAgU0lQTWVzc2FnZT8gOiBhbnk7XHJcbiAgU0lQTWVzc2FnZVR5cGU/IDogYW55XHJcbn1cclxuXHJcblxyXG5lbnVtIENhbGxQb2xsQWN0aW9uVHlwZSB7XHJcbiBBY2NlcHQgPSBcImFjY2VwdFwiLFxyXG4gRm9yd2FyZCA9IFwiZm9yd2FyZFwiLFxyXG4gUmVqZWN0ID0gXCJyZWplY3RcIixcclxufVxyXG5cclxuZW51bSBDYWxsU3RhcnRBY3Rpb25UeXBlIHtcclxuIEFib3J0ID0gMCxcclxuIEZvcndhcmQgPSAxLFxyXG4gUmVqZWN0TXJmID0gMlxyXG59XHJcblxyXG5cclxuXHJcbi8qKlxyXG4gU2V0IGFjdGlvbiBmb3IgQ2FsbFN0YXJ0IGV2ZW50XHJcbiovXHJcbmludGVyZmFjZSBDYWxsU3RhcnRBY3Rpb24ge1xyXG4gdHlwZSA6IENhbGxTdGFydEFjdGlvblR5cGU7XHJcbiBlcnJvcmNvZGUgOiBudW1iZXI7XHJcbiBjYXVzZSA6IHN0cmluZyA7XHJcbiB1cmkgOiBzdHJpbmc7XHJcbiBlYXJseW1lZGlhIDogbnVtYmVyO1xyXG4gbGVnbmFtZSA6IHN0cmluZyBcclxufVxyXG5cclxuLyoqXHJcbiBTZXQgYWN0aW9uIGZvciBDYWxsUG9sbCBldmVudFxyXG4qL1xyXG5pbnRlcmZhY2UgQ2FsbFBvbGxBY3Rpb24ge1xyXG4gdHlwZSA6IENhbGxQb2xsQWN0aW9uVHlwZVxyXG59XHJcblxyXG5cclxuLyoqXHJcbiBBcHBsaWNhdGlvbiBjYW4gc2V0IGFjdGlvbiBmb3IgYSBzcGVjaWZpYyBsZWcsIHRoaXMgaXMgYXBwbGljYWJsZSBmb3IgTVJGIGNvbnRhY3RcclxuICovXHJcbmludGVyZmFjZSBMZWdBY3Rpb24ge1xyXG4gdHlwZSA6IENhbGxTdGFydEFjdGlvblR5cGUgO1xyXG4gbGVnYWN0aW9uIDogc3RyaW5nXHJcbn1cclxuXHJcbmVudW0gTWVkaWFPcGVyYXRpb25BY3Rpb25UeXBlIHtcclxuIFBlcmZvcm1NZWRpYU9wZXJhdGlvbiA9IFwicGVyZm9ybU1lZGlhT3BlcmF0aW9uXCJcclxufVxyXG5cclxuZW51bSBNZWRpYU9wZXJhdGlvbkNvbnRlbnRUeXBlIHtcclxuIE1TTUwgPSBcImFwcGxpY2F0aW9uL21zbWwreG1sXCJcclxufVxyXG5cclxuaW50ZXJmYWNlIFBlcmZvcm1NZWRpYU9wZXJhdGlvbiB7XHJcbiBDb250ZW50VHlwZSA6IE1lZGlhT3BlcmF0aW9uQ29udGVudFR5cGU7XHJcbiBDb250ZW50IDogc3RyaW5nXHJcbn1cclxuXHJcbmludGVyZmFjZSBNZWRpYU9wZXJhdGlvbkFjdGlvbiB7XHJcbiB0eXBlIDogbnVtYmVyO1xyXG4gbGVnYWN0aW9uIDogTWVkaWFPcGVyYXRpb25BY3Rpb25UeXBlO1xyXG4gcGVyZm9ybU1lZGlhT3BlcmF0aW9uIDogUGVyZm9ybU1lZGlhT3BlcmF0aW9uXHJcbn1cclxuXHJcbmludGVyZmFjZSBBY3Rpb24ge1xyXG4gYWN0aW9uIDogYW55IFxyXG59XHJcblxyXG5cclxuaW50ZXJmYWNlIEhlYWRlciB7XHJcbiBoZWFkZXIgOiBzdHJpbmc7XHJcbiB2YWx1ZSA6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFFIZWFkZXIge1xyXG4gUHJpdmFjeSA6IHN0cmluZztcclxuIFJlYXNvbiA6IHN0cmluZyA7XHJcbn1cclxuXHJcbmludGVyZmFjZSBQYXJhbWV0ZXIge1xyXG4gdHJhbnNwb3J0IDogc3RyaW5nO1xyXG4gdXNlciA6IHN0cmluZyA7XHJcbn1cclxuXHJcbmludGVyZmFjZSBVUkkge1xyXG4gc2NoZW1lIDogc3RyaW5nO1xyXG4gYXV0aG9yaXR5IDogc3RyaW5nIDtcclxuIGdyIDogc3RyaW5nIDtcclxuIGhvc3Q6IHN0cmluZyA7XHJcbiBsciA6IHN0cmluZyA7XHJcbiBtYWRkciA6IHN0cmluZyA7XHJcbiBwb3J0IDogbnVtYmVyICA7XHJcbiB1c2VyIDogc3RyaW5nIDtcclxuIHBhcmFtZXRlcnMgOiBbUGFyYW1ldGVyXTtcclxuIHFoZWFkZXIgOiBbUUhlYWRlcl07XHJcbn1cclxuXHJcbmludGVyZmFjZSBBZGRyZXNzIHtcclxuIGRpc3BsYXlOYW1lIDogc3RyaW5nO1xyXG4gdXJpIDogVVJJIFxyXG59XHJcblxyXG5pbnRlcmZhY2UgSGlzdG9yeUluZm8gaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3M7XHJcbiBpbmRleCA6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUEFJIGltcGxlbWVudHMgSGVhZGVyICB7XHJcbiBhZGRyZXNzIDogQWRkcmVzc1xyXG59XHJcblxyXG5pbnRlcmZhY2UgRnJvbSBpbXBsZW1lbnRzIEhlYWRlciB7XHJcbiBhZGRyZXNzIDogQWRkcmVzcztcclxuIHRhZyA6IHN0cmluZyA7XHJcbn1cclxuXHJcbmludGVyZmFjZSBUbyBpbXBsZW1lbnRzIEhlYWRlciB7XHJcbiBhZGRyZXNzIDogQWRkcmVzcztcclxuIHRhZyA6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFBDViBpbXBsZW1lbnRzIEhlYWRlciB7XHJcbiBpY2lkX2dlbmVyYXRlZF9hdDogc3RyaW5nIDtcclxuIGljaWRfdmFsdWUgOiBzdHJpbmcgO1xyXG4gb2FpZCA6IHN0cmluZztcclxuIHRhaWQgOiBzdHJpbmc7XHJcbiBvc2lkIDogc3RyaW5nO1xyXG4gdHNpZCA6IHN0cmluZztcclxufVxyXG5cclxuaW50ZXJmYWNlIFJlc3VsdENvZGUge1xyXG4gIHJlc3VsdENvZGUgOiBzdHJpbmcgO1xyXG59XHJcblxuOy8qKiBsaWIgY29kZSAqL1xuXG5mdW5jdGlvbiBmb3JtYXREYXRlKGRhdGUgOiBEYXRlKSA6IHN0cmluZyB7XG4gICAgbGV0IHJldCA6IHN0cmluZyAgPSBkYXRlLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSArIChcIjAwXCIgKyAoZGF0ZS5nZXRNb250aCgpKzEpLnRvU3RyaW5nKCkpLnNsaWNlKC0yKSArIChcIjAwXCIrKGRhdGUuZ2V0RGF0ZSgpKS50b1N0cmluZygpKS5zbGljZSgtMik7XG4gICAgcmV0dXJuIHJldDtcbn1cblxuZnVuY3Rpb24gZm9ybWF0VGltZShkYXRlIDogRGF0ZSkgOiBzdHJpbmcge1xuICAgIGxldCByZXQgOiBzdHJpbmcgID0gKFwiMDBcIitkYXRlLmdldEhvdXJzKCkudG9TdHJpbmcoKSkuc2xpY2UoLTIpICsgKFwiMDBcIitkYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpKS5zbGljZSgtMikgKyAoXCIwMFwiK2RhdGUuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkpLnNsaWNlKC0yKTtcbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbmZ1bmN0aW9uIHNsZWVwZnVuY3Rpb24oZGF0ZSA6IERhdGUpIDogc3RyaW5nIHtcbiAgICBqYXZhLmxhbmcuVGhyZWFkLnNsZWVwKDk5OSk7XG5cbiAgICByZXR1cm4gXCJzdWNjZXNzXCI7XG59XG5cbjsvL01BSU5CTE9DS1xuO1xuZnVuY3Rpb24gYXJtZXZlbnRzKHNlc3Npb25EYXRhOmFueSxldmVudERhdGE6YW55LGxvY2FsUGFyYW1zOmFueSk6IGFueSB7XG4gICAgbGV0IHJldDogUmVzdWx0Q29kZSA7XG4gICAgbGV0IGxvZyA9IHNlc3Npb25EYXRhLmxvZztcblxuICAgIHRyeSB7XG4gICAgICAgIGlmIChldmVudERhdGFbXCJldmVudC1uYW1lXCJdID0gXCJzaXAuY2FsbEFuc3dlcmVkLlNpcENhbGxMZWdVYUNsaWVudFwiKSB7XG4gICAgICAgICAgICBzZXNzaW9uRGF0YS5jYWxsc3RhdGUgID1cIkFOU1dFUkVEXCI7XG4gICAgICAgICAgICBzZXNzaW9uRGF0YS50aW1lYW5zd2VyPSBNYXRoLmZsb29yKG5ldyBEYXRlKCkvMTAwMCk7ICAgICBcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyhcImFybWV2ZW50czogQ2FsbCBBbnN3ZXJlZFwiKTsgIFxuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZGVidWcoXCJhcm1ldmVudHM6IENhbGwgQW5zd2VyZWQgTG9nOiB7fVwiLCBlKTtcbiAgICB9XG5cbiAgICBsZXQgc3RhdHVzMiA6IHN0cmluZztcbiAgICBsZXQgZXZlbnRzIDogRXZlbnRzO1xuICAgIGV2ZW50cyA9IGV2ZW50cyB8fCB7fTtcbiAgICBldmVudHMuSW5mb1BvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU3VjY2Vzc1Jlc3BvbnNlUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5SYXdDb250ZW50UG9sbEV2ZW50PVwidGVzdC90ZXN0XCI7XG5cbiAgICBsZXQgaGVhZGVyVmFycyA6IEhlYWRlclZhcnM7XG4gICAgaGVhZGVyVmFycyA9IGhlYWRlclZhcnMgfHwge307XG4gICAgaGVhZGVyVmFycy5kaXNhYmxlU2VuZERlZmF1bHRSZWFzb24gPSBcIkRpc2FibGVkXCI7XG4gICAgaGVhZGVyVmFycy5kaXNhYmxlU2VuZE5vQW5zd2VyUmVhc29uID0gXCJEaXNhYmxlZFwiO1xuICAgIGhlYWRlclZhcnMucHJpdmF0ZVNlcnZpY2VNb2RlID0gXCJiMmJ1YVwiO1xuXG4gICAgbGV0IHJpbmdpbmdUb25lcyA6IFtSaW5naW5nVG9uZV07XG4gICAgcmluZ2luZ1RvbmVzID0gcmluZ2luZ1RvbmVzIHx8IFtdO1xuICAgIGxldCBjb21mIDogUmluZ2luZ1RvbmU7XG4gICAgY29tZiA9IGNvbWYgfHwge307XG4gICAgY29tZi5hbm5vX25hbWU9XCJjb21mb3J0XCI7XG4gICAgY29tZi5hbm5vX3R5cGU9QW5ub3R5cGUuQ09OTkVDVDtcbiAgICBsZXQgcmluZyA6IFJpbmdpbmdUb25lO1xuICAgIHJpbmcgPSByaW5nIHx8IHt9O1xuICAgIHJpbmcuYW5ub19uYW1lPVwicmluZ2luZ1wiO1xuICAgIHJpbmcuYW5ub190eXBlPUFubm90eXBlLlJJTkdJTkc7XG4gICAgcmluZ2luZ1RvbmVzLnB1c2goY29tZiwgcmluZyk7XG5cbiAgICBsZXQgY2FwYWJpbGl0aWVzID0gc2Vzc2lvbkRhdGEuaW5DYXBhYmlsaXRpZXM7XG4gICAgaWYoIGNhcGFiaWxpdGllcyE9bnVsbCl7XG4gICAgICAgIGNhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5QRU0pO1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgICAgIHNlc3Npb25EYXRhLm91dENhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgfVxuXG4gICAgc2Vzc2lvbkRhdGEuZXZlbnRzID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRzKTtcbiAgICBzZXNzaW9uRGF0YS5oZWFkZXJydWxldmFyPUpTT04uc3RyaW5naWZ5KGhlYWRlclZhcnMpO1xuICAgIHNlc3Npb25EYXRhLmhlYWRlcnJ1bGVzc2VsZWN0ID0gXCJTaXBTZXJ2aWNlU3BlY2lmaWNSdWxlc1NldFwiO1xuICAgIHNlc3Npb25EYXRhLnJpbmdpbmd0b25lcyA9IEpTT04uc3RyaW5naWZ5KHJpbmdpbmdUb25lcyk7XG4gICAgc2Vzc2lvbkRhdGEudXBzdHJlYW1DYXBhYmlsaXRpZXM9SlNPTi5zdHJpbmdpZnkoW10pO1xuXG4gICAgcmV0dXJuIFwic3VjY2Vzc1wiO1xufVxuXG5cbmZ1bmN0aW9uIHByZXBhcmVDYWxsUG9sbEFjY2VwdChzZXNzaW9uOmFueSxldmVudDpPQ0NQU0lQLk9DQ1BFdmVudCxsb2NhbFBhcmFtczphbnkpIHtcbiAgICBsZXQgbG9nID0gc2Vzc2lvbi5sb2c7XG5cbiAgICB0cnkge1xuICAgICAgICBsZXQgcG9sbEFjdGlvbiA6IENhbGxQb2xsQWN0aW9uO1xuICAgICAgICBwb2xsQWN0aW9uID0gcG9sbEFjdGlvbiB8fCB7fTtcbiAgICAgICAgcG9sbEFjdGlvbi50eXBlID0gQ2FsbFBvbGxBY3Rpb25UeXBlLkFjY2VwdDtcbiAgICAgICAgc2Vzc2lvbi5zZW5kQWN0aW9uID0gSlNPTi5zdHJpbmdpZnkocG9sbEFjdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIFwic3VjY2Vzc1wiOyAgICAgICAgXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuZGVidWcoXCJwcmVwYXJlQ2FsbFBvbGxBY2NlcHQgTG9nOiB7fVwiLCBlKTtcbiAgICAgICAgcmV0dXJuIFwiZXJyb3IuZXhjZXB0aW9uXCI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBjYWxsZW5kZWQoc2Vzc2lvbiA6IGFueSwgZXZlbnREYXRhIDogYW55LCBsb2NhbFBhcmFtczogYW55ICl7XG4gICAgbGV0IHJldDogc3RyaW5nID0gXCJzdWNjZXNzXCI7XG4gICAgLyogZW50ZXIgaGVyZSB5b3VyIGNvZGUgKi9cblxuICAgIGxldCBsb2cgOiBhbnkgPSBzZXNzaW9uLmxvZztcbiAgICBsZXQgY2FsbHN0YXRlb2xkID0gc2Vzc2lvbi5jYWxsc3RhdGU7XG4gICAgc2Vzc2lvbi5jYWxsc3RhdGUgID1cIkNMT1NFRFwiO1xuICAgIHNlc3Npb24udGltZWVuZD0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLzEwMDApO1xuICAgIHRyeSB7XG4gICAgICAgIGlmIChzZXNzaW9uLnRpbWVhbnN3ZXIhPW51bGwpIHtcbiAgICAgICAgICAgIHNlc3Npb24uZHVyYXRpb249IHNlc3Npb24udGltZWVuZCAtIHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlc3Npb24uZHVyYXRpb249XCJub3Qtc3RhcnRlZFwiOyAgICBcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgc2Vzc2lvbi5kdXJhdGlvbj1cImV4Y2VwdGlvblwiO1xuICAgIH1cblxuICAgIGxvZy5lcnJvcihcIkNhbGxfe306U3RhdGVfe30tPnt9K1wiLHNlc3Npb25bXCJ0cmFjZS1za2V5XCJdLGNhbGxzdGF0ZW9sZCxzZXNzaW9uLmNhbGxzdGF0ZSk7ICBcbiAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rc2Vzc2lvbi5jYWxsc3RhdGUrXCI7ZHVyYXRpb249XCIrc2Vzc2lvbi5kdXJhdGlvbitcIjtcIjsgICBcblxuICAgIC8vcHJlcGFyZSB0aGUgTE9HIGxpbmUgLSBzZW5kIHRvIHRoZSBsb2dfc2lwZGVtbyBwcm9jZXNzIFxuICAgIGxldCBsb2dsaW5lID0ge307XG4gICAgdHJ5e1xuICAgICAgICAgICAgbG9nbGluZS5NU0lTRE4gPSBzZXNzaW9uW1wic19ub3JtYWxpemVkTnVtYmVyXCJdO1xuICAgICAgICAgICAgbG9nbGluZS5TZXJ2aWNlU2Vzc2lvbklkID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnVHlwZSA9IFwiU0lQLklOVklURVwiO1xuICAgICAgICAgICAgbG9nbGluZS5Nc2dTZXNzaW9uSWQgPSBzZXNzaW9uW1wiZnNtLWlkXCJdO1xuICAgICAgICAgICAgbG9nbGluZS5Nc2dJZCA9IHNlc3Npb25bXCJzX2luaXRpYWxTSVBcIl1bXCJTSVBcIl1bXCJDYWxsLUlEXCJdW1widmFsdWVcIl07XG4gICAgICAgICAgICBsb2dsaW5lLk1zZ0RldGFpbHMgPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZS5TZXJ2aWNlZGV0YWlscyA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgICAgIGxvZ2xpbmUuY2FsbEVuZGVkID0gc2Vzc2lvbi50aW1lZW5kO1xuICAgICAgICAgICAgbG9nbGluZS5jYWxsRHVyYXRpb24gPSBzZXNzaW9uLmR1cmF0aW9uO1xuICAgICAgICAgICAgc2Vzc2lvbi5sb2dpbmZvPVwiXCI7XG5cbiAgICAgICAgLy90aW1lc3RhbXAgYWRkZWQgYnkgR1cgYmVmb3JlIGl0IHB1dCBpdCBpbnRvIHRoZSBxdWV1ZSB0byBSVEVcbiAgICAgICAgbG9nbGluZS5Hd0V2ZW50VGltZSA9IHNlc3Npb24udGltZWFuc3dlcjsgXG5cbiAgICAgICAgbGV0IG5vdyA6IERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICBsZXQgbG9nRGF0ZSA6IHN0cmluZyA9IGZvcm1hdERhdGUobm93KTtcbiAgICAgICAgbGV0IGxvZ1RpbWUgOiBzdHJpbmcgPSBmb3JtYXRUaW1lKG5vdyk7XG4gICAgICAgIGxvZ2xpbmUuTG9nTGluZVRpbWUgPSBsb2dEYXRlKyBcIi5cIiArIGxvZ1RpbWUgKyBcIi5cIisoXCIwMDBcIiArIG5vdy5nZXRNaWxsaXNlY29uZHMoKS50b1N0cmluZygpKS5zbGljZSgtMyk7ICAgICAgICBcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZ2xpbmUuTVNJU0ROID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5TZXJ2aWNlU2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dUeXBlID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dTZXNzaW9uSWQgPSBcIlwiO1xuICAgICAgICBsb2dsaW5lLk1zZ0lkID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dEZXRhaWxzID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5TZXJ2aWNlZGV0YWlscyA9IFwiZXJyb3IgYXQgQ0NSQ29udGludWUgbG9nbGluZVwiO1xuICAgICAgICBsb2dsaW5lLmNhbGxBbnN3ZXJlZCA9IFwibmFcIjtcbiAgICAgICAgbG9nbGluZS5jYWxsRW5kZWQgPSBcIm5hXCI7XG4gICAgICAgIGxvZ2xpbmUuY2FsbER1cmF0aW9uID0gXCJuYVwiO1xuICAgICAgICBsb2dsaW5lLkxvZ0xpbmVUaW1lID0gXCJcIjtcbiAgICB9O1xuICAgIGxvZ2xpbmUuVHJhY2VMZXZlbCA9IHNlc3Npb25bXCJmc20tdHJhY2UtbGV2ZWxcIl07ICAgIFxuICAgIHNlc3Npb24ubG9nbGluZT1sb2dsaW5lOyAgICBcbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbmZ1bmN0aW9uIGdldGRpc2Nvbm5lY3RyZWFzb24oc2Vzc2lvbjphbnksZXZlbnQgYW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIC8qXG4gICAgZXZlbnRzLXN0YWNrXHRcdFs1XVxuICAgIDBcdDpcdHNpcC5jYWxsU3RhcnQuTk9ORVxuICAgIDE6XHRzaXAuY2FsbFBvbGwuU0lQU3VjY2Vzc1Jlc3BvbnNlUG9sbEV2ZW50XG4gICAgMlx0Olx0c2lwLmNhbGxBbnN3ZXJlZC5TaXBDYWxsTGVnVWFDbGllbnRcbiAgICAzXHQ6XHRsZWcubWF4X2NhbGxfZHVyYXRpb25cbiAgICA0XHQ6XHRzaXAuY2FsbFN0YXJ0LkRJU0NPTk5FQ1RFRCAgICBcbiAgICAqL1xuICAgIGxldCBsb2cgPSBzZXNzaW9uLmxvZztcblxuICAgIHRyeSB7XG5cbiAgICAgICAgc2Vzc2lvbi5jYWxsc3RhdGUgID1cIkNMT1NFRFwiO1xuICAgICAgICBzZXNzaW9uLnRpbWVlbmQ9IE1hdGguZmxvb3IobmV3IERhdGUoKS8xMDAwKTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGlmIChzZXNzaW9uLnRpbWVhbnN3ZXIhPW51bGwpIHtcbiAgICAgICAgICAgICAgICBzZXNzaW9uLmR1cmF0aW9uPSBzZXNzaW9uLnRpbWVlbmQgLSBzZXNzaW9uLnRpbWVhbnN3ZXI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHNlc3Npb24uZHVyYXRpb249XCJub3Qtc3RhcnRlZFwiOyAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgc2Vzc2lvbi5kdXJhdGlvbj1cImV4Y2VwdGlvblwiO1xuICAgICAgICB9XG4gICAgICAgIC8vcHJlcGFyZSB0aGUgTE9HIGxpbmUgLSBzZW5kIHRvIHRoZSBsb2dfc2lwZGVtbyBwcm9jZXNzIFxuICAgICAgICBsZXQgbG9nbGluZSA9IHt9O1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTVNJU0ROXCJdID0gc2Vzc2lvbltcInNfbm9ybWFsaXplZE51bWJlclwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlU2Vzc2lvbklkXCJdID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dUeXBlXCJdID0gXCJTSVAuSU5WSVRFXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTXNnU2Vzc2lvbklkXCJdID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dJZFwiXSA9IHNlc3Npb25bXCJzX2luaXRpYWxTSVBcIl1bXCJTSVBcIl1bXCJDYWxsLUlEXCJdW1widmFsdWVcIl07XG4gICAgICAgICAgICBsb2dsaW5lW1wiTXNnRGV0YWlsc1wiXSA9IFwidG8gYmUgZmlsbGVkXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiU2VydmljZWRldGFpbHNcIl0gPSBcInRvIGJlIGZpbGxlZFwiO1xuICAgICAgICAgICAgbG9nbGluZVtcImNhbGxBbnN3ZXJlZFwiXSA9IHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJjYWxsRW5kZWRcIl0gPSBzZXNzaW9uLnRpbWVlbmQ7XG4gICAgICAgICAgICBsb2dsaW5lW1wiY2FsbER1cmF0aW9uXCJdID0gc2Vzc2lvbi5kdXJhdGlvbjtcblxuICAgICAgICAgICAgbGV0IG5vdyA6IERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGxvZ0RhdGUgOiBzdHJpbmcgPSBmb3JtYXREYXRlKG5vdyk7XG4gICAgICAgICAgICBsZXQgbG9nVGltZSA6IHN0cmluZyA9IGZvcm1hdFRpbWUobm93KTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJMb2dMaW5lVGltZVwiXSA9IGxvZ0RhdGUrIFwiLlwiICsgbG9nVGltZSArIFwiLlwiKyhcIjAwMFwiICsgbm93LmdldE1pbGxpc2Vjb25kcygpLnRvU3RyaW5nKCkpLnNsaWNlKC0zKTsgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTVNJU0ROXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlU2Vzc2lvbklkXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dUeXBlXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dTZXNzaW9uSWRcIl0gPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZVtcIk1zZ0lkXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dEZXRhaWxzXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlZGV0YWlsc1wiXSA9IFwiZXhjZXB0aW9uXCIgKyBlO1xuICAgICAgICAgICAgbG9nbGluZVtcImNhbGxBbnN3ZXJlZFwiXSA9IFwibmFcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJjYWxsRW5kZWRcIl0gPSBcIm5hXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiY2FsbER1cmF0aW9uXCJdID0gXCJuYVwiO1xuICAgICAgICAgICAgbG9nbGluZVtcIkxvZ0xpbmVUaW1lXCJdID0gXCJuYVwiO1xuICAgICAgICB9O1xuICAgICAgICBzZXNzaW9uLmxvZ2xpbmU9bG9nbGluZTsgICAgICAgICAgXG5cbiAgICAgICAgbGV0IGV2ZW50cz1ldmVudFtcImV2ZW50cy1zdGFja1wiXS5sZW5ndGg7XG4gICAgICAgIGxldCBpbmRleD1ldmVudHMtMTtcbiAgICAgICAgaWYgKGV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdW2luZGV4XSA9PT0gXCJsZWcudGltZW91dFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJyZWFzb24udGltZW91dFwiO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdW2luZGV4XSA9PT0gXCJsZWcubWF4X2NhbGxfZHVyYXRpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIFwicmVhc29uLm1heF9jYWxsX2R1cmF0aW9uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJyZWFzb24uXCIgKyBldmVudFtcImV2ZW50cy1zdGFja1wiXVtpbmRleF07ICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhcImdldGRpc2Nvbm5lY3RyZWFzb24gTG9nOiB7fVwiLCBlKTtcbiAgICAgICAgcmV0dXJuIFwicmVhc29uLmV4Y2VwdGlvblwiO1xuICAgIH1cbn1cblxuXG5cblxuZnVuY3Rpb24gc2V0UHJlY29uZGl0aW9uRm9yd2FkQ2FsbGIyYihzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KTogUmVzdWx0Q29kZSB7XG5cbiAgICBsZXQgcmV0OiBSZXN1bHRDb2RlIDtcbiAgICByZXQgPSByZXQgfHwge307XG4gICAgcmV0LnJlc3VsdENvZGU9XCJzdWNjZXNzXCI7XG4gICAgXG4gICAgbGV0IGV2ZW50cyA6IEV2ZW50cztcbiAgICBldmVudHMgPSBldmVudHMgfHwge307XG5cbiAgICBcbiAgICBldmVudHMuU0lQUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIC8vdHlwb3MgaW4gdGhlIGJlbG93XG4gICAgZXZlbnRzLlNJUDE4eEluZm9ybWF0b2luYWxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU2RwQW5zd2VyRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNJUFJlSU5WSVRFRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNEUE9mZmVyUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TaXBSaW5naW5nUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TaXBTZHBPZmZlclBvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0lQZWdDbG9zZWRFdmVudD1cIm51bGxcIjtcbiAgICBcbiAgICBldmVudHMuQ2FsbEJlaW5nRm9yd2FyZGVkUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TSVBTZHBBbnN3ZXJQb2xsRXZlbnQ9XCJudWxsXCI7XG5cbiAgICBldmVudHMuUmluZ2luZ1BvbGxFdmVudD1cIm51bGxcIjtcblxuXG5cblxuICAgIGV2ZW50cy5TSVAxOHhBbnN3ZXJFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0lQUmluZ2luZ1BvbGxFdmVudD1cIm51bGxcIjtcbiAgICAvL25lZWRzIGEgaGFuZGxlXG4gICAgZXZlbnRzLkluZm9Qb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuUmF3Q29udGVudFBvbGxFdmVudD1cInRlc3QvdGVzdFwiO1xuICAgIHNlc3Npb24uZXZlbnRzID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRzKTsgIFxuXG4gICAgLy9sZXQgdW5zdWIgPSB7XCJJbmZvUG9sbEV2ZW50XCI6XCJcIiwgXCJTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnRcIjpcIlwiLCBcIlNJUFJpbmdpbmdQb2xsRXZlbnRcIjpcIlwiLCBcIlJhd0NvbnRlbnRQb2xsRXZlbnRcIjpcIlwifTtcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpO1xuICAgIC8vbGV0IHVuc3ViID0ge1wiU0lQMTh4QW5zd2VyRXZlbnRcIjpcIlwifTtcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpO1xuXG4gICAgLy9TZXQgaGVhZGVycyBmb3Igb3V0Z29pbmcgbWVzc2FnZVxuICAgIGxldCBoZWFkZXJWYXJzIDogSGVhZGVyVmFycztcbiAgICBoZWFkZXJWYXJzID0gaGVhZGVyVmFycyB8fCB7fTtcbiAgICBoZWFkZXJWYXJzLmRpc2FibGVTZW5kRGVmYXVsdFJlYXNvbiA9IFwiRGlzYWJsZWRcIjtcbiAgICBoZWFkZXJWYXJzLmRpc2FibGVTZW5kTm9BbnN3ZXJSZWFzb24gPSBcIkRpc2FibGVkXCI7XG4gICAgLy9TcGVjaWZ5IHRoZSBNb2RlIGZvciB0aGUgU05GLCBzbyBTTkYgYWRkcyBpdHNlbGYgdG8gUmVjb3JkLVJvdXRlIChuZWVkZWQgZm9yIGIyYnVhKSBvciBub3QgKHByb3h5KVxuICAgIC8vbm90IG5lZWRlZCBoZXJlIC0gdGhpcyBpcyBpbiBTTkYgdG8gYXBwbHkgc29tZSBydWxlcyBmb3IgYjJiXG4gICAgLy9oZWFkZXJWYXJzLnByaXZhdGVTZXJ2aWNlTW9kZSA9IFwiYjJidWFcIjtcbiAgICBcbiAgICBzZXNzaW9uLmhlYWRlcnJ1bGV2YXI9SlNPTi5zdHJpbmdpZnkoaGVhZGVyVmFycyk7XG4gICAgc2Vzc2lvbi5oZWFkZXJydWxlc3NlbGVjdCA9IFwiU2lwU2VydmljZVNwZWNpZmljUnVsZXNTZXRcIjtcblxuXG4gICAgXG4gICAgLypcbiAgICAvL3RoaXMgcmVxdWlyZXMgYSBTdXBwb3J0ZWQ6IDEwMFJlbCBpbiB0aGUgaW5jb21pbmcgcmVxdWVzdCBhbmQgc2VuZHMgYSAxODMgdG8gQSB3aXRoIFJlcXVpcmU6IDEwMFJlbCBcbiAgICBsZXQgY2FwYWJpbGl0aWVzIDogYW55W10gPSBbXTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUkVMMVhYKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuVVBEQVRFKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgc2Vzc2lvbi51cHN0cmVhbUNhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgKi9cblxuICAgIC8qXG4gICAgbGV0IGNhcGFiaWxpdGllcyA9IHNlc3Npb24uc19Jbml0aWFsQ2FwYWJpbGl0aWVzO1xuICAgIGlmKCBjYXBhYmlsaXRpZXMhPW51bGwpe1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcbiAgICAgICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICBzZXNzaW9uLm91dENhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgfVxuICAgICovXG5cbiAgICAvLyBzZXNzaW9uLnJpbmdpbmd0b25lcyA9IEpTT04uc3RyaW5naWZ5KHJpbmdpbmdUb25lcyk7XG5cbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbmZ1bmN0aW9uIGNoZWNrU0RQQW5zd2VyQWN0aW9uKHNlc3Npb246YW55LGV2ZW50OmFueSxsb2NhbFBhcmFtczphbnkpICB7XG4gICAgLy9ldmVudERhdGEgaXMgbm93IGxhc3QgbWVzc2dhZVxuICAgIGxldCBldmVudERhdGEgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xuXG4gICAgLy9hZGQgdGhlIHBvbGwgYWN0aW9ucyAoYWNjZXB0LCBmb3J3YXJkLCByZWplY3QpIHRvIHRoZSBjYWxscG9sbCBhbnNld3IgZXZlbnRcbiAgICAvL0luZm9ybWF0aW9uYWxFdmVudCBpcyBhIGhpZ2gtbGV2ZWwgaW50ZXJmYWNlIHR5cGljYWxseSBzcGVjaWFsaXplZCBmb3IgY29uY3JldGUgZXZlbnRzLiBUaGUgQ2FsbFVzZXIgaXMgbm90IHJlcXVpcmVkIHRvIHRha2UgYW55IGFjdGlvbiBmb3IgdGhpcyBldmVudCwgdGhlc2UgYXJlIHB1cmVseSBpbmZvcm1hdGlvbmFsLlxuICAgIC8vUG9sbEV2ZW50IGlzIGFuIGV2ZW50IG9uIHdoaWNoIHRoZSBDYWxsVXNlciBpcyBleHBlY3RlZCB0byB0YWtlIGFuIGFjdGlvbiB1cG9uIHJlY2VpdmluZyB0aGUgZXZlbnQuIFRoZSBhY3Rpb24gaXMgdXN1YWxseSBieSBpbnZva2luZyB0aGUgUG9sbEV2ZW50IG1ldGhvZHMgYWNjZXB0LCByZWplY3Qgb3IgZm9yd2FyZC5cbiAgICBsZXQgcG9sbEFjdGlvbiA6IENhbGxQb2xsQWN0aW9uO1xuICAgIHBvbGxBY3Rpb24gPSBwb2xsQWN0aW9uIHx8IHt9O1xuICAgIC8vcG9sbEFjdGlvbi50eXBlID0gQ2FsbFBvbGxBY3Rpb25UeXBlLkFjY2VwdDtcbiAgICBwb2xsQWN0aW9uLnR5cGUgPSBDYWxsUG9sbEFjdGlvblR5cGUuUmVqZWN0O1xuICAgIHNlc3Npb24uc2VuZEFjdGlvbiA9IEpTT04uc3RyaW5naWZ5KHBvbGxBY3Rpb24pO1xuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cblxuZnVuY3Rpb24gbW9kaWZ5ZGlzcG9zaXRpb24oc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIGxldCBpbml0aWFsTXNnID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcbiAgICBpZiAoaW5pdGlhbE1zZ1tcIlNJUFwiXVtcImNhcGFiaWxpdGllc1wiXSAhPSBudWxsKSB7XG4gICAgICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLmluZGV4T2YoQ2FwYWJpbGl0aWVzLkZPUktJTkcpID4gLTEpIHtcbiAgICAgICAgICAgIC8vaXQgaXMgcHJlc2VudC4gbWVhbnMgdGhlIFNJUCBoZWFkZXIgXCJSZXF1ZXN0LURpc3Bvc2l0aW9uOiBuby1mb3JrXCIgaXMgTk9UIHByZXNlbnQuIFRoaXMgaW5zdHJ1Y3RzIFRBUyB0byBub3Qgc2VuZCAxODMgYmVmb3JlIGZvcndhcmRpbmcgdGhlIElOVklURVxuICAgICAgICAgICAgbGV0IGNhcGFiaWxpdGllcyA6IGFueVtdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vdGhlIGJlbG93IGNyZWF0ZXMgZXhjZXB0aW9uIFxuICAgICAgICAgICAgLy9jYXBhYmlsaXRpZXMgPSBpbml0aWFsTXNnLlNJUC5jYXBhYmlsaXRpZXM7XG4gICAgICAgICAgICAvL2NhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5GT1JLSU5HKTtcbiAgICAgICAgICAgIC8vdGhpcyB3b3VsZCBiZSByZW1vdmVcbiAgICAgICAgICAgIC8vbGV0IGluZGV4PSBpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLmluZGV4T2YoQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICAgICAgLy9pbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLnNwbGljZShpbmRleCwgMSk7IC8vIDJuZCBwYXJhbWV0ZXIgbWVhbnMgcmVtb3ZlIG9uZSBpdGVtIG9ubHlcbiAgICAgICAgICAgIHNlc3Npb24udXBzdHJlYW1DYXBhYmlsaXRpZXMgPSBKU09OLnN0cmluZ2lmeShjYXBhYmlsaXRpZXMpOyAgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiUi1VUklcIl1bXCJ2YWx1ZVwiXSA9PSBcInNpcDo5NzIwMDAwMTlAMTcyLjMxLjExLjE0Mjo1MDYyXCIpIHtcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDA0QDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDk5QDE3Mi4zMS4xMS4xNDI6NTA2MlwiXTtcbiAgICB9XG4gICAgXG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuXG5mdW5jdGlvbiBzZXRkZXN0aW5hdGlvbmxpc3Qoc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIGxldCBpbml0aWFsTXNnID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcblxuICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiUi1VUklcIl1bXCJ2YWx1ZVwiXSA9PSBcInNpcDo5NzIwMDAwMTlAMTcyLjMxLjExLjE0Mjo1MDYyXCIpIHtcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDExQDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDIyQDE3Mi4zMS4xMS4xNDI6NTA2NFwiLCBcInNpcDo5OTAwMDMzQDE3Mi4zMS4xMS4xNDI6NTA2NVwiXTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG59XG4iXX0=