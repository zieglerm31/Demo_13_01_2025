"use strict";
var Capabilities;
(function (Capabilities) {
    Capabilities["REL1XX"] = "REL1XX";
    Capabilities["FORKING"] = "FORKING";
    Capabilities["PRECONDITION"] = "PRECONDITION";
    Capabilities["PEM"] = "PEM";
    Capabilities["UPDATE"] = "UPDATE";
})(Capabilities || (Capabilities = {}));
var Annotype;
(function (Annotype) {
    Annotype["CONNECT"] = "CONNECT";
    Annotype["RINGING"] = "RING";
})(Annotype || (Annotype = {}));
var CallPollActionType;
(function (CallPollActionType) {
    CallPollActionType["Accept"] = "accept";
    CallPollActionType["Forward"] = "forward";
    CallPollActionType["Reject"] = "reject";
})(CallPollActionType || (CallPollActionType = {}));
var CallStartActionType;
(function (CallStartActionType) {
    CallStartActionType[CallStartActionType["Abort"] = 0] = "Abort";
    CallStartActionType[CallStartActionType["Forward"] = 1] = "Forward";
    CallStartActionType[CallStartActionType["RejectMrf"] = 2] = "RejectMrf";
})(CallStartActionType || (CallStartActionType = {}));
var MediaOperationActionType;
(function (MediaOperationActionType) {
    MediaOperationActionType["PerformMediaOperation"] = "performMediaOperation";
})(MediaOperationActionType || (MediaOperationActionType = {}));
var MediaOperationContentType;
(function (MediaOperationContentType) {
    MediaOperationContentType["MSML"] = "application/msml+xml";
})(MediaOperationContentType || (MediaOperationContentType = {}));
;
function formatDate(date) {
    var ret = date.getFullYear().toString() + ("00" + (date.getMonth() + 1).toString()).slice(-2) + ("00" + (date.getDate()).toString()).slice(-2);
    return ret;
}
function formatTime(date) {
    var ret = ("00" + date.getHours().toString()).slice(-2) + ("00" + date.getMinutes().toString()).slice(-2) + ("00" + date.getSeconds().toString()).slice(-2);
    return ret;
}
function sleepfunction(date) {
    java.lang.Thread.sleep(999);
    return "success";
}
;
;
function armevents(sessionData, eventData, localParams) {
    var ret;
    var status2;
    var events;
    events = events || {};
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    headerVars.privateServiceMode = "b2bua";
    var ringingTones;
    ringingTones = ringingTones || [];
    var comf;
    comf = comf || {};
    comf.anno_name = "comfort";
    comf.anno_type = Annotype.CONNECT;
    var ring;
    ring = ring || {};
    ring.anno_name = "ringing";
    ring.anno_type = Annotype.RINGING;
    ringingTones.push(comf, ring);
    var capabilities = sessionData.inCapabilities;
    if (capabilities != null) {
        capabilities.push(Capabilities.PEM);
        capabilities.push(Capabilities.FORKING);
        sessionData.outCapabilities = JSON.stringify(capabilities);
    }
    sessionData.events = JSON.stringify(events);
    sessionData.headerrulevar = JSON.stringify(headerVars);
    sessionData.headerrulesselect = "SipServiceSpecificRulesSet";
    sessionData.ringingtones = JSON.stringify(ringingTones);
    sessionData.upstreamCapabilities = JSON.stringify([]);
    return "success";
}
function prepareCallPollAccept(session, event, localParams) {
    var log = session.log;
    try {
        var pollAction = void 0;
        pollAction = pollAction || {};
        pollAction.type = CallPollActionType.Accept;
        session.sendAction = JSON.stringify(pollAction);
        return "success";
    }
    catch (e) {
        log.debug("prepareCallPollAccept Log: {}", e);
        return "error.exception";
    }
}
function callended(session, eventData, localParams) {
    var ret = "success";
    var log = session.log;
    var callstateold = session.callstate;
    session.callstate = "CLOSED";
    session.timeend = Math.floor(new Date() / 1000);
    try {
        if (session.timeanswer != null) {
            session.duration = session.timeend - session.timeanswer;
        }
        else {
            session.duration = "not-started";
        }
    }
    catch (e) {
        session.duration = "exception";
    }
    log.error("Call_{}:State_{}->{}+", session["trace-skey"], callstateold, session.callstate);
    session.loginfo = session.loginfo + session.callstate + ";duration=" + session.duration + ";";
    var logline = {};
    try {
        logline.MSISDN = session["s_normalizedNumber"];
        logline.ServiceSessionId = session["fsm-id"];
        logline.MsgType = "SIP.INVITE";
        logline.MsgSessionId = session["fsm-id"];
        logline.MsgId = session["s_initialSIP"]["SIP"]["Call-ID"]["value"];
        logline.MsgDetails = "";
        logline.Servicedetails = "";
        logline.callAnswered = session.timeanswer;
        logline.callEnded = session.timeend;
        logline.callDuration = session.duration;
        session.loginfo = "";
        logline.GwEventTime = session.timeanswer;
        var now = new Date();
        var logDate = formatDate(now);
        var logTime = formatTime(now);
        logline.LogLineTime = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
    }
    catch (e) {
        logline.MSISDN = "";
        logline.ServiceSessionId = "";
        logline.MsgType = "";
        logline.MsgSessionId = "";
        logline.MsgId = "";
        logline.MsgDetails = "";
        logline.Servicedetails = "error at CCRContinue logline";
        logline.callAnswered = "na";
        logline.callEnded = "na";
        logline.callDuration = "na";
        logline.LogLineTime = "";
    }
    ;
    logline.TraceLevel = session["fsm-trace-level"];
    session.logline = logline;
    return ret;
}
function getdisconnectreason(session, event, any, localParams) {
    var log = session.log;
    try {
        var logline = {};
        try {
            logline["MSISDN"] = session["s_normalizedNumber"];
            logline["ServiceSessionId"] = session["fsm-id"];
            logline["MsgType"] = "SIP.INVITE";
            logline["MsgSessionId"] = session["fsm-id"];
            logline["MsgId"] = session["s_initialSIP"]["SIP"]["Call-ID"]["value"];
            logline["MsgDetails"] = "";
            logline["Servicedetails"] = "";
            logline["callAnswered"] = session.timeanswer;
            logline["callEnded"] = session.timeend;
            logline["callDuration"] = session.duration;
            var now = new Date();
            var logDate = formatDate(now);
            var logTime = formatTime(now);
            logline["LogLineTime"] = logDate + "." + logTime + "." + ("000" + now.getMilliseconds().toString()).slice(-3);
        }
        catch (e) {
            logline["MSISDN"] = "";
            logline["ServiceSessionId"] = "";
            logline["MsgType"] = "";
            logline["MsgSessionId"] = "";
            logline["MsgId"] = "";
            logline["MsgDetails"] = "";
            logline["Servicedetails"] = "exception" + e;
            logline["callAnswered"] = "na";
            logline["callEnded"] = "na";
            logline["callDuration"] = "na";
            logline["LogLineTime"] = "na";
        }
        ;
        session.logline = logline;
        var events = event["events-stack"].length;
        var index = events - 1;
        if (event["events-stack"][index] === "leg.timeout") {
            return "reason.timeout";
        }
        else if (event["events-stack"][index] === "leg.max_call_duration") {
            return "reason.max_call_duration";
        }
        else {
            return "reason." + event["events-stack"][index];
        }
    }
    catch (e) {
        log.debug("getdisconnectreason Log: {}", e);
        return "reason.exception";
    }
}
function setPreconditionForwadCallb2b(session, event, localParams) {
    var ret;
    ret = ret || {};
    ret.resultCode = "success";
    var events;
    events = events || {};
    events.SIPPollEvent = "null";
    events.SIP18xInformatoinalEvent = "null";
    events.SdpAnswerEvent = "null";
    events.SIPReINVITEEvent = "null";
    events.SDPOfferPollEvent = "null";
    events.SipRingingPollEvent = "null";
    events.SipSdpOfferPollEvent = "null";
    events.SIPegClosedEvent = "null";
    events.CallBeingForwardedPollEvent = "null";
    events.SIPSdpAnswerPollEvent = "null";
    events.RingingPollEvent = "null";
    events.SIP18xAnswerEvent = "null";
    events.SIPRingingPollEvent = "null";
    events.InfoPollEvent = "null";
    events.SuccessResponsePollEvent = "null";
    events.RawContentPollEvent = "test/test";
    session.events = JSON.stringify(events);
    var headerVars;
    headerVars = headerVars || {};
    headerVars.disableSendDefaultReason = "Disabled";
    headerVars.disableSendNoAnswerReason = "Disabled";
    session.headerrulevar = JSON.stringify(headerVars);
    session.headerrulesselect = "SipServiceSpecificRulesSet";
    return ret;
}
function checkSDPAnswerAction(session, event, localParams) {
    var eventData = localParams.message;
    var pollAction;
    pollAction = pollAction || {};
    pollAction.type = CallPollActionType.Reject;
    session.sendAction = JSON.stringify(pollAction);
    return true;
}
function modifydisposition(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["capabilities"] != null) {
        if (initialMsg["SIP"]["capabilities"].indexOf(Capabilities.FORKING) > -1) {
            var capabilities = [];
            session.upstreamCapabilities = JSON.stringify(capabilities);
        }
    }
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900004@172.31.11.142:5062", "sip:9900099@172.31.11.142:5062"];
    }
    return true;
}
function setdestinationlist(session, event, localParams) {
    var initialMsg = localParams.message;
    if (initialMsg["SIP"]["R-URI"]["value"] == "sip:972000019@172.31.11.142:5062") {
        session.destlist = ["sip:9900011@172.31.11.142:5062", "sip:9900022@172.31.11.142:5064", "sip:9900033@172.31.11.142:5065"];
    }
    return true;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFXQSxJQUFLLFlBTUo7QUFORCxXQUFLLFlBQVk7SUFDZixpQ0FBaUIsQ0FBQTtJQUNqQixtQ0FBa0IsQ0FBQTtJQUNsQiw2Q0FBMkIsQ0FBQTtJQUMzQiwyQkFBUyxDQUFBO0lBQ1QsaUNBQWUsQ0FBQTtBQUNqQixDQUFDLEVBTkksWUFBWSxLQUFaLFlBQVksUUFNaEI7QUFzREQsSUFBSyxRQUdKO0FBSEQsV0FBSyxRQUFRO0lBQ1gsK0JBQW1CLENBQUE7SUFDbkIsNEJBQWdCLENBQUE7QUFDbEIsQ0FBQyxFQUhJLFFBQVEsS0FBUixRQUFRLFFBR1o7QUF1QkQsSUFBSyxrQkFJSjtBQUpELFdBQUssa0JBQWtCO0lBQ3RCLHVDQUFpQixDQUFBO0lBQ2pCLHlDQUFtQixDQUFBO0lBQ25CLHVDQUFpQixDQUFBO0FBQ2xCLENBQUMsRUFKSSxrQkFBa0IsS0FBbEIsa0JBQWtCLFFBSXRCO0FBRUQsSUFBSyxtQkFJSjtBQUpELFdBQUssbUJBQW1CO0lBQ3ZCLCtEQUFTLENBQUE7SUFDVCxtRUFBVyxDQUFBO0lBQ1gsdUVBQWEsQ0FBQTtBQUNkLENBQUMsRUFKSSxtQkFBbUIsS0FBbkIsbUJBQW1CLFFBSXZCO0FBZ0NELElBQUssd0JBRUo7QUFGRCxXQUFLLHdCQUF3QjtJQUM1QiwyRUFBK0MsQ0FBQTtBQUNoRCxDQUFDLEVBRkksd0JBQXdCLEtBQXhCLHdCQUF3QixRQUU1QjtBQUVELElBQUsseUJBRUo7QUFGRCxXQUFLLHlCQUF5QjtJQUM3QiwwREFBNkIsQ0FBQTtBQUM5QixDQUFDLEVBRkkseUJBQXlCLEtBQXpCLHlCQUF5QixRQUU3QjtBQW1GRCxDQUFDO0FBRUQsU0FBUyxVQUFVLENBQUMsSUFBVztJQUMzQixJQUFJLEdBQUcsR0FBYSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEdB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R0QsU0FBUyxpQkFBaUIsQ0FBQyxPQUFXLEVBQUMsS0FBUyxFQUFDLFdBQWU7SUFDNUQsSUFBSSxVQUFVLEdBQUcsV0FBVyxDQUFDLE9BQU8sQ0FBQztJQUNyQyxJQUFJLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxJQUFJLEVBQUU7UUFDM0MsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRTtZQUV0RSxJQUFJLFlBQVksR0FBVyxFQUFFLENBQUM7WUFROUIsT0FBTyxDQUFDLG9CQUFvQixHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7U0FDL0Q7S0FDSjtJQUVELElBQUksVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLGtDQUFrQyxFQUFFO1FBQzNFLE9BQU8sQ0FBQyxRQUFRLEdBQUcsQ0FBQyxnQ0FBZ0MsRUFBRSxnQ0FBZ0MsQ0FBQyxDQUFDO0tBQzNGO0lBR0QsT0FBTyxJQUFJLENBQUM7QUFDaEIsQ0FBQztBQUdELFNBQVMsa0JBQWtCLENBQUMsT0FBVyxFQUFDLEtBQVMsRUFBQyxXQUFlO0lBQzdELElBQUksVUFBVSxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUM7SUFFckMsSUFBSSxVQUFVLENBQUMsS0FBSyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksa0NBQWtDLEVBQUU7UUFDM0UsT0FBTyxDQUFDLFFBQVEsR0FBRyxDQUFDLGdDQUFnQyxFQUFFLGdDQUFnQyxFQUFFLGdDQUFnQyxDQUFDLENBQUM7S0FDN0g7SUFFRCxPQUFPLElBQUksQ0FBQztBQUNoQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiXG4vL2ludGVyZmFjZSBkZWZpbml0aW9uXHJcblxyXG5pbnRlcmZhY2UgTGVnIHtcclxuICBhZGRyZXNzIDogc3RyaW5nO1xyXG4gIG5hbWUgOiBzdHJpbmdcclxufVxyXG5pbnRlcmZhY2UgQ2FsbCB7XHJcbiAgc3RhdGUgOiBudW1iZXJcclxufVxyXG5cclxuZW51bSBDYXBhYmlsaXRpZXMge1xyXG4gIFJFTDFYWCA9IFwiUkVMMVhYXCIsXHJcbiAgRk9SS0lORz0gXCJGT1JLSU5HXCIsXHJcbiAgUFJFQ09ORElUSU9OPVwiUFJFQ09ORElUSU9OXCIsXHJcbiAgUEVNPVwiUEVNXCIsXHJcbiAgVVBEQVRFPVwiVVBEQVRFXCJcclxufVxyXG5cclxuaW50ZXJmYWNlIE1lc3NhZ2Uge1xyXG4gIG1ldGhvZCA6IFtzdHJpbmddO1xyXG4gIHR5cGUgOiBbc3RyaW5nXTtcclxuICBib2R5IDogW3N0cmluZ11cclxufVxyXG5cclxuaW50ZXJmYWNlIFNJUCB7XHJcbiAgY2FwYWJpbGl0aWVzIDogW0NhcGFiaWxpdGllc107XHJcbiAgbWVzc2FnZSA6IE1lc3NhZ2VcclxufVxyXG5cclxuaW50ZXJmYWNlIENhbGxTdGFydCB7XHJcbiAgY29udGFjdCA6IHN0cmluZztcclxuICBjYXVzZTogc3RyaW5nO1xyXG4gIGxlZyA6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQ2FsbFBvbGwge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB0eXBlOiBzdHJpbmc7XHJcbiAgbGVnOiBzdHJpbmdcclxufVxyXG5cclxuaW50ZXJmYWNlIEV2ZW50IHtcclxuICBuYW1lIDogc3RyaW5nO1xyXG4gIGNhbGxTdGFydD8gOiBDYWxsU3RhcnQ7XHJcbiAgY2FsbFBvbGw/IDogQ2FsbFBvbGxcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBPQ0NQRXZlbnQge1xyXG4gIGNhbGxpZCA6IHN0cmluZztcclxuICBjYWxsIDogQ2FsbDtcclxuICBhcyA6IHN0cmluZztcclxuICBldmVudHRpbWUgOiBudW1iZXI7XHJcbiAgU0lQIDogU0lQO1xyXG4gIGV2ZW50OiBFdmVudFxyXG59XHJcblxyXG5pbnRlcmZhY2UgRXZlbnRzIHtcclxuICBTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnQ/IDogc3RyaW5nO1xyXG4gIFJhd0NvbnRlbnRQb2xsRXZlbnQ/IDogc3RyaW5nO1xyXG4gIEluZm9Qb2xsRXZlbnQ/OiBzdHJpbmdcclxufVxyXG4vKipcclxuICBEZWZpbmUgaGVhZGVyIHZhcmlhYmxlcyB1c2VkIGJ5IGFwcGxpY2F0aW9uXHJcbiovXHJcbmludGVyZmFjZSBIZWFkZXJWYXJzIHtcclxuICBkaXNhYmxlU2VuZERlZmF1bHRSZWFzb24/IDogc3RyaW5nO1xyXG4gIGRpc2FibGVTZW5kTm9BbnN3ZXJSZWFzb24/IDogc3RyaW5nXHJcbn1cclxuXHJcbmVudW0gQW5ub3R5cGUge1xyXG4gIENPTk5FQ1QgPSBcIkNPTk5FQ1RcIixcclxuICBSSU5HSU5HID0gXCJSSU5HXCJcclxufVxyXG5cclxuaW50ZXJmYWNlIFJpbmdpbmdUb25lIHtcclxuICBhbm5vX25hbWUgOiBzdHJpbmc7XHJcbiAgYW5ub190eXBlIDogQW5ub3R5cGVcclxufVxyXG5cclxuaW50ZXJmYWNlIFNlc3Npb24ge1xyXG4gIGxvZyA6IGFueTtcclxuICBpbkNhcGFiaWxpdGllcyA6IFtDYXBhYmlsaXRpZXNdO1xyXG4gIG91dENhcGFiaWxpdGllcz8gOiBzdHJpbmc7XHJcbiAgZXZlbnRzPyA6IHN0cmluZztcclxuICBoZWFkZXJydWxldmFyPyA6IHN0cmluZztcclxuICBoZWFkZXJydWxlc3NlbGVjdD8gOiBzdHJpbmc7XHJcbiAgcmluZ2luZ3RvbmVzPyA6IHN0cmluZztcclxuICBzZW5kQWN0aW9uPyA6IHN0cmluZyA7XHJcbiAgU0lQSGVscGVyIDogYW55O1xyXG4gIFNJUEluaXRpYWxJbnZpdGU/IDogYW55O1xyXG4gIFNJUE1lc3NhZ2U/IDogYW55O1xyXG4gIFNJUE1lc3NhZ2VUeXBlPyA6IGFueVxyXG59XHJcblxyXG5cclxuZW51bSBDYWxsUG9sbEFjdGlvblR5cGUge1xyXG4gQWNjZXB0ID0gXCJhY2NlcHRcIixcclxuIEZvcndhcmQgPSBcImZvcndhcmRcIixcclxuIFJlamVjdCA9IFwicmVqZWN0XCIsXHJcbn1cclxuXHJcbmVudW0gQ2FsbFN0YXJ0QWN0aW9uVHlwZSB7XHJcbiBBYm9ydCA9IDAsXHJcbiBGb3J3YXJkID0gMSxcclxuIFJlamVjdE1yZiA9IDJcclxufVxyXG5cclxuXHJcblxyXG4vKipcclxuIFNldCBhY3Rpb24gZm9yIENhbGxTdGFydCBldmVudFxyXG4qL1xyXG5pbnRlcmZhY2UgQ2FsbFN0YXJ0QWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsU3RhcnRBY3Rpb25UeXBlO1xyXG4gZXJyb3Jjb2RlIDogbnVtYmVyO1xyXG4gY2F1c2UgOiBzdHJpbmcgO1xyXG4gdXJpIDogc3RyaW5nO1xyXG4gZWFybHltZWRpYSA6IG51bWJlcjtcclxuIGxlZ25hbWUgOiBzdHJpbmcgXHJcbn1cclxuXHJcbi8qKlxyXG4gU2V0IGFjdGlvbiBmb3IgQ2FsbFBvbGwgZXZlbnRcclxuKi9cclxuaW50ZXJmYWNlIENhbGxQb2xsQWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsUG9sbEFjdGlvblR5cGVcclxufVxyXG5cclxuXHJcbi8qKlxyXG4gQXBwbGljYXRpb24gY2FuIHNldCBhY3Rpb24gZm9yIGEgc3BlY2lmaWMgbGVnLCB0aGlzIGlzIGFwcGxpY2FibGUgZm9yIE1SRiBjb250YWN0XHJcbiAqL1xyXG5pbnRlcmZhY2UgTGVnQWN0aW9uIHtcclxuIHR5cGUgOiBDYWxsU3RhcnRBY3Rpb25UeXBlIDtcclxuIGxlZ2FjdGlvbiA6IHN0cmluZ1xyXG59XHJcblxyXG5lbnVtIE1lZGlhT3BlcmF0aW9uQWN0aW9uVHlwZSB7XHJcbiBQZXJmb3JtTWVkaWFPcGVyYXRpb24gPSBcInBlcmZvcm1NZWRpYU9wZXJhdGlvblwiXHJcbn1cclxuXHJcbmVudW0gTWVkaWFPcGVyYXRpb25Db250ZW50VHlwZSB7XHJcbiBNU01MID0gXCJhcHBsaWNhdGlvbi9tc21sK3htbFwiXHJcbn1cclxuXHJcbmludGVyZmFjZSBQZXJmb3JtTWVkaWFPcGVyYXRpb24ge1xyXG4gQ29udGVudFR5cGUgOiBNZWRpYU9wZXJhdGlvbkNvbnRlbnRUeXBlO1xyXG4gQ29udGVudCA6IHN0cmluZ1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTWVkaWFPcGVyYXRpb25BY3Rpb24ge1xyXG4gdHlwZSA6IG51bWJlcjtcclxuIGxlZ2FjdGlvbiA6IE1lZGlhT3BlcmF0aW9uQWN0aW9uVHlwZTtcclxuIHBlcmZvcm1NZWRpYU9wZXJhdGlvbiA6IFBlcmZvcm1NZWRpYU9wZXJhdGlvblxyXG59XHJcblxyXG5pbnRlcmZhY2UgQWN0aW9uIHtcclxuIGFjdGlvbiA6IGFueSBcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBIZWFkZXIge1xyXG4gaGVhZGVyIDogc3RyaW5nO1xyXG4gdmFsdWUgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBRSGVhZGVyIHtcclxuIFByaXZhY3kgOiBzdHJpbmc7XHJcbiBSZWFzb24gOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgUGFyYW1ldGVyIHtcclxuIHRyYW5zcG9ydCA6IHN0cmluZztcclxuIHVzZXIgOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVVJJIHtcclxuIHNjaGVtZSA6IHN0cmluZztcclxuIGF1dGhvcml0eSA6IHN0cmluZyA7XHJcbiBnciA6IHN0cmluZyA7XHJcbiBob3N0OiBzdHJpbmcgO1xyXG4gbHIgOiBzdHJpbmcgO1xyXG4gbWFkZHIgOiBzdHJpbmcgO1xyXG4gcG9ydCA6IG51bWJlciAgO1xyXG4gdXNlciA6IHN0cmluZyA7XHJcbiBwYXJhbWV0ZXJzIDogW1BhcmFtZXRlcl07XHJcbiBxaGVhZGVyIDogW1FIZWFkZXJdO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgQWRkcmVzcyB7XHJcbiBkaXNwbGF5TmFtZSA6IHN0cmluZztcclxuIHVyaSA6IFVSSSBcclxufVxyXG5cclxuaW50ZXJmYWNlIEhpc3RvcnlJbmZvIGltcGxlbWVudHMgSGVhZGVyIHtcclxuIGFkZHJlc3MgOiBBZGRyZXNzO1xyXG4gaW5kZXggOiBzdHJpbmdcclxufVxyXG5cclxuaW50ZXJmYWNlIFBBSSBpbXBsZW1lbnRzIEhlYWRlciAge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3NcclxufVxyXG5cclxuaW50ZXJmYWNlIEZyb20gaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3M7XHJcbiB0YWcgOiBzdHJpbmcgO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgVG8gaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gYWRkcmVzcyA6IEFkZHJlc3M7XHJcbiB0YWcgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBQQ1YgaW1wbGVtZW50cyBIZWFkZXIge1xyXG4gaWNpZF9nZW5lcmF0ZWRfYXQ6IHN0cmluZyA7XHJcbiBpY2lkX3ZhbHVlIDogc3RyaW5nIDtcclxuIG9haWQgOiBzdHJpbmc7XHJcbiB0YWlkIDogc3RyaW5nO1xyXG4gb3NpZCA6IHN0cmluZztcclxuIHRzaWQgOiBzdHJpbmc7XHJcbn1cclxuXHJcbmludGVyZmFjZSBSZXN1bHRDb2RlIHtcclxuICByZXN1bHRDb2RlIDogc3RyaW5nIDtcclxufVxyXG5cbjsvKiogbGliIGNvZGUgKi9cblxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlIDogRGF0ZSkgOiBzdHJpbmcge1xuICAgIGxldCByZXQgOiBzdHJpbmcgID0gZGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkgKyAoXCIwMFwiICsgKGRhdGUuZ2V0TW9udGgoKSsxKS50b1N0cmluZygpKS5zbGljZSgtMikgKyAoXCIwMFwiKyhkYXRlLmdldERhdGUoKSkudG9TdHJpbmcoKSkuc2xpY2UoLTIpO1xuICAgIHJldHVybiByZXQ7XG59XG5cbmZ1bmN0aW9uIGZvcm1hdFRpbWUoZGF0ZSA6IERhdGUpIDogc3RyaW5nIHtcbiAgICBsZXQgcmV0IDogc3RyaW5nICA9IChcIjAwXCIrZGF0ZS5nZXRIb3VycygpLnRvU3RyaW5nKCkpLnNsaWNlKC0yKSArIChcIjAwXCIrZGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKSkuc2xpY2UoLTIpICsgKFwiMDBcIitkYXRlLmdldFNlY29uZHMoKS50b1N0cmluZygpKS5zbGljZSgtMik7XG4gICAgcmV0dXJuIHJldDtcbn1cblxuXG5mdW5jdGlvbiBzbGVlcGZ1bmN0aW9uKGRhdGUgOiBEYXRlKSA6IHN0cmluZyB7XG4gICAgamF2YS5sYW5nLlRocmVhZC5zbGVlcCg5OTkpO1xuXG4gICAgcmV0dXJuIFwic3VjY2Vzc1wiO1xufVxuXG47Ly9NQUlOQkxPQ0tcbjtcbmZ1bmN0aW9uIGFybWV2ZW50cyhzZXNzaW9uRGF0YTphbnksZXZlbnREYXRhOmFueSxsb2NhbFBhcmFtczphbnkpOiBhbnkge1xuIGxldCByZXQ6IFJlc3VsdENvZGUgO1xuXG4gICAgbGV0IHN0YXR1czIgOiBzdHJpbmc7XG4gICAgbGV0IGV2ZW50cyA6IEV2ZW50cztcbiAgICBldmVudHMgPSBldmVudHMgfHwge307XG4gICAgZXZlbnRzLkluZm9Qb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuUmF3Q29udGVudFBvbGxFdmVudD1cInRlc3QvdGVzdFwiO1xuXG4gICAgbGV0IGhlYWRlclZhcnMgOiBIZWFkZXJWYXJzO1xuICAgIGhlYWRlclZhcnMgPSBoZWFkZXJWYXJzIHx8IHt9O1xuICAgIGhlYWRlclZhcnMuZGlzYWJsZVNlbmREZWZhdWx0UmVhc29uID0gXCJEaXNhYmxlZFwiO1xuICAgIGhlYWRlclZhcnMuZGlzYWJsZVNlbmROb0Fuc3dlclJlYXNvbiA9IFwiRGlzYWJsZWRcIjtcbiAgICBoZWFkZXJWYXJzLnByaXZhdGVTZXJ2aWNlTW9kZSA9IFwiYjJidWFcIjtcblxuICAgIGxldCByaW5naW5nVG9uZXMgOiBbUmluZ2luZ1RvbmVdO1xuICAgIHJpbmdpbmdUb25lcyA9IHJpbmdpbmdUb25lcyB8fCBbXTtcbiAgICBsZXQgY29tZiA6IFJpbmdpbmdUb25lO1xuICAgIGNvbWYgPSBjb21mIHx8IHt9O1xuICAgIGNvbWYuYW5ub19uYW1lPVwiY29tZm9ydFwiO1xuICAgIGNvbWYuYW5ub190eXBlPUFubm90eXBlLkNPTk5FQ1Q7XG4gICAgbGV0IHJpbmcgOiBSaW5naW5nVG9uZTtcbiAgICByaW5nID0gcmluZyB8fCB7fTtcbiAgICByaW5nLmFubm9fbmFtZT1cInJpbmdpbmdcIjtcbiAgICByaW5nLmFubm9fdHlwZT1Bbm5vdHlwZS5SSU5HSU5HO1xuICAgIHJpbmdpbmdUb25lcy5wdXNoKGNvbWYsIHJpbmcpO1xuXG4gICAgbGV0IGNhcGFiaWxpdGllcyA9IHNlc3Npb25EYXRhLmluQ2FwYWJpbGl0aWVzO1xuICAgIGlmKCBjYXBhYmlsaXRpZXMhPW51bGwpe1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcbiAgICAgICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICBzZXNzaW9uRGF0YS5vdXRDYXBhYmlsaXRpZXMgPSBKU09OLnN0cmluZ2lmeShjYXBhYmlsaXRpZXMpO1xuICAgIH1cblxuICAgIHNlc3Npb25EYXRhLmV2ZW50cyA9IEpTT04uc3RyaW5naWZ5KGV2ZW50cyk7XG4gICAgc2Vzc2lvbkRhdGEuaGVhZGVycnVsZXZhcj1KU09OLnN0cmluZ2lmeShoZWFkZXJWYXJzKTtcbiAgICBzZXNzaW9uRGF0YS5oZWFkZXJydWxlc3NlbGVjdCA9IFwiU2lwU2VydmljZVNwZWNpZmljUnVsZXNTZXRcIjtcbiAgICBzZXNzaW9uRGF0YS5yaW5naW5ndG9uZXMgPSBKU09OLnN0cmluZ2lmeShyaW5naW5nVG9uZXMpO1xuICAgIHNlc3Npb25EYXRhLnVwc3RyZWFtQ2FwYWJpbGl0aWVzPUpTT04uc3RyaW5naWZ5KFtdKTtcblxuICAgIHJldHVybiBcInN1Y2Nlc3NcIjtcbn1cblxuXG5mdW5jdGlvbiBwcmVwYXJlQ2FsbFBvbGxBY2NlcHQoc2Vzc2lvbjphbnksZXZlbnQ6T0NDUFNJUC5PQ0NQRXZlbnQsbG9jYWxQYXJhbXM6YW55KSB7XG4gICAgbGV0IGxvZyA9IHNlc3Npb24ubG9nO1xuXG4gICAgdHJ5IHtcbiAgICAgICAgbGV0IHBvbGxBY3Rpb24gOiBDYWxsUG9sbEFjdGlvbjtcbiAgICAgICAgcG9sbEFjdGlvbiA9IHBvbGxBY3Rpb24gfHwge307XG4gICAgICAgIHBvbGxBY3Rpb24udHlwZSA9IENhbGxQb2xsQWN0aW9uVHlwZS5BY2NlcHQ7XG4gICAgICAgIHNlc3Npb24uc2VuZEFjdGlvbiA9IEpTT04uc3RyaW5naWZ5KHBvbGxBY3Rpb24pO1xuXG4gICAgICAgIHJldHVybiBcInN1Y2Nlc3NcIjsgICAgICAgIFxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nLmRlYnVnKFwicHJlcGFyZUNhbGxQb2xsQWNjZXB0IExvZzoge31cIiwgZSk7XG4gICAgICAgIHJldHVybiBcImVycm9yLmV4Y2VwdGlvblwiO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gY2FsbGVuZGVkKHNlc3Npb24gOiBhbnksIGV2ZW50RGF0YSA6IGFueSwgbG9jYWxQYXJhbXM6IGFueSApe1xuICAgIGxldCByZXQ6IHN0cmluZyA9IFwic3VjY2Vzc1wiO1xuICAgIC8qIGVudGVyIGhlcmUgeW91ciBjb2RlICovXG5cbiAgICBsZXQgbG9nIDogYW55ID0gc2Vzc2lvbi5sb2c7XG4gICAgbGV0IGNhbGxzdGF0ZW9sZCA9IHNlc3Npb24uY2FsbHN0YXRlO1xuICAgIHNlc3Npb24uY2FsbHN0YXRlICA9XCJDTE9TRURcIjtcbiAgICBzZXNzaW9uLnRpbWVlbmQ9IE1hdGguZmxvb3IobmV3IERhdGUoKS8xMDAwKTtcbiAgICB0cnkge1xuICAgICAgICBpZiAoc2Vzc2lvbi50aW1lYW5zd2VyIT1udWxsKSB7XG4gICAgICAgICAgICBzZXNzaW9uLmR1cmF0aW9uPSBzZXNzaW9uLnRpbWVlbmQgLSBzZXNzaW9uLnRpbWVhbnN3ZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXNzaW9uLmR1cmF0aW9uPVwibm90LXN0YXJ0ZWRcIjsgICAgXG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIHNlc3Npb24uZHVyYXRpb249XCJleGNlcHRpb25cIjtcbiAgICB9XG5cbiAgICBsb2cuZXJyb3IoXCJDYWxsX3t9OlN0YXRlX3t9LT57fStcIixzZXNzaW9uW1widHJhY2Utc2tleVwiXSxjYWxsc3RhdGVvbGQsc2Vzc2lvbi5jYWxsc3RhdGUpOyAgXG4gICAgc2Vzc2lvbi5sb2dpbmZvID0gc2Vzc2lvbi5sb2dpbmZvK3Nlc3Npb24uY2FsbHN0YXRlK1wiO2R1cmF0aW9uPVwiK3Nlc3Npb24uZHVyYXRpb24rXCI7XCI7ICAgXG5cbiAgICAvL3ByZXBhcmUgdGhlIExPRyBsaW5lIC0gc2VuZCB0byB0aGUgbG9nX3NpcGRlbW8gcHJvY2VzcyBcbiAgICBsZXQgbG9nbGluZSA9IHt9O1xuICAgIHRyeXtcbiAgICAgICAgICAgIGxvZ2xpbmUuTVNJU0ROID0gc2Vzc2lvbltcInNfbm9ybWFsaXplZE51bWJlclwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmUuU2VydmljZVNlc3Npb25JZCA9IHNlc3Npb25bXCJmc20taWRcIl07XG4gICAgICAgICAgICBsb2dsaW5lLk1zZ1R5cGUgPSBcIlNJUC5JTlZJVEVcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnU2Vzc2lvbklkID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmUuTXNnSWQgPSBzZXNzaW9uW1wic19pbml0aWFsU0lQXCJdW1wiU0lQXCJdW1wiQ2FsbC1JRFwiXVtcInZhbHVlXCJdO1xuICAgICAgICAgICAgbG9nbGluZS5Nc2dEZXRhaWxzID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmUuU2VydmljZWRldGFpbHMgPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZS5jYWxsQW5zd2VyZWQgPSBzZXNzaW9uLnRpbWVhbnN3ZXI7XG4gICAgICAgICAgICBsb2dsaW5lLmNhbGxFbmRlZCA9IHNlc3Npb24udGltZWVuZDtcbiAgICAgICAgICAgIGxvZ2xpbmUuY2FsbER1cmF0aW9uID0gc2Vzc2lvbi5kdXJhdGlvbjtcbiAgICAgICAgICAgIHNlc3Npb24ubG9naW5mbz1cIlwiO1xuXG4gICAgICAgIC8vdGltZXN0YW1wIGFkZGVkIGJ5IEdXIGJlZm9yZSBpdCBwdXQgaXQgaW50byB0aGUgcXVldWUgdG8gUlRFXG4gICAgICAgIGxvZ2xpbmUuR3dFdmVudFRpbWUgPSBzZXNzaW9uLnRpbWVhbnN3ZXI7IFxuXG4gICAgICAgIGxldCBub3cgOiBEYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgbGV0IGxvZ0RhdGUgOiBzdHJpbmcgPSBmb3JtYXREYXRlKG5vdyk7XG4gICAgICAgIGxldCBsb2dUaW1lIDogc3RyaW5nID0gZm9ybWF0VGltZShub3cpO1xuICAgICAgICBsb2dsaW5lLkxvZ0xpbmVUaW1lID0gbG9nRGF0ZSsgXCIuXCIgKyBsb2dUaW1lICsgXCIuXCIrKFwiMDAwXCIgKyBub3cuZ2V0TWlsbGlzZWNvbmRzKCkudG9TdHJpbmcoKSkuc2xpY2UoLTMpOyAgICAgICAgXG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2dsaW5lLk1TSVNETiA9IFwiXCI7XG4gICAgICAgIGxvZ2xpbmUuU2VydmljZVNlc3Npb25JZCA9IFwiXCI7XG4gICAgICAgIGxvZ2xpbmUuTXNnVHlwZSA9IFwiXCI7XG4gICAgICAgIGxvZ2xpbmUuTXNnU2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgbG9nbGluZS5Nc2dJZCA9IFwiXCI7XG4gICAgICAgIGxvZ2xpbmUuTXNnRGV0YWlscyA9IFwiXCI7XG4gICAgICAgIGxvZ2xpbmUuU2VydmljZWRldGFpbHMgPSBcImVycm9yIGF0IENDUkNvbnRpbnVlIGxvZ2xpbmVcIjtcbiAgICAgICAgbG9nbGluZS5jYWxsQW5zd2VyZWQgPSBcIm5hXCI7XG4gICAgICAgIGxvZ2xpbmUuY2FsbEVuZGVkID0gXCJuYVwiO1xuICAgICAgICBsb2dsaW5lLmNhbGxEdXJhdGlvbiA9IFwibmFcIjtcbiAgICAgICAgbG9nbGluZS5Mb2dMaW5lVGltZSA9IFwiXCI7XG4gICAgfTtcbiAgICBsb2dsaW5lLlRyYWNlTGV2ZWwgPSBzZXNzaW9uW1wiZnNtLXRyYWNlLWxldmVsXCJdOyAgICBcbiAgICBzZXNzaW9uLmxvZ2xpbmU9bG9nbGluZTsgICAgXG4gICAgcmV0dXJuIHJldDtcbn1cblxuXG5mdW5jdGlvbiBnZXRkaXNjb25uZWN0cmVhc29uKHNlc3Npb246YW55LGV2ZW50IGFueSxsb2NhbFBhcmFtczphbnkpIHtcbiAgICAvKlxuICAgIGV2ZW50cy1zdGFja1x0XHRbNV1cbiAgICAwXHQ6XHRzaXAuY2FsbFN0YXJ0Lk5PTkVcbiAgICAxOlx0c2lwLmNhbGxQb2xsLlNJUFN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudFxuICAgIDJcdDpcdHNpcC5jYWxsQW5zd2VyZWQuU2lwQ2FsbExlZ1VhQ2xpZW50XG4gICAgM1x0Olx0bGVnLm1heF9jYWxsX2R1cmF0aW9uXG4gICAgNFx0Olx0c2lwLmNhbGxTdGFydC5ESVNDT05ORUNURUQgICAgXG4gICAgKi9cbiAgICBsZXQgbG9nID0gc2Vzc2lvbi5sb2c7XG5cbiAgICB0cnkge1xuXG4gICAgICAgIC8vcHJlcGFyZSB0aGUgTE9HIGxpbmUgLSBzZW5kIHRvIHRoZSBsb2dfc2lwZGVtbyBwcm9jZXNzIFxuICAgICAgICBsZXQgbG9nbGluZSA9IHt9O1xuICAgICAgICB0cnl7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTVNJU0ROXCJdID0gc2Vzc2lvbltcInNfbm9ybWFsaXplZE51bWJlclwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlU2Vzc2lvbklkXCJdID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dUeXBlXCJdID0gXCJTSVAuSU5WSVRFXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTXNnU2Vzc2lvbklkXCJdID0gc2Vzc2lvbltcImZzbS1pZFwiXTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dJZFwiXSA9IHNlc3Npb25bXCJzX2luaXRpYWxTSVBcIl1bXCJTSVBcIl1bXCJDYWxsLUlEXCJdW1widmFsdWVcIl07XG4gICAgICAgICAgICBsb2dsaW5lW1wiTXNnRGV0YWlsc1wiXSA9IFwiXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiU2VydmljZWRldGFpbHNcIl0gPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZVtcImNhbGxBbnN3ZXJlZFwiXSA9IHNlc3Npb24udGltZWFuc3dlcjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJjYWxsRW5kZWRcIl0gPSBzZXNzaW9uLnRpbWVlbmQ7XG4gICAgICAgICAgICBsb2dsaW5lW1wiY2FsbER1cmF0aW9uXCJdID0gc2Vzc2lvbi5kdXJhdGlvbjtcblxuICAgICAgICAgICAgbGV0IG5vdyA6IERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGxvZ0RhdGUgOiBzdHJpbmcgPSBmb3JtYXREYXRlKG5vdyk7XG4gICAgICAgICAgICBsZXQgbG9nVGltZSA6IHN0cmluZyA9IGZvcm1hdFRpbWUobm93KTtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJMb2dMaW5lVGltZVwiXSA9IGxvZ0RhdGUrIFwiLlwiICsgbG9nVGltZSArIFwiLlwiKyhcIjAwMFwiICsgbm93LmdldE1pbGxpc2Vjb25kcygpLnRvU3RyaW5nKCkpLnNsaWNlKC0zKTsgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICBsb2dsaW5lW1wiTVNJU0ROXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlU2Vzc2lvbklkXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dUeXBlXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dTZXNzaW9uSWRcIl0gPSBcIlwiO1xuICAgICAgICAgICAgbG9nbGluZVtcIk1zZ0lkXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJNc2dEZXRhaWxzXCJdID0gXCJcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJTZXJ2aWNlZGV0YWlsc1wiXSA9IFwiZXhjZXB0aW9uXCIgKyBlO1xuICAgICAgICAgICAgbG9nbGluZVtcImNhbGxBbnN3ZXJlZFwiXSA9IFwibmFcIjtcbiAgICAgICAgICAgIGxvZ2xpbmVbXCJjYWxsRW5kZWRcIl0gPSBcIm5hXCI7XG4gICAgICAgICAgICBsb2dsaW5lW1wiY2FsbER1cmF0aW9uXCJdID0gXCJuYVwiO1xuICAgICAgICAgICAgbG9nbGluZVtcIkxvZ0xpbmVUaW1lXCJdID0gXCJuYVwiO1xuICAgICAgICB9O1xuICAgICAgICBzZXNzaW9uLmxvZ2xpbmU9bG9nbGluZTsgICAgICAgICAgXG5cbiAgICAgICAgbGV0IGV2ZW50cz1ldmVudFtcImV2ZW50cy1zdGFja1wiXS5sZW5ndGg7XG4gICAgICAgIGxldCBpbmRleD1ldmVudHMtMTtcbiAgICAgICAgaWYgKGV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdW2luZGV4XSA9PT0gXCJsZWcudGltZW91dFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gXCJyZWFzb24udGltZW91dFwiO1xuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50W1wiZXZlbnRzLXN0YWNrXCJdW2luZGV4XSA9PT0gXCJsZWcubWF4X2NhbGxfZHVyYXRpb25cIikge1xuICAgICAgICAgICAgcmV0dXJuIFwicmVhc29uLm1heF9jYWxsX2R1cmF0aW9uXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gXCJyZWFzb24uXCIgKyBldmVudFtcImV2ZW50cy1zdGFja1wiXVtpbmRleF07ICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy5kZWJ1ZyhcImdldGRpc2Nvbm5lY3RyZWFzb24gTG9nOiB7fVwiLCBlKTtcbiAgICAgICAgcmV0dXJuIFwicmVhc29uLmV4Y2VwdGlvblwiO1xuICAgIH1cbn1cblxuXG5cblxuZnVuY3Rpb24gc2V0UHJlY29uZGl0aW9uRm9yd2FkQ2FsbGIyYihzZXNzaW9uOmFueSxldmVudDphbnksbG9jYWxQYXJhbXM6YW55KTogUmVzdWx0Q29kZSB7XG5cbiAgICBsZXQgcmV0OiBSZXN1bHRDb2RlIDtcbiAgICByZXQgPSByZXQgfHwge307XG4gICAgcmV0LnJlc3VsdENvZGU9XCJzdWNjZXNzXCI7XG4gICAgXG4gICAgbGV0IGV2ZW50cyA6IEV2ZW50cztcbiAgICBldmVudHMgPSBldmVudHMgfHwge307XG5cbiAgICBcbiAgICBldmVudHMuU0lQUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIC8vdHlwb3MgaW4gdGhlIGJlbG93XG4gICAgZXZlbnRzLlNJUDE4eEluZm9ybWF0b2luYWxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU2RwQW5zd2VyRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNJUFJlSU5WSVRFRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlNEUE9mZmVyUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TaXBSaW5naW5nUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TaXBTZHBPZmZlclBvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0lQZWdDbG9zZWRFdmVudD1cIm51bGxcIjtcbiAgICBcbiAgICBldmVudHMuQ2FsbEJlaW5nRm9yd2FyZGVkUG9sbEV2ZW50PVwibnVsbFwiO1xuICAgIGV2ZW50cy5TSVBTZHBBbnN3ZXJQb2xsRXZlbnQ9XCJudWxsXCI7XG5cbiAgICBldmVudHMuUmluZ2luZ1BvbGxFdmVudD1cIm51bGxcIjtcblxuXG5cblxuICAgIGV2ZW50cy5TSVAxOHhBbnN3ZXJFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuU0lQUmluZ2luZ1BvbGxFdmVudD1cIm51bGxcIjtcbiAgICAvL25lZWRzIGEgaGFuZGxlXG4gICAgZXZlbnRzLkluZm9Qb2xsRXZlbnQ9XCJudWxsXCI7XG4gICAgZXZlbnRzLlN1Y2Nlc3NSZXNwb25zZVBvbGxFdmVudD1cIm51bGxcIjtcbiAgICBldmVudHMuUmF3Q29udGVudFBvbGxFdmVudD1cInRlc3QvdGVzdFwiO1xuICAgIHNlc3Npb24uZXZlbnRzID0gSlNPTi5zdHJpbmdpZnkoZXZlbnRzKTsgIFxuXG4gICAgLy9sZXQgdW5zdWIgPSB7XCJJbmZvUG9sbEV2ZW50XCI6XCJcIiwgXCJTdWNjZXNzUmVzcG9uc2VQb2xsRXZlbnRcIjpcIlwiLCBcIlNJUFJpbmdpbmdQb2xsRXZlbnRcIjpcIlwiLCBcIlJhd0NvbnRlbnRQb2xsRXZlbnRcIjpcIlwifTtcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpO1xuICAgIC8vbGV0IHVuc3ViID0ge1wiU0lQMTh4QW5zd2VyRXZlbnRcIjpcIlwifTtcbiAgICAvL3Nlc3Npb24udW5zdWJzY3JpYmVFdmVudHM9SlNPTi5zdHJpbmdpZnkodW5zdWIpO1xuXG4gICAgLy9TZXQgaGVhZGVycyBmb3Igb3V0Z29pbmcgbWVzc2FnZVxuICAgIGxldCBoZWFkZXJWYXJzIDogSGVhZGVyVmFycztcbiAgICBoZWFkZXJWYXJzID0gaGVhZGVyVmFycyB8fCB7fTtcbiAgICBoZWFkZXJWYXJzLmRpc2FibGVTZW5kRGVmYXVsdFJlYXNvbiA9IFwiRGlzYWJsZWRcIjtcbiAgICBoZWFkZXJWYXJzLmRpc2FibGVTZW5kTm9BbnN3ZXJSZWFzb24gPSBcIkRpc2FibGVkXCI7XG4gICAgLy9TcGVjaWZ5IHRoZSBNb2RlIGZvciB0aGUgU05GLCBzbyBTTkYgYWRkcyBpdHNlbGYgdG8gUmVjb3JkLVJvdXRlIChuZWVkZWQgZm9yIGIyYnVhKSBvciBub3QgKHByb3h5KVxuICAgIC8vbm90IG5lZWRlZCBoZXJlIC0gdGhpcyBpcyBpbiBTTkYgdG8gYXBwbHkgc29tZSBydWxlcyBmb3IgYjJiXG4gICAgLy9oZWFkZXJWYXJzLnByaXZhdGVTZXJ2aWNlTW9kZSA9IFwiYjJidWFcIjtcbiAgICBcbiAgICBzZXNzaW9uLmhlYWRlcnJ1bGV2YXI9SlNPTi5zdHJpbmdpZnkoaGVhZGVyVmFycyk7XG4gICAgc2Vzc2lvbi5oZWFkZXJydWxlc3NlbGVjdCA9IFwiU2lwU2VydmljZVNwZWNpZmljUnVsZXNTZXRcIjtcblxuXG4gICAgXG4gICAgLypcbiAgICAvL3RoaXMgcmVxdWlyZXMgYSBTdXBwb3J0ZWQ6IDEwMFJlbCBpbiB0aGUgaW5jb21pbmcgcmVxdWVzdCBhbmQgc2VuZHMgYSAxODMgdG8gQSB3aXRoIFJlcXVpcmU6IDEwMFJlbCBcbiAgICBsZXQgY2FwYWJpbGl0aWVzIDogYW55W10gPSBbXTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUkVMMVhYKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuVVBEQVRFKTtcbiAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuRk9SS0lORyk7XG4gICAgc2Vzc2lvbi51cHN0cmVhbUNhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgKi9cblxuICAgIC8qXG4gICAgbGV0IGNhcGFiaWxpdGllcyA9IHNlc3Npb24uc19Jbml0aWFsQ2FwYWJpbGl0aWVzO1xuICAgIGlmKCBjYXBhYmlsaXRpZXMhPW51bGwpe1xuICAgICAgICBjYXBhYmlsaXRpZXMucHVzaChDYXBhYmlsaXRpZXMuUEVNKTtcbiAgICAgICAgY2FwYWJpbGl0aWVzLnB1c2goQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICBzZXNzaW9uLm91dENhcGFiaWxpdGllcyA9IEpTT04uc3RyaW5naWZ5KGNhcGFiaWxpdGllcyk7XG4gICAgfVxuICAgICovXG5cbiAgICAvLyBzZXNzaW9uLnJpbmdpbmd0b25lcyA9IEpTT04uc3RyaW5naWZ5KHJpbmdpbmdUb25lcyk7XG5cbiAgICByZXR1cm4gcmV0O1xufVxuXG5cbmZ1bmN0aW9uIGNoZWNrU0RQQW5zd2VyQWN0aW9uKHNlc3Npb246YW55LGV2ZW50OmFueSxsb2NhbFBhcmFtczphbnkpICB7XG4gICAgLy9ldmVudERhdGEgaXMgbm93IGxhc3QgbWVzc2dhZVxuICAgIGxldCBldmVudERhdGEgPSBsb2NhbFBhcmFtcy5tZXNzYWdlO1xuXG4gICAgLy9hZGQgdGhlIHBvbGwgYWN0aW9ucyAoYWNjZXB0LCBmb3J3YXJkLCByZWplY3QpIHRvIHRoZSBjYWxscG9sbCBhbnNld3IgZXZlbnRcbiAgICAvL0luZm9ybWF0aW9uYWxFdmVudCBpcyBhIGhpZ2gtbGV2ZWwgaW50ZXJmYWNlIHR5cGljYWxseSBzcGVjaWFsaXplZCBmb3IgY29uY3JldGUgZXZlbnRzLiBUaGUgQ2FsbFVzZXIgaXMgbm90IHJlcXVpcmVkIHRvIHRha2UgYW55IGFjdGlvbiBmb3IgdGhpcyBldmVudCwgdGhlc2UgYXJlIHB1cmVseSBpbmZvcm1hdGlvbmFsLlxuICAgIC8vUG9sbEV2ZW50IGlzIGFuIGV2ZW50IG9uIHdoaWNoIHRoZSBDYWxsVXNlciBpcyBleHBlY3RlZCB0byB0YWtlIGFuIGFjdGlvbiB1cG9uIHJlY2VpdmluZyB0aGUgZXZlbnQuIFRoZSBhY3Rpb24gaXMgdXN1YWxseSBieSBpbnZva2luZyB0aGUgUG9sbEV2ZW50IG1ldGhvZHMgYWNjZXB0LCByZWplY3Qgb3IgZm9yd2FyZC5cbiAgICBsZXQgcG9sbEFjdGlvbiA6IENhbGxQb2xsQWN0aW9uO1xuICAgIHBvbGxBY3Rpb24gPSBwb2xsQWN0aW9uIHx8IHt9O1xuICAgIC8vcG9sbEFjdGlvbi50eXBlID0gQ2FsbFBvbGxBY3Rpb25UeXBlLkFjY2VwdDtcbiAgICBwb2xsQWN0aW9uLnR5cGUgPSBDYWxsUG9sbEFjdGlvblR5cGUuUmVqZWN0O1xuICAgIHNlc3Npb24uc2VuZEFjdGlvbiA9IEpTT04uc3RyaW5naWZ5KHBvbGxBY3Rpb24pO1xuXG4gICAgcmV0dXJuIHRydWU7XG59XG5cblxuZnVuY3Rpb24gbW9kaWZ5ZGlzcG9zaXRpb24oc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIGxldCBpbml0aWFsTXNnID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcbiAgICBpZiAoaW5pdGlhbE1zZ1tcIlNJUFwiXVtcImNhcGFiaWxpdGllc1wiXSAhPSBudWxsKSB7XG4gICAgICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLmluZGV4T2YoQ2FwYWJpbGl0aWVzLkZPUktJTkcpID4gLTEpIHtcbiAgICAgICAgICAgIC8vaXQgaXMgcHJlc2VudC4gbWVhbnMgdGhlIFNJUCBoZWFkZXIgXCJSZXF1ZXN0LURpc3Bvc2l0aW9uOiBuby1mb3JrXCIgaXMgTk9UIHByZXNlbnQuIFRoaXMgaW5zdHJ1Y3RzIFRBUyB0byBub3Qgc2VuZCAxODMgYmVmb3JlIGZvcndhcmRpbmcgdGhlIElOVklURVxuICAgICAgICAgICAgbGV0IGNhcGFiaWxpdGllcyA6IGFueVtdID0gW107XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vdGhlIGJlbG93IGNyZWF0ZXMgZXhjZXB0aW9uIFxuICAgICAgICAgICAgLy9jYXBhYmlsaXRpZXMgPSBpbml0aWFsTXNnLlNJUC5jYXBhYmlsaXRpZXM7XG4gICAgICAgICAgICAvL2NhcGFiaWxpdGllcy5wdXNoKENhcGFiaWxpdGllcy5GT1JLSU5HKTtcbiAgICAgICAgICAgIC8vdGhpcyB3b3VsZCBiZSByZW1vdmVcbiAgICAgICAgICAgIC8vbGV0IGluZGV4PSBpbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLmluZGV4T2YoQ2FwYWJpbGl0aWVzLkZPUktJTkcpO1xuICAgICAgICAgICAgLy9pbml0aWFsTXNnW1wiU0lQXCJdW1wiY2FwYWJpbGl0aWVzXCJdLnNwbGljZShpbmRleCwgMSk7IC8vIDJuZCBwYXJhbWV0ZXIgbWVhbnMgcmVtb3ZlIG9uZSBpdGVtIG9ubHlcbiAgICAgICAgICAgIHNlc3Npb24udXBzdHJlYW1DYXBhYmlsaXRpZXMgPSBKU09OLnN0cmluZ2lmeShjYXBhYmlsaXRpZXMpOyAgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiUi1VUklcIl1bXCJ2YWx1ZVwiXSA9PSBcInNpcDo5NzIwMDAwMTlAMTcyLjMxLjExLjE0Mjo1MDYyXCIpIHtcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDA0QDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDk5QDE3Mi4zMS4xMS4xNDI6NTA2MlwiXTtcbiAgICB9XG4gICAgXG5cbiAgICByZXR1cm4gdHJ1ZTtcbn1cblxuXG5mdW5jdGlvbiBzZXRkZXN0aW5hdGlvbmxpc3Qoc2Vzc2lvbjphbnksZXZlbnQ6YW55LGxvY2FsUGFyYW1zOmFueSkge1xuICAgIGxldCBpbml0aWFsTXNnID0gbG9jYWxQYXJhbXMubWVzc2FnZTtcblxuICAgIGlmIChpbml0aWFsTXNnW1wiU0lQXCJdW1wiUi1VUklcIl1bXCJ2YWx1ZVwiXSA9PSBcInNpcDo5NzIwMDAwMTlAMTcyLjMxLjExLjE0Mjo1MDYyXCIpIHtcbiAgICAgICAgc2Vzc2lvbi5kZXN0bGlzdCA9IFtcInNpcDo5OTAwMDExQDE3Mi4zMS4xMS4xNDI6NTA2MlwiLCBcInNpcDo5OTAwMDIyQDE3Mi4zMS4xMS4xNDI6NTA2NFwiLCBcInNpcDo5OTAwMDMzQDE3Mi4zMS4xMS4xNDI6NTA2NVwiXTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG59XG4iXX0=