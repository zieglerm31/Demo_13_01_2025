"use strict";
;
function createXML(session, event, localParams) {
    var x;
    session.s_xml1 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><sms><user><username>SendSMSwhileOff</username><password>Aa87!6179</password></user><source>019</source><destinations><phone>";
    session.s_xml2 = "</phone></destinations><message>test</message><response>0</response></sms>";
    session.s_xml = session.xml1 + session.normalizedNumber + session.xml2;
    return "success";
}
function checkHttpResponse(session, event, localParams) {
    var log = session.log;
    log.debug("Event received:{}", event);
    var bodyStr = event.body;
    session.restResponse = 0;
    session.callstate = "HTTPRESPONSE_INIT";
    session.CalledPartyOverwritten = "sip:+4090123123@test.com";
    try {
        var body = event.body;
        session.restResponse = body.status;
        if (session.restResponse == "0") {
            session.callstate = "HTTPRESPONSE_CONNECT";
            if (body.paramX.match(session.Callingipv4)) {
                session.CalledPartyOverwritten = "sip:+4090123123@test.com";
                session.loginfo = session.loginfo + "ParamX.match.OverwriteDestination. connect to " + session.CalledPartyOverwritten + ";";
            }
            else if (body.paramY.match(session.Callingipv4)) {
                session.CalledPartyOverwritten = "sip:+4090123123@test.com";
                session.loginfo = session.loginfo + "ParamY.match.OverwriteDestination. connect to " + session.CalledPartyOverwritten + ";";
            }
            else {
                session.CalledPartyOverwritten = session.CalledParty;
                session.loginfo = session.loginfo + "Param.do not match.Connect to Initial CalledParty;";
            }
        }
        else if (session.restResponse == "4") {
            session.callstate = "HTTPRESPONSE_MRFPC";
        }
        else if (session.restResponse == "5") {
            session.callstate = "HTTPRESPONSE_MRFBYE";
        }
        else {
            session.callstate = "HTTPRESPONSE_UNKNOWN" + session.callstate;
        }
    }
    catch (e) {
        log.error("checkHttpResponse Exception {}", e);
        session.callstate = "HTTPRESPONSE_EXCEPTION";
    }
    ;
    var callstateold = session.callstate;
    log.error("Call_{}:State_{}->{}+", session["trace-skey"], callstateold, session.callstate);
    session.loginfo = session.loginfo + session.callstate + ";";
    return "scenario." + session.restResponse;
}
function failureHttpResponse(session, event, localParams) {
    var eventname = event["event-name"];
    if (event["event-name"].startsWith("sip")) {
        session.loginfo = session.loginfo + "SIP-event received while waiting for Http response (" + eventname + ");";
        return "sip.callended";
    }
    else if (event["event-name"].startsWith("http")) {
        session.loginfo = session.loginfo + "HttpFailure response received (" + event.body.status + ");";
    }
    else {
        session.loginfo = session.loginfo + "No SIP or HTTP event received while waiting for Http response (" + eventname + ");";
    }
    return "success";
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kdWxlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibW9kdWxlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFDQSxDQUFDO0FBRUQsU0FBUyxTQUFTLENBQUMsT0FBYSxFQUFFLEtBQVcsRUFBRSxXQUFnQjtJQUU1RCxJQUFJLENBQVUsQ0FBQztJQUNmLE9BQU8sQ0FBQyxNQUFNLEdBQUUseUtBQXlLLENBQUM7SUFFMUwsT0FBTyxDQUFDLE1BQU0sR0FBRSw0RUFBNEUsQ0FBQztJQUU3RixPQUFPLENBQUMsS0FBSyxHQUFFLE9BQU8sQ0FBQyxJQUFJLEdBQUcsT0FBTyxDQUFDLGdCQUFnQixHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7SUFFdEUsT0FBTyxTQUFTLENBQUM7QUFFcEIsQ0FBQztBQUVELFNBQVMsaUJBQWlCLENBQUMsT0FBYSxFQUFFLEtBQVcsRUFBRSxXQUFnQjtJQUNuRSxJQUFJLEdBQUcsR0FBUyxPQUFPLENBQUMsR0FBRyxDQUFDO0lBQzVCLEdBQUcsQ0FBQyxLQUFLLENBQUMsbUJBQW1CLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDckMsSUFBSSxPQUFPLEdBQUMsS0FBSyxDQUFDLElBQUksQ0FBQztJQUN2QixPQUFPLENBQUMsWUFBWSxHQUFFLENBQUMsQ0FBQztJQUN4QixPQUFPLENBQUMsU0FBUyxHQUFHLG1CQUFtQixDQUFDO0lBQ3hDLE9BQU8sQ0FBQyxzQkFBc0IsR0FBQywwQkFBMEIsQ0FBQTtJQUN6RCxJQUFJO1FBRUEsSUFBSSxJQUFJLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQztRQUN0QixPQUFPLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7UUFDbkMsSUFBSSxPQUFPLENBQUMsWUFBWSxJQUFFLEdBQUcsRUFBRTtZQUMzQixPQUFPLENBQUMsU0FBUyxHQUFHLHNCQUFzQixDQUFDO1lBQzNDLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUN4QyxPQUFPLENBQUMsc0JBQXNCLEdBQUMsMEJBQTBCLENBQUE7Z0JBQ3pELE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBQyxnREFBZ0QsR0FBQyxPQUFPLENBQUMsc0JBQXNCLEdBQUMsR0FBRyxDQUFDO2FBQ3pIO2lCQUFPLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxFQUFFO2dCQUNoRCxPQUFPLENBQUMsc0JBQXNCLEdBQUMsMEJBQTBCLENBQUE7Z0JBQ3pELE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBQyxnREFBZ0QsR0FBQyxPQUFPLENBQUMsc0JBQXNCLEdBQUMsR0FBRyxDQUFDO2FBQ3pIO2lCQUFPO2dCQUNKLE9BQU8sQ0FBQyxzQkFBc0IsR0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDO2dCQUNuRCxPQUFPLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxPQUFPLEdBQUMsb0RBQW9ELENBQUM7YUFDMUY7U0FDSjthQUFNLElBQUksT0FBTyxDQUFDLFlBQVksSUFBRSxHQUFHLEVBQUU7WUFDbEMsT0FBTyxDQUFDLFNBQVMsR0FBRSxvQkFBb0IsQ0FBQztTQUMzQzthQUFNLElBQUksT0FBTyxDQUFDLFlBQVksSUFBRSxHQUFHLEVBQUU7WUFDbEMsT0FBTyxDQUFDLFNBQVMsR0FBRSxxQkFBcUIsQ0FBQztTQUM1QzthQUFNO1lBQ0gsT0FBTyxDQUFDLFNBQVMsR0FBRSxzQkFBc0IsR0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDO1NBQy9EO0tBQ0o7SUFBQyxPQUFPLENBQUMsRUFBRTtRQUNSLEdBQUcsQ0FBQyxLQUFLLENBQUMsZ0NBQWdDLEVBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUMsT0FBTyxDQUFDLFNBQVMsR0FBRyx3QkFBd0IsQ0FBQztLQUNoRDtJQUFBLENBQUM7SUFHRixJQUFJLFlBQVksR0FBVyxPQUFPLENBQUMsU0FBUyxDQUFDO0lBQzdDLEdBQUcsQ0FBQyxLQUFLLENBQUMsdUJBQXVCLEVBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxFQUFDLFlBQVksRUFBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDeEYsT0FBTyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUMsT0FBTyxHQUFDLE9BQU8sQ0FBQyxTQUFTLEdBQUMsR0FBRyxDQUFDO0lBSXhELE9BQU8sV0FBVyxHQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUM7QUFDNUMsQ0FBQztBQUdELFNBQVMsbUJBQW1CLENBQUMsT0FBYSxFQUFFLEtBQVcsRUFBRSxXQUFnQjtJQUNyRSxJQUFJLFNBQVMsR0FBWSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUM7SUFDN0MsSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3ZDLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBQyxzREFBc0QsR0FBQyxTQUFTLEdBQUMsSUFBSSxDQUFDO1FBRXhHLE9BQU8sZUFBZSxDQUFBO0tBQ3pCO1NBQU0sSUFBSSxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxFQUFFO1FBQy9DLE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBQyxpQ0FBaUMsR0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sR0FBQyxJQUFJLENBQUM7S0FDOUY7U0FBTTtRQUNILE9BQU8sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE9BQU8sR0FBQyxpRUFBaUUsR0FBQyxTQUFTLEdBQUMsSUFBSSxDQUFDO0tBQ3RIO0lBRUQsT0FBTyxTQUFTLENBQUM7QUFDckIsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vTUFJTkJMT0NLXG47XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVYTUwoc2Vzc2lvbiA6IGFueSwgZXZlbnQgOiBhbnksIGxvY2FsUGFyYW1zOiBhbnkgKXtcclxuXHJcbiAgIGxldCB4IDogc3RyaW5nO1xyXG4gICBzZXNzaW9uLnNfeG1sMT0gXCI8P3htbCB2ZXJzaW9uPVxcXCIxLjBcXFwiIGVuY29kaW5nPVxcXCJVVEYtOFxcXCI/PjxzbXM+PHVzZXI+PHVzZXJuYW1lPlNlbmRTTVN3aGlsZU9mZjwvdXNlcm5hbWU+PHBhc3N3b3JkPkFhODchNjE3OTwvcGFzc3dvcmQ+PC91c2VyPjxzb3VyY2U+MDE5PC9zb3VyY2U+PGRlc3RpbmF0aW9ucz48cGhvbmU+XCI7XHJcblxyXG4gICBzZXNzaW9uLnNfeG1sMj0gXCI8L3Bob25lPjwvZGVzdGluYXRpb25zPjxtZXNzYWdlPnRlc3Q8L21lc3NhZ2U+PHJlc3BvbnNlPjA8L3Jlc3BvbnNlPjwvc21zPlwiO1xyXG5cclxuICAgc2Vzc2lvbi5zX3htbD0gc2Vzc2lvbi54bWwxICsgc2Vzc2lvbi5ub3JtYWxpemVkTnVtYmVyICsgc2Vzc2lvbi54bWwyO1xyXG5cclxuICAgcmV0dXJuIFwic3VjY2Vzc1wiO1xyXG5cclxufVxyXG5cclxuZnVuY3Rpb24gY2hlY2tIdHRwUmVzcG9uc2Uoc2Vzc2lvbiA6IGFueSwgZXZlbnQgOiBhbnksIGxvY2FsUGFyYW1zOiBhbnkgKXtcclxuICAgIGxldCBsb2cgOiBhbnkgPSBzZXNzaW9uLmxvZztcclxuICAgIGxvZy5kZWJ1ZyhcIkV2ZW50IHJlY2VpdmVkOnt9XCIsZXZlbnQpO1xyXG4gICAgbGV0IGJvZHlTdHI9ZXZlbnQuYm9keTtcclxuICAgIHNlc3Npb24ucmVzdFJlc3BvbnNlID0wO1xyXG4gICAgc2Vzc2lvbi5jYWxsc3RhdGUgID1cIkhUVFBSRVNQT05TRV9JTklUXCI7XHJcbiAgICBzZXNzaW9uLkNhbGxlZFBhcnR5T3ZlcndyaXR0ZW49XCJzaXA6KzQwOTAxMjMxMjNAdGVzdC5jb21cIlxyXG4gICAgdHJ5IHtcclxuICAgICAgICAvL2xldCBib2R5ID0gSlNPTi5wYXJzZShib2R5U3RyKTtcclxuICAgICAgICBsZXQgYm9keSA9IGV2ZW50LmJvZHk7XHJcbiAgICAgICAgc2Vzc2lvbi5yZXN0UmVzcG9uc2UgPSBib2R5LnN0YXR1cztcclxuICAgICAgICBpZiAoc2Vzc2lvbi5yZXN0UmVzcG9uc2U9PVwiMFwiKSB7XHJcbiAgICAgICAgICAgIHNlc3Npb24uY2FsbHN0YXRlICA9XCJIVFRQUkVTUE9OU0VfQ09OTkVDVFwiOyAgIFxyXG4gICAgICAgICAgICBpZiAoYm9keS5wYXJhbVgubWF0Y2goc2Vzc2lvbi5DYWxsaW5naXB2NCkpIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb24uQ2FsbGVkUGFydHlPdmVyd3JpdHRlbj1cInNpcDorNDA5MDEyMzEyM0B0ZXN0LmNvbVwiXHJcbiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rXCJQYXJhbVgubWF0Y2guT3ZlcndyaXRlRGVzdGluYXRpb24uIGNvbm5lY3QgdG8gXCIrc2Vzc2lvbi5DYWxsZWRQYXJ0eU92ZXJ3cml0dGVuK1wiO1wiOyBcclxuICAgICAgICAgICAgfSAgZWxzZSBpZiAoYm9keS5wYXJhbVkubWF0Y2goc2Vzc2lvbi5DYWxsaW5naXB2NCkpIHtcclxuICAgICAgICAgICAgICAgIHNlc3Npb24uQ2FsbGVkUGFydHlPdmVyd3JpdHRlbj1cInNpcDorNDA5MDEyMzEyM0B0ZXN0LmNvbVwiXHJcbiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rXCJQYXJhbVkubWF0Y2guT3ZlcndyaXRlRGVzdGluYXRpb24uIGNvbm5lY3QgdG8gXCIrc2Vzc2lvbi5DYWxsZWRQYXJ0eU92ZXJ3cml0dGVuK1wiO1wiOyBcclxuICAgICAgICAgICAgfSAgZWxzZSB7ICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgc2Vzc2lvbi5DYWxsZWRQYXJ0eU92ZXJ3cml0dGVuPXNlc3Npb24uQ2FsbGVkUGFydHk7XHJcbiAgICAgICAgICAgICAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rXCJQYXJhbS5kbyBub3QgbWF0Y2guQ29ubmVjdCB0byBJbml0aWFsIENhbGxlZFBhcnR5O1wiOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoc2Vzc2lvbi5yZXN0UmVzcG9uc2U9PVwiNFwiKSB7XHJcbiAgICAgICAgICAgIHNlc3Npb24uY2FsbHN0YXRlID1cIkhUVFBSRVNQT05TRV9NUkZQQ1wiO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoc2Vzc2lvbi5yZXN0UmVzcG9uc2U9PVwiNVwiKSB7XHJcbiAgICAgICAgICAgIHNlc3Npb24uY2FsbHN0YXRlID1cIkhUVFBSRVNQT05TRV9NUkZCWUVcIjtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBzZXNzaW9uLmNhbGxzdGF0ZSA9XCJIVFRQUkVTUE9OU0VfVU5LTk9XTlwiK3Nlc3Npb24uY2FsbHN0YXRlO1xyXG4gICAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBsb2cuZXJyb3IoXCJjaGVja0h0dHBSZXNwb25zZSBFeGNlcHRpb24ge31cIixlKTtcclxuICAgICAgICBzZXNzaW9uLmNhbGxzdGF0ZSAgPVwiSFRUUFJFU1BPTlNFX0VYQ0VQVElPTlwiO1xyXG4gICAgfTtcclxuXHJcbiAgICBcclxuICAgIGxldCBjYWxsc3RhdGVvbGQgOnN0cmluZyA9IHNlc3Npb24uY2FsbHN0YXRlOyAgICBcclxuICAgIGxvZy5lcnJvcihcIkNhbGxfe306U3RhdGVfe30tPnt9K1wiLHNlc3Npb25bXCJ0cmFjZS1za2V5XCJdLGNhbGxzdGF0ZW9sZCxzZXNzaW9uLmNhbGxzdGF0ZSk7ICAgXHJcbiAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rc2Vzc2lvbi5jYWxsc3RhdGUrXCI7XCI7IFxyXG5cclxuICAgIC8vc2Vzc2lvbi5DYWxsZWRQYXJ0eU92ZXJ3cml0dGVuPVtcInNpcDorNDA5MDEyMzEyM0B0ZXN0LmNvbVwiLFwic2lwOis0MDkwMTIzMTI0QHRlc3QuY29tXCJdO1xyXG5cclxuICAgIHJldHVybiBcInNjZW5hcmlvLlwiK3Nlc3Npb24ucmVzdFJlc3BvbnNlO1xyXG59XHJcblxyXG5cclxuZnVuY3Rpb24gZmFpbHVyZUh0dHBSZXNwb25zZShzZXNzaW9uIDogYW55LCBldmVudCA6IGFueSwgbG9jYWxQYXJhbXM6IGFueSApeyAgICAgXHJcbiAgICBsZXQgZXZlbnRuYW1lOiBzdHJpbmc9ICAgZXZlbnRbXCJldmVudC1uYW1lXCJdO1xyXG4gICAgaWYgKGV2ZW50W1wiZXZlbnQtbmFtZVwiXS5zdGFydHNXaXRoKFwic2lwXCIpKSB7XHJcbiAgICAgICAgc2Vzc2lvbi5sb2dpbmZvID0gc2Vzc2lvbi5sb2dpbmZvK1wiU0lQLWV2ZW50IHJlY2VpdmVkIHdoaWxlIHdhaXRpbmcgZm9yIEh0dHAgcmVzcG9uc2UgKFwiK2V2ZW50bmFtZStcIik7XCI7IFxyXG4gICAgICAgIC8vYnlwYXNzIHRoZSBURVJJTUFURSBjYWxsIGhhbmRsZXIgYXMgdGhlIGNhbGwgaXMgYWxyZWFkeSB0ZXJtaW5hdGVkXHJcbiAgICAgICAgcmV0dXJuIFwic2lwLmNhbGxlbmRlZFwiXHJcbiAgICB9IGVsc2UgaWYgKGV2ZW50W1wiZXZlbnQtbmFtZVwiXS5zdGFydHNXaXRoKFwiaHR0cFwiKSkge1xyXG4gICAgICAgIHNlc3Npb24ubG9naW5mbyA9IHNlc3Npb24ubG9naW5mbytcIkh0dHBGYWlsdXJlIHJlc3BvbnNlIHJlY2VpdmVkIChcIitldmVudC5ib2R5LnN0YXR1cytcIik7XCI7IFxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBzZXNzaW9uLmxvZ2luZm8gPSBzZXNzaW9uLmxvZ2luZm8rXCJObyBTSVAgb3IgSFRUUCBldmVudCByZWNlaXZlZCB3aGlsZSB3YWl0aW5nIGZvciBIdHRwIHJlc3BvbnNlIChcIitldmVudG5hbWUrXCIpO1wiOyBcclxuICAgIH1cclxuICAgIC8vcmV0dXJuIGV2ZW50LmJvZHkuc3RhdHVzO1xyXG4gICAgcmV0dXJuIFwic3VjY2Vzc1wiO1xyXG59XHJcbiJdfQ==